(this["webpackJsonp@cubejs-client/playground"]=this["webpackJsonp@cubejs-client/playground"]||[]).push([[19],{1147:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return I}));var r,a=t(15),i=t(1121),u=t(1120),o=t(1097),l=t.n(o),c=t(1098),s=t(14),d=t(0),b=(t(1113),t(112)),f=t(59),v=t(50),h=t(7),k=t(10),E=t(85),m=t(86),O=t(914),p=t(920),y=["gt","gte","lt","lte"],j={equals:"in",notEquals:"notIn",notSet:"set"};!function(e){e.AND="AND",e.OR="OR",e.PLAIN="PLAIN"}(r||(r={}));var g,N=function(){function e(n,t){Object(E.a)(this,e),this.cubeQuery=n,this.types=t,this.cubes={},this.prepareCubes()}return Object(m.a)(e,[{key:"convert",value:function(){return p.a(function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CubeQuery";return{kind:O.a.DOCUMENT,definitions:[{kind:O.a.OPERATION_DEFINITION,name:{kind:O.a.NAME,value:t},operation:"query",selectionSet:{kind:O.a.SELECTION_SET,selections:[{kind:O.a.FIELD,name:{kind:O.a.NAME,value:"cube"},arguments:e,selectionSet:{kind:O.a.SELECTION_SET,selections:n}}]}}]}}(this.getCubeArgs(),this.getFieldsSelections()))}},{key:"resolveFilter",value:function(e,n){var t=this,a=Object.values(e.reduce((function(e,n){if(n.or||n.and)return e;var t=(n.member||n.dimension).split("."),a=Object(k.a)(t,2),i=a[0],u=a[1];return e[i]||(e[i]={kind:r.PLAIN,cubeName:i,fields:[],filters:[]}),e[i].fields.push(u),e[i].filters.push(n),e}),{})),i=e.map((function(e){return!(!e.and&&!e.or)&&{kind:e.and?r.AND:r.OR,filters:e.and||e.or}})).filter(Boolean);return a.concat(i).map((function(e){return e.kind!==r.PLAIN?n?t.objectValue([t.booleanFilter(e.kind,t.resolveFilter(e.filters,e))]):t.booleanFilter(e.kind,t.resolveFilter(e.filters,e)):e.fields.length===Object(f.i)(e.fields).length?n?t.objectValue(t.objectFieldFilter(e.filters),Object(f.h)(e.cubeName)):t.objectFieldFilter(e.filters,Object(f.h)(e.cubeName)):t.objectField(t.booleanFilter((null===n||void 0===n?void 0:n.kind)||"AND",e.filters.map((function(n){return(n.and||n.or)&&t.resolveFilter(e.filters,e.kind),t.objectValue(t.objectFieldFilter(n))}))),Object(f.h)(e.cubeName))}))}},{key:"objectValue",value:function(e,n){return n?{kind:O.a.OBJECT,fields:[{kind:O.a.OBJECT_FIELD,name:{kind:O.a.NAME,value:n},value:{kind:O.a.OBJECT,fields:Array.isArray(e)?e:[e]}}]}:{kind:O.a.OBJECT,fields:Array.isArray(e)?e:[e]}}},{key:"objectFieldFilter",value:function(e,n){var t=this,r=Array.isArray(e)?e:[e],a=function(e){var n="number"===t.types[e.member||e.dimension]?O.a.FLOAT:O.a.STRING;return["set","notSet"].includes(e.operator)?{kind:O.a.BOOLEAN,value:"set"===e.operator}:"string"===typeof e.values?{kind:n,value:e.values}:1===e.values.length?{kind:n,value:e.values[0].toString()}:{kind:O.a.LIST,values:e.values.map((function(e){return{kind:n,value:e}}))}},i=r.map((function(e){var n=e.member||e.dimension;if(!t.types[n])throw new Error('Unknown member type for "'.concat(n,'". Make sure "').concat(n,'" exists in the schema.'));if(y.includes(e.operator)&&(e.values||[]).length>1)throw new Error('Filter operator "'.concat(e.operator,'" must have a single value'));return{kind:O.a.OBJECT_FIELD,name:{kind:O.a.NAME,value:n.split(".")[1]},value:{kind:O.a.OBJECT,fields:void 0!==e.values||["set","notSet"].includes(e.operator)?[{kind:O.a.OBJECT_FIELD,name:{kind:O.a.NAME,value:"equals"===e.operator&&(e.values||[]).length<=1?e.operator:j[e.operator]||e.operator},value:a(e)}]:[]}}}));return n?[{kind:O.a.OBJECT_FIELD,name:{kind:O.a.NAME,value:n},value:{kind:O.a.OBJECT,fields:i}}]:i}},{key:"objectField",value:function(e,n){return{kind:O.a.OBJECT_FIELD,name:{kind:O.a.NAME,value:n},value:{kind:O.a.OBJECT,fields:Array.isArray(e)?e:[e]}}}},{key:"booleanFilter",value:function(e,n){return{kind:O.a.OBJECT_FIELD,name:{kind:O.a.NAME,value:e},value:{kind:O.a.LIST,values:n}}}},{key:"orderByArg",value:function(e){return{kind:O.a.ARGUMENT,name:{kind:O.a.NAME,value:"orderBy"},value:{kind:O.a.OBJECT,fields:e.map((function(e){var n=Object(k.a)(e,2),t=n[0],r=n[1];return{kind:O.a.OBJECT_FIELD,name:{kind:O.a.NAME,value:t},value:{kind:O.a.ENUM,value:r}}}))}}}},{key:"getFieldsSelections",value:function(){var e=this,n=[];return Object.entries(this.cubes).forEach((function(t){var r=Object(k.a)(t,2),a=r[0],i=r[1],u=i.fields,o=i.orderBy;n.push({kind:O.a.FIELD,name:{kind:O.a.NAME,value:a},arguments:o.length?[e.orderByArg(o)]:[],selectionSet:{kind:O.a.SELECTION_SET,selections:u.map((function(e){var n=null;return e.granularities&&(n={selectionSet:{kind:O.a.SELECTION_SET,selections:e.granularities.map((function(e){return{kind:O.a.FIELD,name:{kind:O.a.NAME,value:e}}}))}}),Object(h.a)({kind:O.a.FIELD,name:{kind:O.a.NAME,value:e.name}},n)}))}})})),n}},{key:"getCubeArgs",value:function(){var e=this,n=[["timezone",O.a.STRING],["limit",O.a.INT],["offset",O.a.INT]],t=[];n.forEach((function(n){var r=Object(k.a)(n,2),a=r[0],i=r[1];e.cubeQuery[a]&&t.push({kind:O.a.ARGUMENT,name:{kind:O.a.NAME,value:a},value:{kind:i,value:e.cubeQuery[a]}})}));var r=Object(v.a)(this.cubeQuery.filters||[]);return(this.cubeQuery.timeDimensions||[]).forEach((function(e){e.dateRange&&r.push({member:e.dimension,operator:"inDateRange",values:e.dateRange})})),r.length&&t.push({kind:O.a.ARGUMENT,name:{kind:O.a.NAME,value:"where"},value:{kind:O.a.OBJECT,fields:this.resolveFilter(r)}}),t}},{key:"prepareCubes",value:function(){var e,n=this,t=function(e){n.cubes[e]||(n.cubes[e]={fields:[],filters:[],orderBy:[]})};["measures","dimensions","segments"].forEach((function(e){n.cubeQuery[e]&&n.cubeQuery[e].forEach((function(e){var r=e.split("."),a=Object(k.a)(r,3),i=a[0],u=a[1],o=a[2],l=Object(f.h)(i),c=o;"time"===n.types["".concat(i,".").concat(u)]&&(c="value"),t(l);var s=n.cubes[l].fields.find((function(e){return e.name===u}));n.cubes[l].fields.push(Object(h.a)({name:u},c?{granularities:[].concat(Object(v.a)((null===s||void 0===s?void 0:s.granularities)||[]),[c])}:null))}))}));var r={};(null===(e=this.cubeQuery.timeDimensions)||void 0===e||e.forEach((function(e){var n=e.dimension.split("."),t=Object(k.a)(n,2),a=t[0],i=t[1],u="".concat(a,".").concat(i);e.granularity&&(r[u]=(r[u]||[]).concat([e.granularity]))})),Object.entries(r).forEach((function(e){var r=Object(k.a)(e,2),a=r[0],i=r[1],u=a.split("."),o=Object(k.a)(u,2),l=o[0],c=o[1],s=Object(f.h)(l);t(s);var d=n.cubes[s].fields.find((function(e){return e.name===c}));d?d.granularities=Object(f.i)([].concat(Object(v.a)(d.granularities||[]),Object(v.a)(i))):n.cubes[s].fields.push({name:c,granularities:i})})),this.cubeQuery.order)&&(Array.isArray(this.cubeQuery.order)?this.cubeQuery.order:Object.entries(this.cubeQuery.order)).forEach((function(e){var t=Object(k.a)(e,2),r=t[0],a=t[1],i=r.split("."),u=Object(k.a)(i,2),o=u[0],l=u[1],c=Object(f.h)(o);if(!n.cubes[c])throw new Error('Order without selecting the cube is not allowed. Did you forget to include the "'.concat(o,'" cube?'));if(!n.cubes[c].fields.find((function(e){return e.name===l})))throw new Error('Order without selecting the member is not allowed. Did you forget to include the "'.concat(l,'" member?'));n.cubes[c].orderBy.push([l,a])}))}}]),e}(),A=t(32),T=t(1),F=s.d.div(g||(g=Object(a.a)(["\n  margin-top: -15px;\n  height: 400px;\n  border-radius: 8px;\n  overflow: hidden;\n\n  .graphiql-container {\n    box-sizing: initial;\n\n    * {\n      box-sizing: initial;\n    }\n\n    .topBar {\n      background: none;\n    }\n\n    .docExplorerShow {\n      border-left: none;\n      background: none;\n    }\n\n    .CodeMirror-scroll,\n    .CodeMirror-lines {\n      background: white;\n    }\n\n    .doc-explorer-title-bar {\n      height: 50px;\n    }\n  }\n"])));function I(e){var n=e.apiUrl,t=e.query,r=e.meta,a=Object(A.h)().token,o=Object(A.k)(),s=a||o,v=Object(d.useMemo)((function(){return Object(i.a)({url:n.replace("/v1","/graphql"),headers:s?{authorization:s}:{}})}),[n,s]),h=Object(d.useMemo)((function(){return Object(f.f)(r)}),[r]),k=Object(b.a)((function(){if(!h)return"";try{var e=new N(t,h).convert();try{return Object(c.format)(e,{parser:"graphql",plugins:[l.a]})}catch(n){return e}}catch(r){return"# ".concat(r,"\n")}}),[t,h]);return Object(T.jsx)(F,{children:Object(T.jsx)(u.a,{query:k,fetcher:v})})}}}]);