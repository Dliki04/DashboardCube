(this["webpackJsonp@cubejs-client/playground"]=this["webpackJsonp@cubejs-client/playground"]||[]).push([[9],{112:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(201);function i(e,t){var n=Object(a.a)(t);return Object(r.useMemo)(e,n)}},158:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return b}));var r=n(7),a=n(10),i=n(44),o=n(0),c=n(32),s=n(1),u=["children"],l=Object(o.createContext)({});function d(e){var t=e.children,n=Object(i.a)(e,u),c=Object(o.useState)(n||null),d=Object(a.a)(c,2),b=d[0],p=d[1],h=Object(o.useCallback)((function(e){p((function(t){return Object(r.a)(Object(r.a)(Object(r.a)({},t),e),{},{playgroundContext:Object(r.a)(Object(r.a)({},null===t||void 0===t?void 0:t.playgroundContext),null===e||void 0===e?void 0:e.playgroundContext)})}))}),[]);return Object(s.jsx)(l.Provider,{value:Object(r.a)(Object(r.a)({apiUrl:null,schemaVersion:0,ready:!1},b),{},{token:(null===b||void 0===b?void 0:b.token)||null,playgroundContext:(null===b||void 0===b?void 0:b.playgroundContext)||{},setContext:h}),children:t})}function b(e){var t=e.onReady,n=Object(c.a)();return Object(o.useEffect)((function(){t(n)}),[n]),null}},201:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(160),a=n.n(r),i=n(0);function o(e){var t=Object(i.useRef)();return a()(t.current,e)||(t.current=e),t.current}},311:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var r=n(12),a=n.n(r),i=n(23),o=n(7),c=n(10),s=n(0),u=n(55),l=n(1),d=Object(s.createContext)(null);function b(e){var t=e.disabled,n=void 0!==t&&t,r=e.children,b=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(s.useRef)(!1),n=Object(s.useState)(null),r=Object(c.a)(n,2),l=r[0],d=r[1],b=Object(s.useState)({loading:!0,active:!1,deploymentUrl:null}),p=Object(c.a)(b,2),h=p[0],f=p[1];Object(s.useEffect)((function(){if(!e){var t=setInterval((function(){j()}),5e3);return j(),function(){clearInterval(t)}}}),[]),Object(s.useEffect)((function(){h.loading||t.current===h.active||v(),t.current=h.active}),[t,h.active,h.loading]);var j=function(){return fetch("/playground/live-preview/status").then((function(e){return e.json()})).then((function(e){f(Object(o.a)({loading:!1},e))}))},m=function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/live-preview/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===h||void 0===h?void 0:h.active)){e.next=8;break}return e.next=3,m({});case 3:t=e.sent,n=t.token,d({token:(null===n||void 0===n?void 0:n.token)||null,apiUrl:(null===h||void 0===h?void 0:h.deploymentUrl)||null}),e.next=9;break;case 8:d(null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{credentials:l,statusLivePreview:h,createTokenWithPayload:m,stopLivePreview:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/live-preview/stop");case 2:return e.next=4,j();case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),startLivePreview:function(){return new Promise((function(e,t){var n=encodeURIComponent(window.location.origin),r="http://localhost:4000"!==window.location.origin&&new URLSearchParams({callbackUrl:n}).toString(),a=Object(u.c)({url:"https://cubecloud.dev/auth/live-preview".concat(r?"?".concat(r):"")});if(!a)return console.error("The popup was blocked by the browser"),void t();var i=setInterval((function(){a.closed&&(clearInterval(i),e(!0),j())}),1e3)}))}}}(n);return Object(l.jsx)(d.Provider,{value:Object(o.a)(Object(o.a)({},b),{},{livePreviewDisabled:n}),children:r})}},32:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"k",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return y})),n.d(t,"h",(function(){return x})),n.d(t,"i",(function(){return k})),n.d(t,"j",(function(){return w})),n.d(t,"l",(function(){return C}));var r=n(0),a=n(158);function i(){return Object(r.useContext)(a.a)}function o(){return i().playgroundContext}function c(){return i().token}var s=n(38);function u(e,t){return Object(r.useMemo)((function(){return t&&e&&"undefined"!==t?Object(s.d)(t,{apiUrl:e}):null}),[e,t])}n(160);var l=n(201);function d(e,t){var n=Object(l.a)(t);return Object(r.useEffect)(e,n)}n(112);function b(){var e=Object(r.useRef)(!0),t=Object(r.useCallback)((function(){return e.current}),[]);return Object(r.useEffect)((function(){return function(){e.current=!1}}),[]),t}var p=n(311);function h(){return Object(r.useContext)(p.a)}var f=n(10),j=n(85),m=n(86),v=n(503),O=new(function(){function e(){var t=this;Object(j.a)(this,e),this.emitter=Object(v.a)(),window.addEventListener("storage",(function(e){if(e.oldValue!==e.newValue){var n;try{n=JSON.parse(e.newValue||"")}catch(r){n=e.newValue}t.emit(e.key,n)}}))}return Object(m.a)(e,[{key:"emit",value:function(e,t){this.emitter.emit(e,t)}},{key:"subscribe",value:function(e,t){this.emitter.on(e,t)}},{key:"unsubscribe",value:function(e,t){this.emitter.off(e,t)}},{key:"setItem",value:function(e,t){if(void 0===t)localStorage.removeItem(e);else{var n=JSON.stringify(t);localStorage.setItem(e,n)}this.emit(e,t)}},{key:"getItem",value:function(e,t){try{var n=localStorage.getItem(e),r="string"===typeof n?JSON.parse(n):void 0;return"function"===typeof t?t(r):void 0!==r?r:t}catch(a){return"function"===typeof t?t(null):t}}},{key:"removeItem",value:function(e){this.setItem(e,void 0)}}]),e}());function y(e,t){var n=i().identifier||"",a=[e,n?":":"",n].join(""),o=function(){return O.getItem(a,t)},c=Object(r.useState)(o),s=Object(f.a)(c,2),u=s[0],l=s[1];return Object(r.useEffect)((function(){return l(o),O.subscribe(a,(function(e){l("function"===typeof t?t(e):e||t)})),function(){O.unsubscribe(a,l)}}),[a]),Object(r.useMemo)((function(){return[u,function(e){return O.setItem(a,e),e},function(){O.removeItem(a)}]}),[a,u])}var g=n(326);function x(){return Object(r.useContext)(g.a)}function k(e){var t=o(),n=t.serverCoreVersion,r=void 0===n?"":n,a=t.coreServerVersion,i=void 0===a?"":a,c=!1;try{var s=(r||i).split(".").map(Number),u=Object(f.a)(s,3),l=u[1],d=u[2],b=e.split(".").map(Number),p=Object(f.a)(b,3),h=p[1],j=p[2];c=l>h||l===h&&d>=j}catch(m){}return c}function w(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(r.useState)(e),n=Object(f.a)(t,2),a=n[0],i=n[1];return[a,function(){return i((function(e){return!e}))}]}function C(){var e=Object(r.useState)({width:void 0,height:void 0}),t=Object(f.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){function e(){a({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}},326:function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return M}));var r,a=n(12),i=n.n(a),o=n(23),c=n(10),s=n(0),u=n(312),l=n(15),d=n(399),b=n(881),p=n(877),h=n(876),f=n(879),j=n(883),m=n(73),v=n(528),O=n(529),y=n(224),g=n(14),x=n(32),k=n(59),w=n(1),C=d.a.TabPane,S=b.a.TextArea,A=p.a.Text,E=p.a.Link,D=g.d.div(r||(r=Object(l.a)(["\n  display: flex;\n  gap: 8px;\n\n  input {\n    text-overflow: ",";\n  }\n"])),(function(e){return e.editing?"unset":"ellipsis"}));function T(){var e=Object(x.h)(),t=e.payload,n=e.token,r=e.isModalOpen,a=e.setIsModalOpen,l=e.saveToken,p=e.onTokenPayloadChange,g=h.a.useForm(),T=Object(c.a)(g,1)[0],P=Object(s.useState)(!1),q=Object(c.a)(P,2),R=q[0],M=q[1],I=Object(s.useState)(!0),L=Object(c.a)(I,2),_=L[0],z=L[1],B=Object(s.useState)(t||""),F=Object(c.a)(B,2),Q=F[0],N=F[1],U=Object(s.useState)(!1),K=Object(c.a)(U,2),V=K[0],Y=K[1],J=Object(s.useRef)(null);function G(){return(G=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Y(!0),e.t0=l,e.next=5,p(Object(u.a)(null===t||void 0===t?void 0:t.token),(null===t||void 0===t?void 0:t.token)||null);case 5:return e.t1=e.sent,e.next=8,(0,e.t0)(e.t1);case 8:e.next=14;break;case 10:return e.prev=10,e.t2=e.catch(0),e.next=14,l((null===t||void 0===t?void 0:t.token)||null);case 14:return e.prev=14,M(!1),a(!1),Y(!1),e.finish(14);case 19:case"end":return e.stop()}}),e,null,[[0,10,14,19]])})))).apply(this,arguments)}function W(){return(W=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_){e.next=19;break}if("function"===typeof p){e.next=3;break}throw new Error("Saving token requires the `onTokenPayloadChange` function provided to the `SecurityContext`");case 3:return Y(!0),e.prev=4,e.t0=l,e.next=8,p(JSON.parse(Q||"{}"),null);case 8:return e.t1=e.sent,e.next=11,(0,e.t0)(e.t1);case 11:e.next=16;break;case 13:e.prev=13,e.t2=e.catch(4),console.error(e.t2);case 16:Y(!1),e.next=22;break;case 19:if(Q){e.next=22;break}return e.next=22,l(null);case 22:a(!1);case 23:case"end":return e.stop()}}),e,null,[[4,13]])})))).apply(this,arguments)}return Object(s.useEffect)((function(){var e;R&&(null===(e=J.current)||void 0===e||e.focus())}),[R]),Object(s.useEffect)((function(){M(!n),N(t),T.setFieldsValue({token:n})}),[T,n,t]),Object(w.jsx)(f.a,{title:"Security Context",visible:r,footer:null,bodyStyle:{paddingTop:8},onCancel:function(){a(!1),M(!1)},children:Object(w.jsx)("div",{"data-testid":"security-context-modal",children:Object(w.jsxs)(j.b,{direction:"vertical",size:24,style:{width:"100%"},children:[Object(w.jsxs)(d.a,{defaultActiveKey:"json",style:{minHeight:200},onChange:function(e){"token"!==e&&R&&n&&(M(!1),T.resetFields())},children:[Object(w.jsx)(C,{tab:"JSON",children:Object(w.jsxs)(j.b,{direction:"vertical",size:16,style:{width:"100%"},children:[Object(w.jsx)(S,{"data-testid":"security-context-textarea",value:Q||"",rows:6,style:{width:"100%"},onChange:function(e){var t=e.target.value;N(t);try{JSON.parse(t),z(!0)}catch(n){z(!1)}}}),Object(w.jsx)(m.a,{"data-testid":"save-security-context-payload-btn",type:"primary",disabled:Boolean(Q&&!_),loading:V,onClick:function(){return W.apply(this,arguments)},children:"Save"})]})},"json"),Object(w.jsx)(C,{"data-testid":"security-modal-token-tab",tab:"Token",children:Object(w.jsxs)(j.b,{direction:"vertical",size:16,style:{width:"100%"},children:[Object(w.jsx)(A,{type:"secondary",children:"Edit or copy the generated token from below"}),Object(w.jsx)(h.a,{form:T,initialValues:{token:n},onFinish:function(e){return G.apply(this,arguments)},children:Object(w.jsxs)(D,{editing:R,children:[Object(w.jsx)(h.a.Item,{name:"token",style:{width:"auto",flexGrow:1},children:Object(w.jsx)(b.a,{"data-testid":"security-context-token-input",ref:J,disabled:!R})}),R?Object(w.jsx)(m.a,{type:"primary",htmlType:"submit",loading:V,icon:Object(w.jsx)(y.a,{})}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(m.a,{ghost:!0,type:"primary",icon:Object(w.jsx)(v.a,{}),onClick:function(){M(!0)}}),Object(w.jsx)(m.a,{type:"primary",icon:Object(w.jsx)(O.a,{}),disabled:!n,onClick:function(){return Object(k.b)(n)},children:"Copy"})]})]})})]})},"token")]}),Object(w.jsxs)(A,{type:"secondary",children:["Learn more about Security Context in"," ",Object(w.jsx)(E,{href:"https://cube.dev/docs/security/context",target:"_blank",children:"docs"})]})]})})})}var P=Object(s.createContext)({payload:"",token:null,currentToken:null,isModalOpen:!1}),q=0,R=null,M=Object(s.memo)((function(e){var t=e.children,n=e.tokenUpdater,r=e.onTokenPayloadChange,a=Object(x.d)(),l=Object(x.f)("cubejsToken",null),d=Object(c.a)(l,3),b=d[0],p=d[1],h=d[2],f=Object(x.a)(),j=f.token,m=f.setContext,v=Object(s.useState)(""),O=Object(c.a)(v,2),y=O[0],g=O[1],k=Object(s.useState)(!1),C=Object(c.a)(k,2),S=C[0],A=C[1],E=b||j;function D(){return M.apply(this,arguments)}function M(){return M=Object(o.a)(i.a.mark((function e(){var t,r,o,c,s=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]&&s[0],null==(r=t?j:E)||!n||R===r){e.next=9;break}return R=r,o=q,e.next=7,n(r);case 7:c=e.sent,a()&&o===q&&(b&&!1===t?p(c):m({token:c}),R=null,q++);case 9:case"end":return e.stop()}}),e)}))),M.apply(this,arguments)}return Object(s.useEffect)((function(){if(E)try{var e=Object(u.a)(E);g(JSON.stringify(e,null,2))}catch(t){g(""),console.error("Invalid JWT token",E)}else g("")}),[E]),Object(w.jsxs)(P.Provider,{value:{token:b,currentToken:E,payload:y,isModalOpen:S,setIsModalOpen:A,saveToken:function(e){return Object(o.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=6;break}return t.next=3,D(!0);case 3:h(),t.next=7;break;case 6:p(e);case 7:case"end":return t.stop()}}),t)})))()},refreshToken:D,onTokenPayloadChange:r},children:[t,Object(w.jsx)(T,{})]})}))},38:function(e,t,n){"use strict";n.d(t,"a",(function(){return ie})),n.d(t,"b",(function(){return Te})),n.d(t,"c",(function(){return se})),n.d(t,"e",(function(){return le})),n.d(t,"f",(function(){return ue})),n.d(t,"g",(function(){return he})),n.d(t,"h",(function(){return fe})),n.d(t,"i",(function(){return de})),n.d(t,"j",(function(){return pe})),n.d(t,"k",(function(){return be})),n.d(t,"l",(function(){return oe})),n.d(t,"m",(function(){return ce}));n(413),n(422),n(423),n(424),n(618),n(621),n(622),n(282),n(430),n(431),n(432),n(434),n(629),n(634),n(440),n(442),n(443),n(444),n(445),n(637),n(446),n(452),n(360),n(455),n(649),n(650),n(457),n(653),n(459),n(654),n(460),n(463),n(657);var r=n(40),a=n.n(r),i=n(37),o=n.n(i),c=n(81),s=n.n(c),u=n(82),l=n.n(u),d=n(74),b=n.n(d),p=n(27),h=n.n(p),f=n(859),j=n(124),m=n.n(j),v=n(56),O=n.n(v),y=n(36),g=n.n(y),x=n(392),k=n.n(x),w=n(499),C=n.n(w),S=n(500),A=n.n(S),E=n(258),D=n(853),T=n(256),P=n(533),q=(n(854),n(401),n(259)),R=n(144),M=n(861),I=n(254),L=n(855),_=n(856),z=n(857),B=n(534),F=n(403),Q=n(535),N=n(862),U=n(863),K=n(858),V=n(860),Y=n(501),J=n.n(Y),G=(n(666),n(121)),W=n.n(G),H=n(205),Z=n.n(H),$=n(135),X=n.n($),ee=n(502),te=n.n(ee),ne=["query"];function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie=[{name:void 0,title:"w/o grouping"},{name:"second",title:"Second"},{name:"minute",title:"Minute"},{name:"hour",title:"Hour"},{name:"day",title:"Day"},{name:"week",title:"Week"},{name:"month",title:"Month"},{name:"quarter",title:"Quarter"},{name:"year",title:"Year"}];function oe(e){var t=e||{};return Object(E.a)(Object(D.a)(t).map((function(e){var t=g()(e,2),n=t[0],r=t[1];if(["measures","dimensions","segments","timeDimensions","filters"].includes(n)&&Array.isArray(r)&&0===r.length)return null;if("order"===n&&r){if(Array.isArray(r)&&!r.length)return null;if(!Object.keys(r).length)return null}return[n,r]})).filter(Boolean))}function ce(e){var t=e||{};return oe(ae(ae({},t),{},{filters:(t.filters||[]).filter((function(e){return e.operator})),timeDimensions:(t.timeDimensions||[]).filter((function(e){return!(!e.dateRange&&!e.granularity)}))}))}function se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(T.a)(Object.entries(e&&e.order||{}),Object.entries(t&&t.order||{}))&&Object(T.a)(e,t)}function ue(e){var t=(e.timeDimensions||[]).find((function(e){return e.granularity}));return t?a()({},t.dimension,"asc"):(e.measures||[]).length>0&&(e.dimensions||[]).length>0?a()({},e.measures[0],"desc"):(e.dimensions||[]).length>0?a()({},e.dimensions[0],"asc"):{}}function le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=Object(P.a)(e),a=r.query,i=m()(r,ne),o=n.meta,c=n.sessionGranularity,s=c||"day",u=ae({query:a},i),l=null;if(se(a,t)||(l=a),Array.isArray(l)||Array.isArray(t))return e;if(l){if(1===(t.timeDimensions||[]).length&&1===(l.timeDimensions||[]).length&&l.timeDimensions[0].granularity&&t.timeDimensions[0].granularity!==l.timeDimensions[0].granularity&&(u=ae(ae({},u),{},{sessionGranularity:l.timeDimensions[0].granularity})),0===(t.measures||[]).length&&(l.measures||[]).length>0||1===(t.measures||[]).length&&1===(l.measures||[]).length&&t.measures[0]!==l.measures[0]){var d=l.timeDimensions||[],b=g()(d,1),p=b[0],h=o.defaultTimeDimensionNameFor(l.measures[0]);return l=ae(ae({},l),{},{timeDimensions:h?[{dimension:h,granularity:p&&p.granularity||s,dateRange:p&&p.dateRange}]:[]}),ae(ae({},u),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:l,chartType:h?"line":"number"})}return 0===(t.dimensions||[]).length&&(l.dimensions||[]).length>0?(l=ae(ae({},l),{},{timeDimensions:(l.timeDimensions||[]).map((function(e){return ae(ae({},e),{},{granularity:void 0})}))}),ae(ae({},u),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:l,chartType:"table"})):(t.dimensions||[]).length>0&&0===(l.dimensions||[]).length?(l=ae(ae({},l),{},{timeDimensions:(l.timeDimensions||[]).map((function(e){return ae(ae({},e),{},{granularity:e.granularity||s})}))}),ae(ae({},u),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:l,chartType:(l.timeDimensions||[]).length?"line":"number"})):((t.dimensions||[]).length>0||(t.measures||[]).length>0)&&0===(l.dimensions||[]).length&&0===(l.measures||[]).length?(l=ae(ae({},l),{},{timeDimensions:[],filters:[]}),ae(ae({},u),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:l,sessionGranularity:null})):u}if(u.chartType){var f=u.chartType;if(("line"===f||"area"===f)&&1===(t.timeDimensions||[]).length&&!t.timeDimensions[0].granularity){var j=g()(t.timeDimensions,1),v=j[0];return ae(ae({},u),{},{pivotConfig:null,query:ae(ae({},t),{},{timeDimensions:[ae(ae({},v),{},{granularity:s})]})})}if(("pie"===f||"table"===f||"number"===f)&&1===(t.timeDimensions||[]).length&&t.timeDimensions[0].granularity){var O=g()(t.timeDimensions,1),y=O[0];return ae(ae({},u),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:ae(ae({},t),{},{timeDimensions:[ae(ae({},y),{},{granularity:void 0})]})})}}return u}function de(e){return!!e&&(Array.isArray(e)?e:[e]).every((function(e){return e.measures&&e.measures.length||e.dimensions&&e.dimensions.length||e.timeDimensions&&e.timeDimensions.length}))}function be(e,t,n,r,a){var i=ae(ae({},e),{},{x:O()(e.x),y:O()(e.y)}),o=e[r][t],c=i[a].length-1;return"measures"===o?n=c+1:n>=c&&"measures"===i[a][c]&&(n=c-1),i[r].splice(t,1),i[a].splice(n,0,o),i}function pe(e,t,n){var r=O()(e),a=r.splice(t,1),i=g()(a,1)[0];return r.splice(n,0,i),r}function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t){return t.or||t.and?[].concat(O()(e),O()(he(t.or||t.and))):[].concat(O()(e),[t])}),[])}function fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=["measures","dimensions","segments"],n=new Set;return t.forEach((function(t){return(e[t]||[]).forEach((function(e){return n.add(e)}))})),(e.timeDimensions||[]).forEach((function(e){return n.add(e.dimension)})),he(e.filters).forEach((function(e){return n.add(e.dimension||e.member)})),O()(n)}function je(e,t,n,r){var a=e.filter((function(e){return null!=e}));return n&&n.aliasSeries&&n.aliasSeries[t]?[n.aliasSeries[t]].concat(O()(a)):r.has(a[0])?[t].concat(O()(a)):a}var me=["x"],ve=["key"],Oe=["title","shortTitle"];function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}k.a.extend(C.a);var xe=function(){return k.a.apply(void 0,arguments).locale(ge(ge({},A.a),{},{weekStart:1}))},ke={day:function(e){return e.by("d").map((function(e){return e.format("YYYY-MM-DDT00:00:00.000")}))},month:function(e){return e.snapTo("month").by("M").map((function(e){return e.format("YYYY-MM-01T00:00:00.000")}))},year:function(e){return e.snapTo("year").by("y").map((function(e){return e.format("YYYY-01-01T00:00:00.000")}))},hour:function(e){return e.by("h").map((function(e){return e.format("YYYY-MM-DDTHH:00:00.000")}))},minute:function(e){return e.by("m").map((function(e){return e.format("YYYY-MM-DDTHH:mm:00.000")}))},second:function(e){return e.by("s").map((function(e){return e.format("YYYY-MM-DDTHH:mm:ss.000")}))},week:function(e){return e.snapTo("week").by("w").map((function(e){return e.startOf("week").format("YYYY-MM-DDT00:00:00.000")}))},quarter:function(e){return e.snapTo("quarter").by("quarter").map((function(e){return e.startOf("quarter").format("YYYY-MM-DDT00:00:00.000")}))}},we=/^\d\d\d\d-\d\d-\d\d$/,Ce=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z?$/,Se=function(e){var t=new Map;return function(n){return n.forEach((function(n){var r=e(n);t.has(r)||t.set(r,[]),t.get(r).push(n)})),Array.from(t.entries())}},Ae=function(e){var t=[];return e.forEach((function(e){e.forEach((function(e){return t.push(e)}))})),t},Ee=function e(t,n){return{by:function(e){for(var r=[],a=xe(t),i=xe(n);a.isBefore(i)||a.isSame(i);)r.push(a),a=a.add(1,e);return r},snapTo:function(r){return e(xe(t).startOf(r),xe(n).endOf(r))},start:xe(t),end:xe(n)}},De={REGULAR_QUERY:"regularQuery",COMPARE_DATE_RANGE_QUERY:"compareDateRangeQuery",BLENDING_QUERY:"blendingQuery"},Te=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(s()(this,e),this.loadResponse=t,null!=this.loadResponse.queryType?(this.queryType=t.queryType,this.loadResponses=t.results):(this.queryType=De.REGULAR_QUERY,this.loadResponse.pivotQuery=ge(ge({},t.query),{},{queryType:this.queryType}),this.loadResponses=[t]),!Object.values(De).includes(this.queryType))throw new Error("Unknown query type");this.parseDateMeasures=n.parseDateMeasures,this.options=n,this.backwardCompatibleData=[]}return l()(e,[{key:"drillDown",value:function(e,t){if(this.queryType===De.COMPARE_DATE_RANGE_QUERY)throw new Error("compareDateRange drillDown query is not currently supported");if(this.queryType===De.BLENDING_QUERY)throw new Error("Data blending drillDown query is not currently supported");var n=e.xValues,r=void 0===n?[]:n,a=e.yValues,i=void 0===a?[]:a,o=this.normalizePivotConfig(t),c=[];o.x.forEach((function(e,t){return c.push([e,r[t]])})),o.y.forEach((function(e,t){return c.push([e,i[t]])}));var s=this.query(),u=s.filters,l=void 0===u?[]:u,d=s.segments,b=void 0===d?[]:d,p=this.loadResponses[0].annotation.measures,h=c.find((function(e){return"measures"===g()(e,1)[0]}))||[],f=g()(h,2)[1];if(void 0===f){var j=Object.keys(p);f=g()(j,1)[0]}if(!(p[f]&&p[f].drillMembers||[]).length)return null;var m=[{member:f,operator:"measureFilter"}].concat(O()(l)),v=[];c.filter((function(e){return"measures"!==g()(e,1)[0]})).forEach((function(e){var t=g()(e,2),n=t[0],r=t[1],a=n.split("."),i=g()(a,3),o=i[0],c=i[1],s=i[2];if(void 0!==s){var u=Ee(r,r).snapTo(s);v.push({dimension:[o,c].join("."),dateRange:[u.start,u.end].map((function(e){return e.format("YYYY-MM-DDTHH:mm:ss.SSS")}))})}else null==r?m.push({member:n,operator:"notSet"}):m.push({member:n,operator:"equals",values:[r.toString()]})}));var y=this.loadResponses[0].query;return 0===v.length&&y.timeDimensions.length>0&&null==y.timeDimensions[0].granularity&&v.push(y.timeDimensions[0]),ge(ge(ge({},p[f].drillMembersGrouped),{},{filters:m},b.length>0?{segments:b}:{}),{},{timeDimensions:v,segments:b,timezone:y.timezone})}},{key:"series",value:function(e){var t=this;return this.seriesNames(e).map((function(n){var r=n.title,a=n.key;return{title:r,key:a,series:t.chartPivot(e).map((function(e){var t=e.x;return{value:m()(e,me)[a],x:t}}))}}))}},{key:"axisValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.loadResponses[t].query;return function(t){var r=function(n){return e.filter((function(e){return"measures"!==e})).map((function(e){return null!=t[e]?t[e]:null})).concat(n?[n]:[])};return e.find((function(e){return"measures"===e}))&&(n.measures||[]).length?n.measures.map(r):[r()]}}},{key:"axisValuesString",value:function(e,t){return e.map((function(e){return null==e?"\u2205":""===e?"[Empty string]":e})).join(t||", ")}},{key:"normalizePivotConfig",value:function(t){return e.getNormalizedPivotConfig(this.loadResponse.pivotQuery,t)}},{key:"timeSeries",value:function(t,n){if(!t.granularity)return null;var r=t.dateRange;if(!r){var a=e.timeDimensionMember(t),i=Object(q.a)(Object(R.a)((function(e){return e[a]&&xe(e[a])})),Object(M.a)(Boolean))(this.timeDimensionBackwardCompatibleData(n));r=i.length&&[Object(I.a)(Object(L.a)((function(e){return e.toDate()})),i[0],i),Object(I.a)(Object(_.a)((function(e){return e.toDate()})),i[0],i)]||null}if(!r)return null;var o=t.dateRange?t.dateRange.find((function(e){return e.match(we)})):!["hour","minute","second"].includes(t.granularity),c=r,s=g()(c,2),u=s[0],l=s[1],d=Ee(u,l);if(!ke[t.granularity])throw new Error("Unsupported time granularity: ".concat(t.granularity));return ke[t.granularity](o?d.snapTo("d"):d)}},{key:"pivot",value:function(t){var n=this;t=this.normalizePivotConfig(t);var r=this.loadResponse.pivotQuery,a=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=Se((function(e){var t=e.xValues;return n.axisValuesString(t)})),o=function(e,t){return e[t]||0};if(t.fillMissingDates&&1===t.x.length&&Object(T.a)(t.x,(r.timeDimensions||[]).filter((function(e){return Boolean(e.granularity)})).map((function(t){return e.timeDimensionMember(t)})))){var c=n.loadResponses.map((function(e){return n.timeSeries(e.query.timeDimensions[0],a)}));c[0]&&(i=function(e){var t=Object(z.a)((function(e){return e.xValues[0]}),e);return c[a].map((function(e){return[e,t[e]||[{xValues:[e],row:{}}]]}))})}var s=Object(q.a)(Object(R.a)((function(e){return n.axisValues(t.x,a)(e).map((function(t){return{xValues:t,row:e}}))})),Ae,i)(n.timeDimensionBackwardCompatibleData(a)),u={};s.forEach((function(e){g()(e,2)[1].forEach((function(e){var r=e.row;n.axisValues(t.y,a)(r).forEach((function(e){Object.keys(r).length>0&&(u[e.join()]=e)}))}))}));var l=Object.values(u),d=Boolean(t.x.find((function(e){return"measures"===e})));return s.map((function(r){var i=g()(r,2)[1],c=i[0].xValues,s={};return i.forEach((function(e){var r=e.row;n.axisValues(t.y,a)(r).map((function(e){return{yValues:e,row:r}})).forEach((function(e){s[n.axisValuesString(e.yValues)]=e}))})),{xValues:c,yValuesArray:Ae(l.map((function(t){var r=d?e.measureFromAxis(c):e.measureFromAxis(t);return[[t,o((s[n.axisValuesString(t)]||{row:{}}).row,r)]]})))}}))},i=this.loadResponses.length>1?this.loadResponses.map((function(e,t){return a(t)})):[];return i.length?this.mergePivots(i,t.joinDateRange):a()}},{key:"mergePivots",value:function(e,t){var n=e.reduce((function(e,t){return null!=e&&t.length>=e.length?e:t}),null);return n.map((function(r,a){return{xValues:t?[e.map((function(e){return e[a]&&e[a].xValues||[]})).join(", ")]:n[a].xValues,yValuesArray:Ae(e.map((function(e){return e[a].yValuesArray})))}}))}},{key:"pivotedRows",value:function(e){return this.chartPivot(e)}},{key:"chartPivot",value:function(e){var t=this,n=new Set;this.queryType===De.BLENDING_QUERY&&Object(B.a)(this.loadResponses.map((function(e){return e.query.measures}))).filter((function(e,t,n){return n.indexOf(e)!==t})).forEach((function(e){return n.add(e)}));return this.pivot(e).map((function(r){var a=r.xValues,i=r.yValuesArray,o={};return i.forEach((function(r,a){var i,c=g()(r,2),s=c[0],u=c[1];o[t.axisValuesString(je(s,a,e,n),",")]=u&&(i=u,t.parseDateMeasures&&Ce.test(i)?new Date(i):Number.isNaN(Number.parseFloat(i))?i:Number.parseFloat(i))})),ge({x:t.axisValuesString(a,","),xValues:a},o)}))}},{key:"tablePivot",value:function(e){var t=this.normalizePivotConfig(e||{}),n=t.x.concat(t.y).includes("measures");return this.pivot(t).map((function(e){var r=e.xValues,a=e.yValuesArray;return Object(E.a)(t.x.map((function(e,t){return[e,r[t]]})).concat(n?a.map((function(e){var t=g()(e,2),n=t[0],r=t[1];return[n.length?n.join():"value",r]})):[]))}))}},{key:"tableColumns",value:function(e){var t=this.normalizePivotConfig(e||{}),n=Object(q.a)(Object(F.a)("annotation"),Object(I.a)(Object(Q.a)(),{}))(this.loadResponses),r=Object.values(n).reduce((function(e,t){return ge(ge({},e),t)}),{}),a={},i=function(e){var t=r[e]||{};return{key:e,title:t.title,shortTitle:t.shortTitle,type:t.type,format:t.format,meta:t.meta}},o=this.pivot(t);(o[0]&&o[0].yValuesArray||[]).forEach((function(e){var n=g()(e,1)[0];if(n.length>0){var r=a;n.forEach((function(e,n){r["_".concat(e)]={key:e,memberId:"measures"===t.y[n]?e:t.y[n],children:r["_".concat(e)]&&r["_".concat(e)].children||{}},r=r["_".concat(e)].children}))}}));var c=[];return!o.length&&t.y.includes("measures")&&(c=(this.loadResponses[0].query.measures||[]).map((function(e){return ge(ge({},i(e)),{},{dataIndex:e})}))),!t.y.length&&t.x.includes("measures")&&c.push({key:"value",dataIndex:"value",title:"Value",shortTitle:"Value",type:"string"}),t.x.map((function(e){return"measures"===e?{key:"measures",dataIndex:"measures",title:"Measures",shortTitle:"Measures",type:"string"}:ge(ge({},i(e)),{},{dataIndex:e})})).concat(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return 0===Object.keys(t).length?[]:Object.values(t).map((function(t){var r=t.key,a=m()(t,ve),o=e(a.children,[].concat(O()(n),[r])),c=i(a.memberId),s=c.title,u=c.shortTitle,l=m()(c,Oe),d=r!==a.memberId||null==s?r:"";return o.length?ge(ge({},l),{},{key:r,title:[s,d].join(" ").trim(),shortTitle:d||u,children:o}):ge(ge({},l),{},{key:r,dataIndex:[].concat(O()(n),[r]).join(),title:[s,d].join(" ").trim(),shortTitle:d||u})}))}(a)).concat(c)}},{key:"totalRow",value:function(e){return this.chartPivot(e)[0]}},{key:"categories",value:function(e){return this.chartPivot(e)}},{key:"seriesNames",value:function(t){var n=this;t=this.normalizePivotConfig(t);var r=Object(q.a)(Object(F.a)("annotation"),Object(F.a)("measures"),N.a)(this.loadResponses),a=Ae(this.loadResponses.map((function(e,r){return Object(q.a)(Object(R.a)(n.axisValues(t.y,r)),Ae,U.a)(n.timeDimensionBackwardCompatibleData(r))}))),i=new Set;this.queryType===De.BLENDING_QUERY&&Object(B.a)(this.loadResponses.map((function(e){return e.query.measures}))).filter((function(e,t,n){return n.indexOf(e)!==t})).forEach((function(e){return i.add(e)}));return a.map((function(a,o){var c=je(a,o,t,i);return{title:n.axisValuesString(t.y.find((function(e){return"measures"===e}))?Object(K.a)(1,c).concat(r[e.measureFromAxis(a)].title):c,", "),key:n.axisValuesString(c,","),yValues:a}}))}},{key:"query",value:function(){if(this.queryType!==De.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].query}},{key:"pivotQuery",value:function(){return this.loadResponse.pivotQuery||null}},{key:"rawData",value:function(){if(this.queryType!==De.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].data}},{key:"annotation",value:function(){if(this.queryType!==De.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].annotation}},{key:"timeDimensionBackwardCompatibleData",value:function(t){if(void 0===t)throw new Error("resultIndex is required");if(!this.backwardCompatibleData[t]){var n=this.loadResponses[t],r=n.data,a=(n.query.timeDimensions||[]).filter((function(e){return Boolean(e.granularity)}));this.backwardCompatibleData[t]=r.map((function(t){return ge(ge({},t),Object(E.a)(Object.keys(t).filter((function(n){return a.find((function(e){return e.dimension===n}))&&!t[e.timeDimensionMember(a.find((function(e){return e.dimension===n})))]})).map((function(n){return[e.timeDimensionMember(a.find((function(e){return e.dimension===n}))),t[n]]}))))}))}return this.backwardCompatibleData[t]}},{key:"decompose",value:function(){var t=this;return this.loadResponses.map((function(n){return new e({queryType:De.REGULAR_QUERY,pivotQuery:ge(ge({},n.query),{},{queryType:De.REGULAR_QUERY}),results:[n]},t.options)}))}},{key:"serialize",value:function(){return{loadResponse:Object(P.a)(this.loadResponse)}}}],[{key:"measureFromAxis",value:function(e){return e[e.length-1]}},{key:"timeDimensionMember",value:function(e){return"".concat(e.dimension,".").concat(e.granularity)}},{key:"deserialize",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new e(t.loadResponse,n)}},{key:"getNormalizedPivotConfig",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={x:[],y:[],fillMissingDates:!0,joinDateRange:!1},a=t.measures,i=void 0===a?[]:a,o=t.dimensions,c=void 0===o?[]:o,s=(t.timeDimensions||[]).filter((function(e){return!!e.granularity}));n=n||(s.length?{x:s.map((function(t){return e.timeDimensionMember(t)})),y:c}:{x:c,y:[]});var u=function(n){return n.map((function(n){return s.find((function(e){return e.dimension===n}))&&!c.find((function(e){return e===n}))?e.timeDimensionMember(t.timeDimensions.find((function(e){return e.dimension===n}))):n}))};(n=Object(Q.a)(n,r)).x=u(n.x),n.y=u(n.y);var l=n.x.concat(n.y),d=s.map((function(t){return e.timeDimensionMember(t)})).concat(c),b=function(e){return d.includes(e)||"measures"===e};return n.x=n.x.concat(d.filter((function(e){return!l.includes(e)&&"compareDateRange"!==e}))).filter(b),n.y=n.y.filter(b),n.x.concat(n.y).find((function(e){return"measures"===e}))||n.y.push("measures"),c.includes("compareDateRange")&&!n.y.concat(n.x).includes("compareDateRange")&&n.y.unshift("compareDateRange"),i.length||(n.x=n.x.filter((function(e){return"measures"!==e})),n.y=n.y.filter((function(e){return"measures"!==e}))),n}}]),e}(),Pe=function(){function e(t){s()(this,e),this.sqlQuery=t}return l()(e,[{key:"rawQuery",value:function(){return this.sqlQuery.sql}},{key:"sql",value:function(){return this.rawQuery().sql[0]}}]),e}(),qe=function(e){return Object(E.a)(e.map((function(e){return[e.name,e]})))},Re={string:[{name:"contains",title:"contains"},{name:"notContains",title:"does not contain"},{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"}],number:[{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"},{name:"gt",title:">"},{name:"gte",title:">="},{name:"lt",title:"<"},{name:"lte",title:"<="}],time:[{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"inDateRange",title:"in date range"},{name:"notInDateRange",title:"not in date range"},{name:"afterDate",title:"after date"},{name:"beforeDate",title:"before date"}]},Me=function(){function e(t){s()(this,e),this.meta=t;var n=this.meta.cubes;this.cubes=n,this.cubesMap=Object(E.a)(n.map((function(e){return[e.name,{measures:qe(e.measures),dimensions:qe(e.dimensions),segments:qe(e.segments)}]})))}return l()(e,[{key:"membersForQuery",value:function(e,t){return Object(V.a)(this.cubes.map((function(e){return e[t]}))).sort((function(e,t){return e.title>t.title?1:-1}))}},{key:"membersGroupedByCube",value:function(){var e=["measures","dimensions","segments","timeDimensions"];return this.cubes.reduce((function(t,n){return e.forEach((function(e){var r=n[e];"timeDimensions"===e&&(r=n.dimensions.filter((function(e){return"time"===e.type}))),t[e]=[].concat(O()(t[e]),[{cubeName:n.name,cubeTitle:n.title,members:r}])})),t}),{measures:[],dimensions:[],segments:[],timeDimensions:[]})}},{key:"resolveMember",value:function(e,t){var n=this,r=e.split("."),a=g()(r,1)[0];if(!this.cubesMap[a])return{title:e,error:"Cube not found ".concat(a," for path '").concat(e,"'")};var i=(Array.isArray(t)?t:[t]).map((function(t){return n.cubesMap[a][t]&&n.cubesMap[a][t][e]})).find((function(e){return e}));return i||{title:e,error:"Path not found '".concat(e,"'")}}},{key:"defaultTimeDimensionNameFor",value:function(e){var t=this,n=e.split("."),r=g()(n,1)[0];return this.cubesMap[r]?Object.keys(this.cubesMap[r].dimensions||{}).find((function(e){return"time"===t.cubesMap[r].dimensions[e].type})):null}},{key:"filterOperatorsForMember",value:function(e,t){var n=this.resolveMember(e,t);return Re[n.type]||Re.string}}]),e}(),Ie=function(){function e(t){s()(this,e),this.progressResponse=t}return l()(e,[{key:"stage",value:function(){return this.progressResponse.stage}},{key:"timeElapsed",value:function(){return this.progressResponse.timeElapsed}}]),e}(),Le=["baseRequestId"];function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Be=function(){function e(t){var n=t.authorization,r=t.apiUrl,a=t.method,i=t.headers,o=void 0===i?{}:i,c=t.credentials;s()(this,e),this.authorization=n,this.apiUrl=r,this.method=a,this.headers=o,this.credentials=c}return l()(e,[{key:"request",value:function(e,t){var n=this,r=t.baseRequestId,i=m()(t,Le),c=1,s=new URLSearchParams(i&&Object.keys(i).map((function(e){return a()({},e,"object"===o()(i[e])?JSON.stringify(i[e]):i[e])})).reduce((function(e,t){return ze(ze({},e),t)}),{})),u="".concat(this.apiUrl,"/").concat(e).concat(s.toString().length?"?".concat(s):""),l=this.method||(u.length<2e3?"GET":"POST");"POST"===l&&(u="".concat(this.apiUrl,"/").concat(e),this.headers["Content-Type"]="application/json");return{subscribe:function(e){var t=this;return b()(h.a.mark((function a(){var o;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o={error:"network Error"},a.prev=1,a.next=4,J()(u,{method:l,headers:ze({Authorization:n.authorization,"x-request-id":r&&"".concat(r,"-span-").concat(c++)},n.headers),credentials:n.credentials,body:"POST"===l?JSON.stringify(i):null});case 4:o=a.sent;case 5:return a.prev=5,a.abrupt("return",e(o,(function(){return t.subscribe(e)})));case 8:case"end":return a.stop()}}),a,null,[[1,,5,8]])})))()}}}}]),e}();function Fe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=X()(e);if(t){var a=X()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Z()(this,n)}}var Qe=function(e){W()(n,e);var t=Fe(n);function n(e,r,a){var i;return s()(this,n),(i=t.call(this,e)).response=r,i.status=a,i}return l()(n)}(te()(Error));function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ke=0,Ve="Mutex has been changed",Ye="default",Je="compact";var Ge=function(){function e(t,n){if(s()(this,e),null===t||Array.isArray(t)||"object"!==o()(t)||(n=t,t=void 0),!(n=n||{}).transport&&!n.apiUrl)throw new Error("The `apiUrl` option is required");this.apiToken=t,this.apiUrl=n.apiUrl,this.method=n.method,this.headers=n.headers||{},this.credentials=n.credentials,this.transport=n.transport||new Be({authorization:"function"===typeof t?void 0:t,apiUrl:this.apiUrl,method:this.method,headers:this.headers,credentials:this.credentials}),this.pollInterval=n.pollInterval||5,this.parseDateMeasures=n.parseDateMeasures,this.updateAuthorizationPromise=null}return l()(e,[{key:"request",value:function(e,t){return this.transport.request(e,Ue({baseRequestId:Object(f.a)()},t))}},{key:"loadMethod",value:function(e,t,n,r){var a=this,i=++Ke;"function"!==typeof n||r||(r=n,n=void 0);var o=(n=n||{}).mutexKey||"default";n.mutexObj&&(n.mutexObj[o]=i);var c=this.updateTransportAuthorization().then((function(){return e()})),s=!0,u=!1,l=function(){var e=b()(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c;case 2:if(t=e.sent,!n.mutexObj||n.mutexObj[o]===i){e.next=9;break}if(u=!0,!t.unsubscribe){e.next=8;break}return e.next=8,t.unsubscribe();case 8:throw Ve;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=b()(h.a.mark((function e(i,o){var d,p,f,j,m,v,O;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c;case 2:if(d=e.sent,p=function(){var e=b()(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.subscribe||u){e.next=8;break}if(!d.unsubscribe){e.next=5;break}return e.abrupt("return",o());case 5:return e.next=7,new Promise((function(e){return setTimeout((function(){return e()}),1e3*a.pollInterval)}));case 7:return e.abrupt("return",o());case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=b()(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=5;break}if(!t){e.next=4;break}return e.next=4,new Promise((function(e){return setTimeout((function(){return e()}),1e3*a.pollInterval)}));case 4:return e.abrupt("return",o());case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),!n.subscribe||s){e.next=8;break}return e.next=8,a.updateTransportAuthorization();case 8:if(s=!1,502!==i.status){e.next=13;break}return e.next=12,l();case 12:return e.abrupt("return",f(!0));case 13:return j={},m="",e.prev=15,e.next=18,i.text();case 18:m=e.sent,j=JSON.parse(m),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(15),j.error=m;case 25:if("Continue wait"!==j.error){e.next=30;break}return e.next=28,l();case 28:return n.progressCallback&&n.progressCallback(new Ie(j)),e.abrupt("return",f());case 30:if(200===i.status){e.next=43;break}return e.next=33,l();case 33:if(n.subscribe||!d.unsubscribe){e.next=36;break}return e.next=36,d.unsubscribe();case 36:if(v=new Qe(j.error,j,i.status),!r){e.next=41;break}r(v),e.next=42;break;case 41:throw v;case 42:return e.abrupt("return",p());case 43:return e.next=45,l();case 45:if(n.subscribe||!d.unsubscribe){e.next=48;break}return e.next=48,d.unsubscribe();case 48:if(O=t(j),!r){e.next=53;break}r(null,O),e.next=54;break;case 53:return e.abrupt("return",O);case 54:return e.abrupt("return",p());case 55:case"end":return e.stop()}}),e,null,[[15,22]])})));return function(t,n){return e.apply(this,arguments)}}(),p=c.then((function(e){return function(e){return new Promise(function(){var t=b()(h.a.mark((function t(n,r){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=n,t.next=4,e;case 4:t.t1=t.sent,(0,t.t0)(t.t1),t.next=11;break;case 8:t.prev=8,t.t2=t.catch(0),t.t2!==Ve&&r(t.t2);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}())}(e.subscribe(d))}));return r?{unsubscribe:function(){var e=b()(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c;case 2:if(t=e.sent,u=!0,!t.unsubscribe){e.next=6;break}return e.abrupt("return",t.unsubscribe());case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}:p}},{key:"updateTransportAuthorization",value:function(){var e=b()(h.a.mark((function e(){var t=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.updateAuthorizationPromise){e.next=4;break}return e.next=3,this.updateAuthorizationPromise;case 3:return e.abrupt("return");case 4:if("function"!==typeof this.apiToken){e.next=8;break}return this.updateAuthorizationPromise=new Promise(function(){var e=b()(h.a.mark((function e(n,r){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.apiToken();case 3:a=e.sent,t.transport.authorization!==a&&(t.transport.authorization=a),n(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),r(e.t0);case 11:return e.prev=11,t.updateAuthorizationPromise=null,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t,n){return e.apply(this,arguments)}}()),e.next=8,this.updateAuthorizationPromise;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"patchQueryInternal",value:function(e,t){return t===Je&&e.responseFormat!==Je?Ue(Ue({},e),{},{responseFormat:Je}):e}},{key:"loadResponseInternal",value:function(e){return e.results.length&&e.results[0].query.responseFormat&&e.results[0].query.responseFormat===Je&&e.results.forEach((function(t,n){var r=[];t.data.dataset.forEach((function(e){var n={};t.data.members.forEach((function(t,r){n[t]=e[r]})),r.push(n)})),e.results[n].data=r})),new Te(e,{parseDateMeasures:this.parseDateMeasures})}},{key:"load",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ye;return a===Je&&(e=Array.isArray(e)?e.map((function(e){return r.patchQueryInternal(e,Je)})):this.patchQueryInternal(e,Je)),this.loadMethod((function(){return r.request("load",{query:e,queryType:"multi"})}),this.loadResponseInternal.bind(this),t,n)}},{key:"subscribe",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ye;return a===Je&&(e=Array.isArray(e)?e.map((function(e){return r.patchQueryInternal(e,Je)})):this.patchQueryInternal(e,Je)),this.loadMethod((function(){return r.request("subscribe",{query:e,queryType:"multi"})}),this.loadResponseInternal.bind(this),Ue(Ue({},t),{},{subscribe:!0}),n)}},{key:"sql",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("sql",{query:e})}),(function(e){return Array.isArray(e)?e.map((function(e){return new Pe(e)})):new Pe(e)}),t,n)}},{key:"meta",value:function(e,t){var n=this;return this.loadMethod((function(){return n.request("meta")}),(function(e){return new Me(e)}),e,t)}},{key:"dryRun",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("dry-run",{query:e})}),(function(e){return e}),t,n)}}]),e}();t.d=function(e,t){return new Ge(e,t)}},55:function(e,t,n){"use strict";n.d(t,"f",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return j})),n.d(t,"c",(function(){return v}));var r=n(12),a=n.n(r),i=n(23),o=n(44),c=n(52),s=n(50),u=n(7),l=n(10),d=["retries"];function b(e){return e[0].toUpperCase()+e.slice(1)}function p(e){var t=[];return e.forEach((function(e){return e.members.forEach((function(e){t.push([e.name,e])}))})),t}function h(e){var t={};return Object.entries(e).forEach((function(e){var n=Object(l.a)(e,2),r=n[0];n[1].forEach((function(e){t[e.cubeName]||(t[e.cubeName]={cubeName:e.cubeName,cubeTitle:e.cubeTitle,measures:[],dimensions:[],segments:[],timeDimensions:[]}),e.members.forEach((function(n){t[e.cubeName]=Object(u.a)(Object(u.a)({},t[e.cubeName]),{},Object(c.a)({},r,[].concat(Object(s.a)(t[e.cubeName][r]),[n])))}))}))})),Object.values(t)}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.retries,r=void 0===n?0:n,c=Object(o.a)(t,d);return fetch(e,c).then(function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(500!==t.status){e.next=6;break}return e.next=3,t.text();case 3:n=e.sent;try{r=JSON.parse(n),n=r.error}catch(a){}throw n;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(n){if("Network request failed"===n.message&&r>0)return f(e,{options:t,retries:r-1});throw n}))}function j(e){return m.apply(this,arguments)}function m(){return m=Object(i.a)(a.a.mark((function e(t){var n,r,i,o,c,s,l=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:"GET",r=l.length>2&&void 0!==l[2]?l[2]:{},i=r.body,o=r.token,c={},o&&(c.authorization=o),e.next=7,fetch(t,Object(u.a)({method:n,headers:Object(u.a)({"Content-Type":"application/json"},c)},i?{body:JSON.stringify(i)}:null));case 7:return s=e.sent,e.t0=s.ok,e.next=11,s.json();case 11:return e.t1=e.sent,e.abrupt("return",{ok:e.t0,json:e.t1});case 13:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function v(e){var t,n=e.url,r=e.title,a=void 0===r?"":r,i=e.width,o=void 0===i?640:i,c=e.height,s=void 0===c?720:c,u=void 0!==window.screenLeft?window.screenLeft:window.screenX,l=void 0!==window.screenTop?window.screenTop:window.screenY,d=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,b=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,p=d/window.screen.availWidth,h=(d-o)/2/p+u,f=(b-s)/2/p+l,j=window.open(n,a,"\n      scrollbars=yes,\n      width=".concat(o/p,", \n      height=").concat(s/p,", \n      top=").concat(f,", \n      left=").concat(h,"\n    "));return null===j||void 0===j||null===(t=j.focus)||void 0===t||t.call(j),j}},59:function(e,t,n){"use strict";n.d(t,"f",(function(){return d})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return y})),n.d(t,"b",(function(){return g})),n.d(t,"g",(function(){return k}));var r=n(12),a=n.n(r),i=n(23),o=n(52),c=n(10),s=n(7),u=n(257),l=n(504);function d(e){var t={};return Object.values(e.cubesMap).forEach((function(e){Object.values(e).forEach((function(e){Object.values(e).forEach((function(e){var n=e.name,r=e.type;t[n]=r}))}))})),t}function b(e){return"".concat(e[0].toLowerCase()).concat(e.slice(1))}function p(e){return Array.from(new Set(e))}var h={"angular-cli":{files:{"src/polyfills.ts":{content:"import 'core-js/proposals/reflect-metadata';\nimport 'zone.js/dist/zone';"},"src/main.ts":{content:"import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));"},"src/index.html":{content:'<!DOCTYPE html>\n        <html lang="en">\n          <head>\n            <meta charset="utf-8" />\n            <title>AngularCharts</title>\n            <base href="/" />\n            <meta name="viewport" content="width=device-width, initial-scale=1" />\n            <link rel="icon" type="image/x-icon" href="favicon.ico" />\n          </head>\n          <body>\n            <app-root></app-root>\n          </body>\n        </html>\n        '},".angular-cli.json":{content:'{\n          "apps": [\n            {\n              "root": "src",\n              "outDir": "dist",\n              "index": "index.html",\n              "main": "main.ts",\n              "polyfills": "polyfills.ts",\n              "styles": [],\n              "scripts": []\n            }\n          ]\n        }'}},dependencies:{"zone.js":"latest","@angular/platform-browser-dynamic":"latest","@angular/platform-browser":"latest","@angular/compiler":"latest",rxjs:"latest","@angular/common":"latest"}},"create-react-app":{dependencies:{"react-dom":"latest"}}},f={"react-chartjs-2":"chart.js"},j={react:"17.0.1","react-dom":"17.0.1","react-chartjs-2":"3.0.3","chart.js":"3.4.0"};function m(e,t){var n,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{files:Object(s.a)(Object(s.a)(Object(s.a)({},null===(n=h[e])||void 0===n?void 0:n.files),Object.entries(t).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(o.a)({},n,{content:r})})).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),t)}),{})),{},{"package.json":{content:{dependencies:Object(s.a)(Object(s.a)({},null===(r=h[e])||void 0===r?void 0:r.dependencies),a.reduce((function(e,t){var n=Array.isArray(t)?t:[t,j[t]||"latest"],r=Object(c.a)(n,2),a=r[0],i=r[1];return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},a,i),f[a]?Object(o.a)({},f[a],"latest"):null)}),{}))}}}),template:e}}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e){var r=new CustomEvent("__cubejsPlaygroundEvent",{bubbles:!0,composed:!0,detail:Object(s.a)(Object(s.a)({},n),{},{eventType:t})});e.dispatchEvent(r)}}function O(e,t,n,r){var o=0,c=!1;function s(){c=!0}function u(){return l.apply(this,arguments)}function l(){return(l=Object(i.a)(a.a.mark((function i(){var l;return a.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch(e,r);case 2:l=a.sent,c||(n({response:l,cancel:s,retries:o}),setTimeout(u,t)),o++;case 5:case"end":return a.stop()}}),i)})))).apply(this,arguments)}return u(),{cancel:s,retries:o}}function y(e,t,n){return Promise.race([fetch(e,t),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),n)}))])}function g(e){return x.apply(this,arguments)}function x(){return x=Object(i.a)(a.a.mark((function e(t){var n,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"Copied to clipboard",navigator.clipboard||u.a.error({message:"Your browser doesn't support copy to clipboard"}),e.prev=2,e.next=5,navigator.clipboard.writeText(t);case 5:u.a.success({message:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),u.a.error({message:"Can't copy to clipboard",description:e.t0});case 11:case"end":return e.stop()}}),e,null,[[2,8]])}))),x.apply(this,arguments)}function k(e){return Object(l.pretty)(e,2).replaceAll(/([^\\]|)'/g,"\\'").replaceAll(/"/g,"'").replaceAll(/\[[\s]+\]/g,"[]")}},852:function(e,t,n){"use strict";n.r(t);var r,a,i,o,c,s,u,l=n(12),d=n.n(l),b=n(7),p=n(23),h=n(44),f=n(42),j=n.n(f),m=n(65),v=n(97),O=n(85),y=n(86),g=n(115),x=n(114),k=n(15),w=n(0),C=n.n(w),S=(n(262),n(866)),A=n(884),E=n(14),D=n(890),T=n(867),P=n(891),q=n(892),R=n(324),M=n(186),I=n(390),L=n(87),_=n(1),z=function(){return Object(_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32",fill:"currentColor",children:Object(_.jsx)("path",{d:"M16.135 0c8.75 0 15.865 7.313 15.865 15.995s-7.104 15.99-15.865 15.99l-16.135 0.016v-16.281c0-8.677 7.375-15.719 16.135-15.719zM16.292 6.083c-3.458-0.005-6.661 1.802-8.448 4.76-1.776 2.943-1.849 6.609-0.198 9.625l-1.781 5.677 6.396-1.432c3.656 1.635 7.953 0.901 10.844-1.854 2.896-2.734 3.818-6.969 2.318-10.661-1.51-3.703-5.12-6.12-9.12-6.115z"})})},B=Object(E.d)(M.a)(r||(r=Object(k.a)(["\n  && {\n    background: transparent;\n    border-bottom: 0;\n  }\n"]))),F=Object(E.d)(M.a.Item)(a||(a=Object(k.a)(["\n  &&& {\n    font-size: 15px;\n    font-weight: 500;\n    line-height: 48px;\n    height: 49px;\n    & > a {\n      &,\n      &:hover {\n        opacity: 0.6;\n        color: white;\n      }\n    }\n    &.ant-menu-item-selected,\n    &.ant-menu-item-active {\n      color: white;\n      border-bottom: 2px solid white;\n\n      &:hover {\n        border-bottom: 2px solid white;\n      }\n\n      a {\n        opacity: 1;\n        color: white;\n      }\n    }\n\n    &:not(.ant-menu-item-selected) {\n      &.ant-menu-item-active,\n      &:hover {\n        color: white;\n        border-bottom: 2px solid white;\n      }\n    }\n  }\n"]))),Q=E.d.a(i||(i=Object(k.a)(["\n  &&& {\n    float: right;\n    height: 32px;\n    margin: 8px ",";\n    border: 1px solid rgba(255, 255, 255, 0.35);\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n    color: white;\n    transition: all 0.25s ease;\n    padding: 0 10px;\n\n    span {\n      font-size: 14px;\n      margin-right: 10px;\n    }\n\n    &:hover {\n      border-color: white;\n      color: white;\n    }\n  }\n"])),(function(e){return e.noMargin?"0":"8px"})),N=n(10),U=n(889),K=n(882),V=n(877),Y=n(73),J=E.d.div(o||(o=Object(k.a)(["\n  display: flex;\n  flex-direction: ",";\n  flex-wrap: ",";\n  justify-content: ",";\n  align-items: ",";\n\n  ",";\n\n  margin: ",";\n"])),(function(e){return e.direction||"row"}),(function(e){return e.wrap?"wrap":null}),(function(e){return e.justifyContent}),(function(e){return e.alignItems}),(function(e){var t=e.gap,n=e.direction;if(t)return"column"===n?Object(E.c)(c||(c=Object(k.a)(["\n        & > div {\n          margin-bottom: ","px};\n        }\n\n        & > div:last-child {\n          margin-bottom: 0;\n        }\n      "])),8*t):Object(E.c)(s||(s=Object(k.a)(["\n      & > div {\n        margin-right: ","px};\n      }\n\n      & > div:last-child {\n        margin-right: 0;\n      }\n    "])),8*t);return""}),(function e(t){var n=t.margin;if("string"===typeof n)return n;if("number"===typeof n)return"".concat(8*n,"px");if(Array.isArray(n)){var r=n.length;if(2===r){var a=Object(N.a)(n,2),i=a[0],o=a[1];return"".concat(8*i,"px ").concat(8*o,"px")}if(r>2)return n.fill(0,0,4).map((function(e){return"".concat(8*e)})).join(" ")}if(n&&Object.keys(n||{}).length)return Object.entries(n).map((function(t){var n=Object(N.a)(t,2),r=n[0],a=n[1];return"top"===r?"".concat(e({margin:a})," 0 0 0"):"bottom"===r?"0 0 ".concat(e({margin:a})," 0"):void 0}));return null}));var G,W=E.d.div(u||(u=Object(k.a)(["\n  align-self: ",";\n  flex-grow: ",";\n"])),(function(e){return e.align}),(function(e){return e.grow})),H=n(32),Z=n(59),$=n(529),X=n(876),ee=n(881),te=["label","value","onCopyClick"],ne=Object(E.d)(Y.a)(G||(G=Object(k.a)(["\n  border: none;\n  color: var(--primary-1);\n"])));function re(e){var t=e.label,n=e.value,r=e.onCopyClick,a=Object(h.a)(e,te),i=Object(_.jsx)(ne,{"data-testid":"localhost-tipbox-".concat(null===t||void 0===t?void 0:t.toLowerCase(),"-copy-btn"),icon:Object(_.jsx)($.a,{}),onClick:function(){return n&&r(n.toString())}});return Object(_.jsx)(X.a.Item,{label:t?Object(_.jsx)("b",{children:t}):null,labelCol:{span:24},wrapperCol:{span:24},children:Object(_.jsx)(ee.a,Object(b.a)({"data-testid":"localhost-tipbox-".concat(null===t||void 0===t?void 0:t.toLowerCase(),"-input"),value:n,suffix:i},a))})}var ae=n(883),ie=n(91),oe=n(220);function ce(e){var t=e.status,n=e.uploading,r={loading:Object(_.jsx)(ie.a,{spin:!0}),inProgress:Object(_.jsx)(ie.a,{spin:!0}),running:Object(_.jsx)(oe.a,{})};return n?r.loading:r[t]||r.loading}var se;function ue(){var e,t=Object(H.e)(),n=Object(w.useState)(!1),r=Object(N.a)(n,2),a=r[0],i=r[1];if(!t||(null===t||void 0===t?void 0:t.livePreviewDisabled))return null;var o=t.statusLivePreview,c=o.active,s=o.status,u=o.uploading,l=Object(_.jsxs)(Q,{"data-testid":"live-preview-btn",onClick:function(){c||t.startLivePreview()},children:[c?Object(_.jsx)(ce,{status:s,uploading:u}):Object(_.jsx)(U.a,{}),c?"Running":"Run"," on Cube Cloud"]});return c?Object(_.jsx)(R.a,{overlay:Object(_.jsx)(le,{livePreviewStatus:t.statusLivePreview,apiUrl:(null===(e=t.credentials)||void 0===e?void 0:e.apiUrl)||"",loading:a,onStopClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,t.stopLivePreview();case 3:i(!1);case 4:case"end":return e.stop()}}),e)})))}),trigger:["click"],children:l}):l}function le(e){var t=e.livePreviewStatus,n=e.apiUrl,r=e.loading,a=e.onStopClick,i=t.url,o=t.deploymentId;return Object(_.jsx)(K.a,{style:{maxWidth:600},children:Object(_.jsxs)(J,{direction:"column",gap:2,children:[Object(_.jsxs)(V.a.Paragraph,{children:["Playground uses the following API URL to execute queries on Cloud. You can use this API to test queries in your application."," ",Object(_.jsx)(V.a.Link,{href:"https://cube.dev/docs/cloud",target:"_blank",children:"Learn more"})," ","on developing and testing with Cube Cloud."]}),Object(_.jsx)(re,{value:n,onCopyClick:Z.b}),Object(_.jsx)(W,{children:Object(_.jsxs)(J,{justifyContent:"space-between",children:[Object(_.jsx)(Y.a,{type:"primary",target:"_blank",href:"".concat(i,"/deployments/").concat(o,"/history"),children:"Inspect queries"}),Object(_.jsx)(Y.a,{type:"primary",danger:!0,loading:r,onClick:a,children:"Stop"})]})})]})})}var de=Object(E.d)(S.a.Header)(se||(se=Object(k.a)(["\n  && {\n    background-color: var(--dark-02-color);\n    color: white;\n    padding: 0 16px;\n    line-height: 44px;\n    height: 48px;\n  }\n"])));function be(e){var t=e.selectedKeys,n=Object(I.useMediaQuery)({query:"(min-device-width: 992px)"}),r=Object(I.useMediaQuery)({query:"(max-device-width: 991px)"});return Object(_.jsxs)(de,{children:[Object(_.jsx)("div",{style:{float:"left"},children:Object(_.jsx)("img",{src:"./cubejs-playground-logo.svg",style:{height:28,marginRight:28},alt:""})}),n&&Object(_.jsxs)(B,{theme:"light",mode:"horizontal",selectedKeys:t,children:[Object(_.jsx)(F,{children:Object(_.jsx)(L.a,{to:"/build",children:"Build"})},"/build"),Object(_.jsx)(F,{children:Object(_.jsx)(L.a,{to:"/dashboard",children:"Dashboard App"})},"/dashboard"),Object(_.jsx)(F,{children:Object(_.jsx)(L.a,{to:"/schema",children:"Schema"})},"/schema"),Object(_.jsxs)(Q,{href:"https://slack.cube.dev",target:"_blank",children:[Object(_.jsx)(D.a,{}),"Slack"]},"slack"),Object(_.jsxs)(Q,{noMargin:!0,href:"https://forum.cube.dev/",target:"_blank",children:[Object(_.jsx)(T.a,{component:function(){return Object(_.jsx)(z,{})}}),"Discourse"]},"discourse"),Object(_.jsxs)(Q,{href:"https://cube.dev/docs",target:"_blank",children:[Object(_.jsx)(P.a,{}),"Docs"]},"docs"),Object(_.jsx)(ue,{})]}),r&&Object(_.jsx)("div",{style:{float:"right"},children:Object(_.jsx)(R.a,{overlay:Object(_.jsxs)(M.a,{children:[Object(_.jsx)(M.a.Item,{children:Object(_.jsx)(L.a,{to:"/build",children:"Build"})},"/build"),Object(_.jsx)(M.a.Item,{children:Object(_.jsx)(L.a,{to:"/dashboard",children:"Dashboard App"})},"/dashboard"),Object(_.jsx)(M.a.Item,{children:Object(_.jsx)(L.a,{to:"/schema",children:"Schema"})},"/schema")]}),children:Object(_.jsx)(q.a,{})})})]})}var pe={pink:"255, 100, 146",purple:"122, 119, 255","purple-03":"175, 173, 255","purple-04":"202, 201, 255",text:"91, 92, 125","dark-01":"20, 20, 70","dark-02":"67, 67, 107","dark-03":"114, 114, 144","dark-04":"161, 161, 181","dark-05":"213, 213, 226",light:"243, 243, 251",green:"65, 181, 111",yellow:"251, 188, 5",gray:"246, 246, 248"};function he(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"rgba(".concat(pe[e],", ").concat(t,")")}var fe={"active-bg":he("purple",.1),"primary-bg":he("purple",.1),"primary-1":he("purple",.9),"primary-2":he("purple",.8),"primary-3":he("purple",.7),"primary-4":he("purple",.6),"primary-5":he("purple",.5),"primary-6":he("purple",.4),"primary-7":he("purple",.3),"primary-8":he("purple",.2),"primary-9":he("purple",.1),"primary-10":he("purple",0),"light-5":he("light",.5),"remove-btn-bg":he("purple",.1),"remove-btn-hover-bg":he("purple",.2),"primary-color":he("purple"),"success-bg-color":he("green",.1),"success-color":he("green",.9),"warning-bg-color":he("yellow",.1),"warning-color":he("yellow",.9),"pink-8":he("pink",.2),"pink-9":he("pink",.1),"heading-color":he("dark",.65),"link-color":he("purple"),"info-color":he("purple"),"layout-body-background":"#f6f6f8;","layout-header-background":"#eeeef5","menu-highlight-color":he("dark-01"),"item-hover-bg":he("light"),"layout-header-height":"48px","font-family":'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", "Avenir Next", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif',"menu-item-font-size":"15px","btn-primary-shadow":"none","btn-text-shadow":"none","modal-body-padding":"32px","form-item-margin-bottom":"23px","disabled-color":he("dark-01",.25),"disabled-bg":he("dark-05",.2),"menu-item-active-bg":he("light"),"font-size-base":"14px","border-radius-base":"4px","padding-lg":"16px"};Object.keys(pe).forEach((function(e){fe["".concat(e,"-color")]=he(e),fe["".concat(e,"-color-rgb")]=pe[e]}));var je,me={},ve={};Object.keys(fe).forEach((function(e){me["@".concat(e)]=fe[e]})),Object.keys(fe).forEach((function(e){ve["--".concat(e)]=fe[e]}));var Oe,ye,ge=Object(E.b)(je||(je=Object(k.a)(["\n  body {\n    ",'\n  }\n\n  body {\n    margin: 0;\n    padding: 0;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    background: var(--layout-body-background);\n    overflow-x: hidden;\n  }\n\n  .inline-code {\n    margin: 0 1px;\n    padding: 0.2em 0.4em;\n    font-size: 0.9em;\n    background: #f2f4f5;\n    border: 1px solid #eee;\n    border-radius: 3px;\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar-track {\n    background: var(--light-color);\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar-thumb {\n    border-radius: 4px;\n    background: var(--dark-03-color);\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  } \n  \n  .schema-sidebar .ant-tabs-top-bar {\n    padding: 0 16px;\n  }\n  \n  .schema-sidebar .ant-menu {\n    border: 0;\n  }\n  \n  .ant-layout {\n    height: 100%;\n    background: var(--layout-body-background);\n  }\n  \n  .ant-layout-header .ant-menu {\n    height: 100%;\n  }\n  \n  .ant-menu-horizontal .ant-menu-item {\n    top: 0;\n    height: 100%;\n  }\n  \n  .ant-select-item.ant-select-item-option-selected:not(.ant-select-item-option-disabled) {\n    color: white;\n  }\n  \n  .ant-popover .ant-popover-inner-content {\n    padding: 0;\n  }\n  \n  \n  code[class*="language-"],\n  pre[class*="language-"] {\n    color: var(--dark-01-color);\n    background: none;\n    /*text-shadow: 0 1px white;*/\n    font-family: "Roboto Mono", Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;\n    text-align: left;\n    font-weight: normal;\n    font-size: 14px;\n    line-height: 20px;\n    white-space: pre;\n    word-spacing: normal;\n    word-break: normal;\n    word-wrap: normal;\n    border-radius: 4px;\n    border: none;\n  \n    -moz-tab-size: 4;\n    -o-tab-size: 4;\n    tab-size: 4;\n  \n    -webkit-hyphens: none;\n    -moz-hyphens: none;\n    -ms-hyphens: none;\n    hyphens: none;\n  }\n\n  code {\n    font-family: source-code-pro, Menlo, Monaco, Consolas, "Courier New",\n    monospace;\n  }\n\n  .schema-sidebar,\n  .schema-sidebar .ant-tabs,\n  .schema-sidebar .ant-tabs-content {\n    height: 100%;\n  }\n\n  .schema-sidebar {\n    background: #fff;\n    border-right: 1px solid #eee;\n    padding: 0;\n  }\n\n  .schema-sidebar .ant-tabs-tabpane {\n    /* TODO: replace with flexbox */\n    height: 85%;\n    overflow: auto;\n  }\n\n  .ant-popover-disabled-compatible-wrapper {\n    pointer-events: none;\n  }\n  \n  pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,\n  code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {\n    text-shadow: none;\n    /*background: #b3d4fc;*/\n  }\n  \n  pre[class*="language-"]::selection, pre[class*="language-"] ::selection,\n  code[class*="language-"]::selection, code[class*="language-"] ::selection {\n    text-shadow: none;\n    /*background: #b3d4fc;*/\n  }\n  \n  @media print {\n    code[class*="language-"],\n    pre[class*="language-"] {\n      text-shadow: none;\n    }\n  }\n  \n  /* Code blocks */\n  pre[class*="language-"] {\n    padding: 1em;\n    overflow: auto;\n  }\n  \n  :not(pre) > code[class*="language-"],\n  pre[class*="language-"] {\n    background: transparent;\n  }\n  \n  /* Inline code */\n  :not(pre) > code[class*="language-"] {\n    padding: .1em;\n    border-radius: .3em;\n    white-space: normal;\n  }\n  \n  .token.comment,\n  .token.prolog,\n  .token.doctype,\n  .token.cdata {\n    color: var(--dark-04-color);\n  }\n  \n  .token.punctuation {\n    color: var(--dark-04-color);\n  }\n  \n  .namespace {\n    opacity: .7;\n  }\n  \n  .token.property,\n  .token.tag,\n  .token.boolean,\n  .token.number,\n  .token.constant,\n  .token.symbol,\n  .token.deleted {\n    color: var(--pink-color);\n  }\n  \n  .token.selector,\n  .token.attr-name,\n  .token.string,\n  .token.char,\n  .token.builtin,\n  .token.inserted {\n    color: var(--purple-color);\n  }\n  \n  .token.operator,\n  .token.entity,\n  .token.url,\n  .language-css .token.string,\n  .style .token.string {\n    color: var(--dark-01-color);\n  }\n  \n  .token.atrule,\n  .token.attr-value,\n  .token.keyword {\n    color: var(--dark-01-color);\n  }\n  \n  .token.atrule,\n  .token.keyword {\n    font-weight: 500;\n  }\n  \n  .token.function,\n  .token.class-name {\n    color: var(--pink-color);\n  }\n  \n  .token.regex,\n  .token.important,\n  .token.variable {\n    color: var(--pink-color);\n  }\n  \n  .token.important,\n  .token.bold {\n    font-weight: bold;\n  }\n  \n  .token.italic {\n    font-style: italic;\n  }\n  \n  .token.entity {\n    cursor: help;\n  }\n  \n  .missing-member-tooltip {\n    max-width: none;\n  }\n  \n  .ant-btn-link > span {\n    text-decoration: underline;\n  }\n  \n  a.ant-typography {\n    text-decoration: underline;\n  }\n  \n  .ant-notification {\n    z-index: 9999;\n  }\n  \n  .ant-modal-header {\n    padding: 16px 24px;\n  }\n  \n  .ant-modal-body {\n    padding: 24px;\n  }\n\n  // Fix close tab button styles\n  .ant-tabs-dropdown {\n    & .ant-tabs-dropdown-menu-item {\n      display: flex;\n      place-content: center space-between;\n    }\n    \n    & button.ant-tabs-dropdown-menu-item-remove {\n      -webkit-appearance: none;\n      padding: 0;\n      border: none;\n      border-radius: var(--border-radius-base);\n      background: transparent;\n      color: var(--dark-color);\n      cursor: pointer;\n      transition: color .125s linear;\n    }\n    \n    & button.ant-tabs-dropdown-menu-item-remove:hover {\n      color: var(--purple-color);\n    }\n  }\n'])),Object.entries(ve).map((function(e){var t=Object(N.a)(e,2),n=t[0],r=t[1];return"".concat(n,": ").concat(r,";")})).join("\n    ")),xe={error:{border:"#FFCCC7",background:"rgb(255, 100, 109, 0.05)",color:"#EF404A"},warning:{border:"#FFE58F",background:"#FFFBE6"},info:{border:"#91D5FF",background:"#E6F7FF"},success:{border:"#B7EB8F",background:"#F6FFED"}},ke=Object(E.d)(A.a)(Oe||(Oe=Object(k.a)(["\n  && {\n    background: ",";\n    border: 1px solid ",";\n    color: ",";\n    box-sizing: border-box;\n    border-radius: 2px;\n  }\n"])),(function(e){return xe[e.type||"info"].background}),(function(e){return xe[e.type||"info"].border}),(function(e){var t;return e.type&&(null===(t=xe[e.type])||void 0===t?void 0:t.color)||"inherit"})),we=[[49,.5],[0,25],[49,49],[98,25]];function Ce(e){return"transform: translate(".concat(we[e][0],"%, ").concat(we[e][1],"%);")}var Se,Ae=E.d.img((function(e){var t=e.index;return"\n  display: block;\n  position: absolute;\n  width: 50%;\n  height: 50%;\n  \n  ".concat(null!=t?"\n  animation-name: dice".concat(t,";\n  animation-duration: 2s;\n  animation-iteration-count: infinite;\n  animation-timing-function: ease;\n  z-index: 0;\n  \n  @keyframes dice").concat(t," {\n    ").concat(0===t?"\n    from {\n      ".concat(Ce(0),"\n      z-index: 0;\n    }\n    \n    25% {\n      ").concat(Ce(0),"\n      z-index: 0;\n    }\n    \n    50% {\n      ").concat(Ce(1),"\n      z-index: 0;\n    }\n    \n    51% {\n      z-index: 1;\n    }\n    \n    75% {\n      z-index: 1;\n    }\n\n    to {\n      ").concat(Ce(1),"\n      z-index: 1;\n    }\n    "):"","\n    \n    ").concat(1===t?"\n    from {\n      ".concat(Ce(1),"\n      z-index: 3;\n    }\n    \n    25% {\n      ").concat(Ce(2),"\n      z-index: 3;\n    }\n    \n    75% {\n      ").concat(Ce(2),"\n      z-index: 2;\n    }\n    \n    to {\n      ").concat(Ce(3),"\n      z-index: 1;\n    }\n    "):"","\n    \n    ").concat(2===t?"\n    from {\n      ".concat(Ce(3),"\n      z-index: 1;\n    }\n    \n    50% {\n      ").concat(Ce(3),"\n      z-index: 0;\n    }\n    \n    75% {\n      ").concat(Ce(0),"\n      z-index: 0;\n    }\n\n    to {\n      ").concat(Ce(0),"\n      z-index: 0;\n    }\n    "):"","\n  }\n  "):"","\n")})),Ee=function(e){return Object(_.jsx)(Ae,Object(b.a)({role:"presentation",src:"data:image/svg+xml,%3Csvg width='36' height='41' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M35.899 10.351l-18 10.25L.1 10.25l18-10.25L35.9 10.351z' fill='%23FAFAFF'/%3E%3Cpath d='M18 41L0 30.75l.101-20.5L18 20.5' fill='%23E5E5F6'/%3E%3Cpath d='M36 30.75L18 41V20.6l17.899-10.25L36 30.75z' fill='%23C0C0EA'/%3E%3C/svg%3E",alt:""},e))},De=E.d.div(ye||(ye=Object(k.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n"])));function Te(e){var t=e.size,n=void 0===t?80:t,r=e.full,a=void 0===r||r,i=Object(_.jsxs)("div",{"data-testid":"cube-loader",role:"img","aria-label":"Loading animation",style:{position:"relative",width:n,height:1.1388888889*n,margin:"0 auto"},children:[Object(_.jsx)(Ee,{style:{transform:"translate(0%, 72.5%)"}}),Object(_.jsx)(Ee,{style:{transform:"translate(98%, 72.5%)"}}),Object(_.jsx)(Ee,{style:{transform:"translate(49%, 96.5%)"}}),Object(_.jsx)(Ee,{index:0}),Object(_.jsx)(Ee,{index:1}),Object(_.jsx)(Ee,{index:2})]},"loader");return a?Object(_.jsx)(De,{children:i}):i}var Pe,qe,Re=V.a.Text,Me=V.a.Paragraph,Ie=E.d.pre(Se||(Se=Object(k.a)(["\n  padding: 0.4em 0.8em;\n  font-size: 13px;\n  white-space: pre-wrap;\n  margin: 0;\n"])));function Le(e){var t=e.error,n=e.stack,r=Object(w.useState)(!1),a=Object(N.a)(r,2),i=a[0],o=a[1];return Object(_.jsxs)(ae.b,{direction:"vertical",children:[Object(_.jsx)(Re,{strong:!0,style:{fontSize:18},children:"Error \ud83d\ude22"}),Object(_.jsxs)(Me,{children:["Ask about it in"," ",Object(_.jsx)("a",{href:"https://slack.cube.dev",target:"_blank",rel:"noopener noreferrer",children:"Slack"}),". These guys know how to fix this for sure!"]}),Object(_.jsx)(ke,{type:"error",message:Object(_.jsxs)(ae.b,{direction:"vertical",children:[Object(_.jsx)(Ie,{dangerouslySetInnerHTML:{__html:t.toString().replace(/(Error:\s)/g,"")}}),n?Object(_.jsxs)(_.Fragment,{children:[i?null:Object(_.jsx)(Y.a,{danger:!0,ghost:!0,onClick:function(){return o(!0)},children:"Show stack trace"}),i&&Object(_.jsx)("pre",{children:n})]}):null]})})]})}var _e,ze=Object(E.d)(Y.a)(Pe||(Pe=Object(k.a)(["\n  &&:not(.ant-btn-link) {\n    padding: 5px 12px;\n    height: auto;\n    border-color: var(--dark-05-color);\n    color: var(--text-color);\n    box-shadow: none;\n\n    &:hover,\n    &:active,\n    &:focus {\n      border-color: var(--purple-04-color);\n      color: var(--primary-color);\n    }\n\n    &:disabled {\n      color: var(--disabled-color);\n      border-color: var(--disabled-color);\n      background-color: white;\n\n      &:hover,\n      &:active,\n      &:focus {\n        color: var(--disabled-color);\n        border-color: var(--disabled-color);\n      }\n    }\n\n    &.ant-btn-primary:not([disabled]) {\n      background: var(--primary-color);\n      color: white;\n      border-color: var(--primary-color);\n      place-self: center;\n    }\n\n    &.ant-btn-background-ghost:not([disabled]) {\n      color: var(--primary-color);\n    }\n\n    &.ant-btn-icon-only {\n      display: inline-flex;\n      place-items: center;\n      padding: 5px 8px;\n      font-size: 14px;\n\n      svg {\n        width: 15px;\n        height: 14px;\n      }\n    }\n\n    .anticon {\n      display: inline-block;\n      height: 14px;\n    }\n\n    &.ant-btn-sm {\n      padding: 0 8px;\n      height: 24px !important;\n    }\n  }\n"])));ze.Group=Object(E.d)(Y.a.Group)(qe||(qe=Object(k.a)(["\n  &&& .ant-btn-primary:not([disabled]) {\n    background-color: var(--primary-bg);\n    color: var(--primary-color);\n    border: 1px solid var(--primary-color);\n\n    &:not(:first-child):not(:last-child) {\n      border-left-color: var(--primary-color);\n      border-right-color: var(--primary-color);\n    }\n\n    &:first-child {\n      border-right-color: var(--primary-color);\n    }\n\n    &:last-child {\n      border-left-color: var(--primary-color);\n    }\n  }\n\n  &&\n    .ant-btn-primary:not([disabled])\n    + .ant-btn:not(.ant-btn-primary):not([disabled]) {\n    border-left-color: var(--primary-color);\n\n    &:hover,\n    &:active,\n    &:focus {\n      border-left-color: var(--primary-color);\n    }\n  }\n\n  &&& .ant-btn:disabled {\n    background-color: var(--disabled-bg);\n  }\n"])));var Be,Fe,Qe,Ne=Object(E.d)(K.a)(_e||(_e=Object(k.a)(["\n  && {\n    border-radius: 8px;\n    border: none;\n\n    .ant-card-head {\n      border-bottom: 1px solid #d7d7f488;\n      padding: 8px 16px;\n    }\n\n    .ant-card-head-title {\n      padding: 0;\n      flex: initial;\n    }\n\n    .ant-card-extra {\n      padding: 0;\n    }\n\n    .ant-card-head-wrapper {\n      flex-flow: row wrap;\n      place-content: space-between;\n    }\n\n    .ant-card-head-title {\n      font-size: 18px;\n      line-height: 40px;\n    }\n\n    .ant-card-body {\n      padding: 16px;\n    }\n  }\n"]))),Ue=n(885),Ke=Object(E.d)(Ue.a)(Be||(Be=Object(k.a)(["\n  && {\n    .ant-popover-inner-content {\n      padding: 0;\n    }\n  }\n"]))),Ve=n(395),Ye=n.n(Ve),Je=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"componentDidMount",value:function(){Ye.a.highlightAll()}},{key:"componentDidUpdate",value:function(){Ye.a.highlightAll()}},{key:"render",value:function(){return Object(_.jsx)("pre",{style:this.props.style,children:Object(_.jsx)("code",{"data-testid":"prism-code",className:"language-".concat(this.props.language||"javascript"),children:this.props.code})})}}]),n}(w.Component),Ge=E.d.div(Fe||(Fe=Object(k.a)(["\n  display: flex;\n  border-radius: 4px;\n  background: ",";\n  width: 100%;\n  max-width: 100%;\n"])),(function(e){return e.theme.background})),We=E.d.div(Qe||(Qe=Object(k.a)(["\n  position: relative;\n\n  button,\n  button:hover,\n  button:focus {\n    border: none;\n    background: none;\n    box-shadow: none;\n    outline: none;\n    color: var(--primary-color);\n  }\n\n  [ant-click-animating-without-extra-node]:after {\n    animation: none !important;\n  }\n\n  ::after {\n    display: block;\n    content: '';\n    width: 16px;\n    position: absolute;\n    left: -16px;\n    top: 0;\n    bottom: 0;\n    background: linear-gradient(\n      to right,\n      ",",\n      ","\n    );\n  }\n"])),(function(e){return"".concat(e.theme.background,"00")}),(function(e){return e.theme.background}));function He(e){var t=e.code,n=e.language,r=e.style,a=e.copyMessage,i=e.theme,o=void 0===i?"dark":i;return Object(_.jsx)(E.a,{theme:{background:"dark"===o?"#F6F6F8":"#FFFFFF"},children:Object(_.jsxs)(Ge,{style:r,children:[Object(_.jsx)(Je,{code:t,language:n,style:{flexGrow:1}}),Object(_.jsx)(We,{children:Object(_.jsx)(Y.a,{icon:Object(_.jsx)($.a,{}),onClick:function(){return Object(Z.b)(t,a||"Copied")}})})]})})}var Ze,$e,Xe=n(396),et=n.n(Xe),tt=n(859),nt=null,rt=[],at={sentFrom:"frontend"},it=null,ot=function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===Ze){e.next=2;break}return e.abrupt("return");case 2:return(n=localStorage.getItem("playground_anonymous"))||(n=et.a.get("playground_anonymous")||Object(tt.a)().toString(),localStorage.setItem("playground_anonymous",n),et.a.remove("playground_anonymous")),rt.push(Object(b.a)(Object(b.a)(Object(b.a)({},at),t),{},{id:Object(tt.a)(),clientAnonymousId:n,clientTimestamp:(new Date).toJSON()})),r=function(){var e=Object(p.a)(d.a.mark((function e(t){var n,a,i=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:10,t||(t=rt,rt=[]),t.length){e.next=4;break}return e.abrupt("return",null);case 4:return e.prev=4,a=(new Date).toJSON(),e.next=8,fetch("https://track.cube.dev/track",{method:"post",body:JSON.stringify(t.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{sentAt:a})}))),headers:{"Content-Type":"application/json"}});case 8:if(!(200!==e.sent.status&&n>0)){e.next=11;break}return e.abrupt("return",r(t,n-1));case 11:e.next=17;break;case 13:if(e.prev=13,e.t0=e.catch(4),!(n>0)){e.next=17;break}return e.abrupt("return",r(t,n-1));case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),a=(nt||Promise.resolve()).then((function(){return r()})).then((function(){a===nt&&(nt=null)})),nt=a,e.abrupt("return",nt);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ct=function(e,t){var n;at=Object(b.a)(Object(b.a)({},at),t),null===(n=it)||void 0===n||n(Object(b.a)({event:"identify",anonymousId:e},t),Ze)},st=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===(t=it)||void 0===t||t(Object(b.a)({event:e},n),Ze)},ut=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};st("Playground Action",Object(b.a)({name:e},t))},lt=n(158),dt=n(311),bt=Object(E.d)(S.a.Content)($e||($e=Object(k.a)(["\n  height: 100%;\n"]))),pt=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={fatalError:null,context:null,showLoader:!1,isAppContextSet:!1},e}return Object(y.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return setTimeout((function(){return r.setState({showLoader:!0})}),700),window.addEventListener("unhandledrejection",(function(e){var t=e.reason;console.log(t);var n=(t.stack||t).toString();st("Playground Error",{error:n})})),e.next=4,fetch("/playground/context");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,a=n.telemetry,Ze=a,it=ot,ct(n.anonymousId,{coreServerVersion:n.coreServerVersion,projectFingerprint:n.projectFingerprint,isDocker:Boolean(n.isDocker),dockerVersion:n.dockerVersion}),this.setState({context:n});case 12:case"end":return e.stop()}var a}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidCatch",value:function(e,t){st("Playground Error",{error:(e.stack||e).toString(),info:t.toString()})}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.location,a=n.children,i=this.state,o=i.context,c=i.fatalError,s=i.isAppContextSet,u=i.showLoader;return null==o||s?null!=o||s?(c&&console.log(c.stack),Object(_.jsx)(dt.b,{disabled:null==o.livePreview||!o.livePreview,children:Object(_.jsxs)(S.a,{children:[Object(_.jsx)(ge,{}),Object(_.jsx)(be,{selectedKeys:(e=r.pathname,"/template-gallery"===e?["/dashboard"]:[e])}),Object(_.jsx)(bt,{children:c?Object(_.jsx)(A.a,{message:"Error occured while rendering",description:c.stack||"",type:"error"}):a})]})})):u?Object(_.jsx)(Te,{}):null:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(ht,{context:o}),Object(_.jsx)(lt.b,{onReady:function(){return t.setState({isAppContextSet:!0})}})]})}}],[{key:"getDerivedStateFromError",value:function(e){return{fatalError:e}}}]),n}(w.Component);function ht(e){var t=e.context,n=Object(H.a)().setContext;return Object(w.useEffect)((function(){null!==t&&n({ready:!0,playgroundContext:Object(b.a)(Object(b.a)({},t),{},{isCloud:!1}),identifier:t.identifier})}),[t]),null}var ft,jt,mt,vt,Ot,yt,gt=Object(m.g)(pt),xt=n(507),kt=n(55),wt=function(e,t,n){return Object(kt.d)(e,Object(b.a)(Object(b.a)({},t),{},{retries:n}))},Ct=function(){function e(){Object(O.a)(this,e),this.loadError=null,this.dashboardCreated=!1,this.installedTemplates=void 0,this.playgroundContext=void 0}return Object(y.a)(e,[{key:"load",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r,a=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]&&a[0],e.next=3,wt("/playground/dashboard-app-create-status".concat(t?"?instant=true":""),void 0,10);case 3:return n=e.sent,e.next=6,n.json();case 6:(r=e.sent).error?this.loadError=r.error:(this.dashboardCreated="created"===r.status,this.installedTemplates=r.installedTemplates);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyTemplatePackages",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:null,this.playgroundContext){e.next=5;break}return e.next=4,this.loadContext();case 4:this.playgroundContext=e.sent;case 5:return e.abrupt("return",Object(kt.d)("/playground/apply-template-packages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({toApply:t,templateConfig:n||{credentials:this.playgroundContext}})}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadContext",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(kt.d)("/playground/context");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",{cubejsToken:n.cubejsToken,apiUrl:n.apiUrl||window.location.href.split("#")[0].replace(/\/$/,"")});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"templatePackages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"react";return"react"===e.toLowerCase()?[{name:"react-antd-dynamic",description:"React Antd Dynamic"},{name:"react-antd-static",description:"React Antd Static"},{name:"react-material-static",description:"React Material UI Static"}]:"angular"===e.toLowerCase()?[{name:"ng-material-dynamic",description:"Angular Material UI Dynamic"}]:"vue"===e.toLowerCase()?[{name:"vue-vuetify-dynamic",description:"Vue Vuetify UI Dynamic"}]:[]}},{key:"canAddChart",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!this.loadError){e.next=4;break}return e.abrupt("return",this.loadError);case 4:return e.abrupt("return",!!Object.keys(this.installedTemplates).find((function(e){return e.match(/-static$/)})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addChart",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!this.loadError){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.applyTemplatePackages(["create-react-app",Object.keys(this.installedTemplates).find((function(e){return e.match(/-static$/)})),"static-chart"],{chartCode:t});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"templates",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(kt.d)("/playground/manifest");case 2:return e.next=4,e.sent.json();case 4:return t=e.sent,n=t.templates,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),St=Ct,At=function(e){var t=e.children;return Object(_.jsx)("div",{style:{textAlign:"center",marginTop:50},children:t})},Et=function(){return Object(_.jsxs)("p",{style:{width:450,margin:"20px auto"},children:["Dashboard App is a convenient way to setup and deploy frontend app to work with Cube.js backend. You can learn more about in the"," ",Object(_.jsx)("a",{href:"https://cube.dev/docs/dashboard-app",target:"_blankl",children:"Cube.js docs"}),"."]})},Dt=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).dashboardSource=new St,r.state={},r}return Object(y.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDashboard();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadDashboard",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({appCode:null,loadError:null}),e.prev=1,e.next=4,this.dashboardSource.load();case 4:return this.setState({dashboardStarting:!1,appCode:!this.dashboardSource.loadError&&this.dashboardSource.dashboardCreated,loadError:this.dashboardSource.loadError}),e.next=7,Object(kt.d)("/playground/dashboard-app-status");case 7:return e.next=9,e.sent.json();case 9:t=e.sent,this.setState({dashboardRunning:t.running,dashboardPort:t.dashboardPort,dashboardAppPath:t.dashboardAppPath}),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(1),this.setState({dashboardStarting:!1,loadError:Object(_.jsx)("pre",{children:e.t0.toString()})}),e.t0;case 17:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"startDashboardApp",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({dashboardStarting:!0}),e.next=3,fetch("/playground/start-dashboard-app");case 3:return e.next=5,this.loadDashboard();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.appCode,r=t.dashboardPort,a=t.loadError,i=t.dashboardRunning,o=t.dashboardStarting,c=t.dashboardAppPath;if(a&&"string"===typeof a&&-1!==a.indexOf("Dashboard app not found"))return Object(_.jsx)(m.a,{to:"/template-gallery"});if(a)return Object(_.jsxs)(At,{children:[Object(_.jsx)("h2",{children:a}),Object(_.jsx)("p",{style:{marginTop:25},children:Object(_.jsx)(L.a,{to:"/template-gallery",children:Object(_.jsx)(Y.a,{type:"primary",children:"Create dashboard app in your project directory"})})}),Object(_.jsx)(Et,{})]});if(!n)return Object(_.jsxs)(At,{children:[Object(_.jsx)("h2",{children:"\xa0Creating Dashboard App"}),Object(_.jsx)("div",{children:Object(_.jsx)(xt.a,{tip:"It may take several minutes. Please check console for progress..."})}),Object(_.jsx)(Et,{})]});if(!i)return Object(_.jsxs)(At,{children:[Object(_.jsx)("h2",{children:"Dashboard App is not running"}),Object(_.jsxs)("h3",{children:["Please start dashboard app or run it manually using",Object(_.jsx)("code",{className:"inline-code",children:"$ npm run start"}),Object(_.jsx)("br",{}),"in\xa0",Object(_.jsx)("b",{children:c}),"\xa0directory."]}),Object(_.jsx)("p",{style:{marginTop:25},children:Object(_.jsx)(Y.a,{type:"primary",size:"large",loading:o,onClick:function(){return e.startDashboardApp()},children:o?"Dashboard app is starting. It may take a while. Please check console for progress...":"Start dashboard app"})}),Object(_.jsx)(Et,{})]});var s="http://".concat(window.location.hostname,":").concat(r);return Object(_.jsxs)("div",{style:{height:"100%",width:"100%",padding:"15px 30px 30px 30px",background:"#fff"},children:[Object(_.jsx)(A.a,{message:Object(_.jsxs)("span",{children:["This dashboard app can be edited at\xa0",Object(_.jsx)("b",{children:c}),". Dev server is running at\xa0",Object(_.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:s}),". Learn more how to customize and deploy it at\xa0",Object(_.jsx)("a",{href:"https://cube.dev/docs/dashboard-app",children:"Cube.js\xa0docs"}),".\xa0",Object(_.jsx)("a",{onClick:function(){return window.location.reload()},style:{cursor:"pointer"},children:"Refresh page"}),"\xa0if it is empty."]}),type:"info",closable:!0,style:{marginBottom:15}}),Object(_.jsx)("iframe",{src:s,style:{width:"100%",height:"100%",border:0,borderRadius:4,overflow:"hidden"},sandbox:"allow-modals allow-forms allow-popups allow-scripts allow-same-origin",title:"Dashboard"})]})}}]),n}(w.Component),Tt=Object(m.g)(Dt),Pt=n(879),qt=n(146),Rt=E.d.div(ft||(ft=Object(k.a)(["\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 18px;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: var(--dark-04-color);\n  margin-bottom: 8px;\n"]))),Mt=E.d.div(jt||(jt=Object(k.a)(["\n  display: flex;\n  flex-flow: row wrap;\n  margin-right: -8px;\n  margin-bottom: -8px;\n\n  && > * {\n    margin-right: 8px !important;\n    margin-bottom: 8px !important;\n  }\n"]))),It=n(252),Lt=Object(E.d)(It.a)(mt||(mt=Object(k.a)(["\n  &&& {\n    &.ant-select-disabled {\n      .ant-select-selector {\n        border-color: var(--disabled-color);\n        background-color: white;\n      }\n\n      .ant-select-selector {\n        color: var(--disabled-color);\n\n        &:hover,\n        &:active,\n        &:focus {\n          border-color: var(--disabled-color);\n          color: var(--disabled-color);\n        }\n      }\n    }\n\n    &.ant-select-single {\n      .ant-select-selector {\n        padding: 5px 12px;\n\n        .ant-select-selection-placeholder {\n          line-height: 22px;\n        }\n      }\n    }\n\n    &.ant-select-multiple {\n      .ant-select-selector {\n        padding: 3px 12px;\n      }\n\n      .ant-select-selection-item {\n        margin-top: 0;\n        margin-bottom: 0;\n      }\n    }\n\n    .ant-select-selection-item {\n      font-size: 14px;\n      line-height: 22px;\n    }\n\n    .ant-select-selector {\n      height: auto;\n      color: var(--text-color);\n      font-size: 14px;\n      line-height: 22px;\n\n      &:hover,\n      &:active,\n      &:focus {\n        border-color: var(--purple-04-color);\n        color: var(--primary-color);\n      }\n    }\n\n    .ant-select-selector::after {\n      font-size: 14px;\n      line-height: 22px;\n    }\n  }\n"]))),_t=(Object(E.d)(ee.a)(vt||(vt=Object(k.a)(["\n  && .ant-select-selector {\n    padding: 6px 12px;\n    height: auto;\n    border-color: 1px solid var(--dark-05-color);\n    color: var(--text-color);\n\n    &:hover,\n    &:active,\n    &:focus {\n      border-color: var(--purple-04-color);\n      color: var(--primary-color);\n    }\n  }\n"]))),Object(E.d)(M.a)(Ot||(Ot=Object(k.a)(["\n  && {\n    user-select: none;\n\n    &.ant-menu-inline .ant-menu-item:not(:last-child) {\n      margin-bottom: 0;\n    }\n  }\n"]))));_t.Item=Object(E.d)(M.a.Item)(yt||(yt=Object(k.a)(["\n  &&& {\n    border-radius: 4px;\n    margin-bottom: 0;\n    margin-top: 0;\n\n    &::after {\n      border-color: transparent;\n    }\n\n    &.ant-menu-item-selected {\n      color: var(--primary-color);\n\n      &::after {\n        border-color: transparent;\n      }\n    }\n  }\n"])));var zt,Bt,Ft,Qt=_t,Nt=n(399),Ut=Object(E.d)(Nt.a)(zt||(zt=Object(k.a)(["\n  && {\n    .ant-tabs-nav {\n      padding: 0 16px;\n      user-select: none;\n    }\n\n    .ant-tabs-content-holder {\n      padding: 0 16px;\n    }\n  }\n"]))),Kt=n(874),Vt=Object(E.d)(Kt.a)(Bt||(Bt=Object(k.a)(["\n  && {\n    user-select: none;\n\n    .ant-tree-node-content-wrapper.ant-tree-node-selected {\n      color: white;\n    }\n  }\n"])));Vt.TreeNode=Object(E.d)(Kt.a.TreeNode)(Ft||(Ft=Object(k.a)(["\n  && {\n  }\n"])));var Yt=Vt,Jt=S.a.Content,Gt=S.a.Sider,Wt=Yt.TreeNode,Ht=Ut.TabPane,Zt={},$t=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).state={expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[],activeTab:"schema",files:[],isDocker:null},r}return Object(y.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDBSchema();case 2:return e.next=4,this.loadFiles();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExpand",value:function(e){ut("Expand Tables"),this.setState({expandedKeys:e,autoExpandParent:!1})}},{key:"onCheck",value:function(e){ut("Check Tables"),this.setState({checkedKeys:e})}},{key:"onSelect",value:function(e){this.setState({selectedKeys:e})}},{key:"loadDBSchema",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({schemaLoading:!0}),e.prev=1,e.next=4,Object(kt.d)("/playground/db-schema");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,this.setState({tablesSchema:n.tablesSchema}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setState({schemaLoadingError:e.t0});case 14:return e.prev=14,this.setState({schemaLoading:!1}),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadFiles",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(kt.d)("/playground/files");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,this.setState({files:n.files});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateSchema",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r,a,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.checkedKeys,r=t.tablesSchema,a=this.props.history,ut("Generate Schema"),e.next=5,Object(kt.d)("/playground/generate-schema",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:n.filter((function(e){return!!Zt[e]})).map((function(e){return Zt[e]})),tablesSchema:r})});case 5:if(200!==(i=e.sent).status){e.next=14;break}return ut("Generate Schema Success"),e.next=10,this.loadFiles();case 10:this.setState({checkedKeys:[],activeTab:"files"}),Pt.a.success({title:"Schema files successfully generated!",content:"You can start building the charts",okText:"Build",cancelText:"Close",okCancel:!0,onOk:function(){a.push("/build")}}),e.next=20;break;case 14:return e.t0=ut,e.next=17,i.text();case 17:e.t1=e.sent,e.t2={error:e.t1},(0,e.t0)("Generate Schema Fail",e.t2);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"selectedFileContent",value:function(){var e=this.selectedFile();return e&&e.content}},{key:"selectedFile",value:function(){var e=this.state,t=e.files,n=e.selectedFile;return t.find((function(e){return e.fileName===n}))}},{key:"renderFilesMenu",value:function(){var e=this,t=this.state,n=t.selectedFile,r=t.files;return Object(_.jsx)(Qt,{mode:"inline",onClick:function(t){var n=t.key;ut("Select File"),e.setState({selectedFile:n})},selectedKeys:n?[n]:[],children:r.map((function(e){return Object(_.jsx)(Qt.Item,{children:e.fileName},e.fileName)}))})}},{key:"render",value:function(){var e=this,t=this.state,n=t.schemaLoading,r=t.schemaLoadingError,a=t.tablesSchema,i=t.selectedFile,o=t.expandedKeys,c=t.autoExpandParent,s=t.checkedKeys,u=t.selectedKeys,l=t.activeTab,d=t.isDocker,p=function e(t){return t.map((function(t){return t.treeData?Object(_.jsx)(Wt,{title:t.title,dataRef:t,children:e(t.treeData)},t.key):Object(_.jsx)(Wt,Object(b.a)({},t))}))};return Object(_.jsxs)(S.a,{style:{height:"100%"},children:[Object(_.jsx)(Gt,{width:340,className:"schema-sidebar",children:Object(_.jsxs)(Ut,{activeKey:l,onChange:function(t){return e.setState({activeTab:t})},tabBarExtraContent:Object(_.jsx)(Y.a,{disabled:!s.length,type:"primary",onClick:function(){return e.generateSchema()},children:"Generate Schema"}),children:[Object(_.jsx)(Ht,{tab:"Tables",children:n?Object(_.jsx)(Te,{}):r?Object(_.jsx)(ke,{"data-testid":"schema-error",message:"Error while loading DB schema",description:r.toString(),type:"error"}):function(){return Object.keys(a||{}).length>0?Object(_.jsx)(Yt,{checkable:!0,onExpand:e.onExpand.bind(e),expandedKeys:o,autoExpandParent:c,onCheck:e.onCheck.bind(e),checkedKeys:s,onSelect:e.onSelect.bind(e),selectedKeys:u,children:p((t=a||{},Object.keys(t).map((function(e){return{title:e,key:e,treeData:Object.keys(t[e]).map((function(t){var n="".concat(e,".").concat(t);return Zt[n]=[e,t],{title:t,key:n}}))}}))))}):Object(_.jsx)(ke,{message:"Empty DB Schema",description:"Please check connection settings",type:"warning"});var t}()},"schema"),Object(_.jsx)(Ht,{tab:"Files",children:this.renderFilesMenu()},"files")]})}),Object(_.jsxs)(Jt,{style:{minHeight:280,padding:24},children:[i&&Object(_.jsx)(ke,{message:d?Object(_.jsxs)("span",{children:["Schema files are located and can be edited in the mount volume directory."," ",Object(_.jsx)(V.a.Link,{href:"https://cube.dev/docs/schema/getting-started",target:"_blank",children:"Learn more about working with Cube.js data schema in the docs"})]}):Object(_.jsxs)("span",{children:["This file can be edited at\xa0",Object(_.jsx)("b",{children:this.selectedFile().absPath})]}),type:"info",style:{paddingTop:10,paddingBottom:11}}),i?Object(_.jsx)(Je,{code:this.selectedFileContent(),style:{padding:0,marginTop:24}}):Object(_.jsx)(qt.a,{style:{marginTop:50},description:"Select tables to generate Cube.js schema"}),Object(_.jsx)(lt.b,{onReady:function(t){var n=t.playgroundContext;return e.setState({isDocker:null===n||void 0===n?void 0:n.isDocker})}})]})]})}}]),n}(w.Component),Xt=n(52),en=n(126),tn=n(226),nn=n(527),rn=n(225),an=n(893),on=n(530),cn=n(894),sn=n(895),un=n(509),ln=(n(413),n(422),n(423),n(424),n(282),n(430),n(431),n(432),n(434),n(440),n(678),n(442),n(443),n(444),n(445),n(446),n(452),n(360),n(455),n(457),n(679),n(459),n(460),n(463),n(36)),dn=n.n(ln),bn=n(40),pn=n.n(bn),hn=n(81),fn=n.n(hn),jn=n(82),mn=n.n(jn),vn=n(121),On=n.n(vn),yn=n(205),gn=n.n(yn),xn=n(135),kn=n.n(xn),wn=n(256),Cn=n(853),Sn=n(258),An=n(524),En=n(401),Dn=n(854),Tn=n(863),Pn=n(868),qn=n(533),Rn=n(38),Mn=n(37),In=n.n(Mn),Ln=n(510),_n=n.n(Ln),zn=n(511),Bn=(n(63),n(124),n(56)),Fn=n.n(Bn),Qn=n(74),Nn=n.n(Qn),Un=n(386),Kn=n.n(Un),Vn=n(27),Yn=n.n(Vn),Jn=Object(w.createContext)(null),Gn={reset:"orange",black:"black",red:"red",green:"green",yellow:"orange",blue:"blue",magenta:"magenta",cyan:"cyan",gray:"gray",lightgrey:"lightgrey",darkgrey:"darkgrey"},Wn={"ansi-bright-black":"black","ansi-bright-yellow":"yellow","ansi-yellow":"yellow","ansi-bright-green":"green","ansi-green":"green","ansi-bright-cyan":"cyan","ansi-cyan":"cyan","ansi-bright-red":"red","ansi-red":"red","ansi-bright-magenta":"magenta","ansi-magenta":"magenta","ansi-white":"darkgrey"};function Hn(e){for(var t=(new _n.a).ansiToJson(Object(zn.encode)(e),{use_classes:!0}),n="",r=!1,a=0;a<t.length;++a)for(var i=t[a],o=i.content,c=i.fg,s=o.split("\n"),u=0;u<s.length;++u){r||(n+='<span data-ansi-line="true">',r=!0);var l=s[u].replace("\r",""),d=Gn[Wn[c]];null!=d?n+='<span style="color: '.concat(d,';">').concat(l,"</span>"):(null!=c&&console.log("Missing color mapping: ",c),n+="<span>".concat(l,"</span>")),u<s.length-1&&(n+="</span>",r=!1,n+="<br/>")}return r&&(n+="</span>"),n}function Zn(e){return"object"!==In()(e)?e:Object.fromEntries(Object.entries(e).filter((function(e){return null!=dn()(e,2)[1]})).map((function(e){var t=dn()(e,2),n=t[0],r=t[1];return Array.isArray(r)?[n,r.map(Zn)]:[n,"object"===In()(r)?Zn(r):r]})))}function $n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(n),!0).forEach((function(t){pn()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function er(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kn()(e);if(t){var a=kn()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return gn()(this,n)}}var tr=function(e){On()(n,e);var t=er(n);function n(e){var r;return fn()(this,n),(r=t.call(this,e)).state={},r.mutexObj={},r}return mn()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.query,n=e.queries;t&&this.load(t),n&&this.loadQueries(n)}},{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,r=n.query,a=n.queries,i=n.render,o=n.cubejsApi,c=n.loadSql,s=n.updateOnlyOnStateChange;return!s||(!Object(wn.a)(e.query,r)||!Object(wn.a)(e.queries,a)||(null==e.render||null==i)&&e.render!==i||e.cubejsApi!==o||e.loadSql!==c||!Object(wn.a)(t,this.state)||e.updateOnlyOnStateChange!==s)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.query,r=t.queries;Object(wn.a)(e.query,n)||this.load(n),Object(wn.a)(e.queries,r)||this.loadQueries(r)}},{key:"cubejsApi",value:function(){return this.props.cubejsApi||this.context&&this.context.cubejsApi}},{key:"load",value:function(e){var t=this,n=this.props.resetResultSetOnChange;this.setState(Xn({isLoading:!0,error:null,sqlQuery:null},n?{resultSet:null}:{}));var r=this.props.loadSql,a=this.cubejsApi();e&&Object(Rn.i)(e)&&("only"===r?a.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}).then((function(e){return t.setState({sqlQuery:e,error:null,isLoading:!1})})).catch((function(e){return t.setState(Xn(Xn({},n?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})):r?Promise.all([a.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}),a.load(e,{mutexObj:this.mutexObj,mutexKey:"query"})]).then((function(e){var n=dn()(e,2),r=n[0],a=n[1];return t.setState({sqlQuery:r,resultSet:a,error:null,isLoading:!1})})).catch((function(e){return t.setState(Xn(Xn({},n?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})):a.load(e,{mutexObj:this.mutexObj,mutexKey:"query"}).then((function(e){return t.setState({resultSet:e,error:null,isLoading:!1})})).catch((function(e){return t.setState(Xn(Xn({},n?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})))}},{key:"loadQueries",value:function(e){var t=this,n=this.cubejsApi(),r=this.props.resetResultSetOnChange;this.setState(Xn(Xn({isLoading:!0},r?{resultSet:null}:{}),{},{error:null})),Promise.all(Object(Cn.a)(e).map((function(e){var r=dn()(e,2),a=r[0],i=r[1];return n.load(i,{mutexObj:t.mutexObj,mutexKey:a}).then((function(e){return[a,e]}))}))).then((function(e){return t.setState({resultSet:Object(Sn.a)(e),error:null,isLoading:!1})})).catch((function(e){return t.setState(Xn(Xn({},r?{resultSet:null}:{}),{},{error:e,isLoading:!1}))}))}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.queries,r=e.resultSet,a=e.isLoading,i=e.sqlQuery,o=this.props.render,c={error:t?new Error(Hn(t.message||t.toString())):null,resultSet:n?r||{}:r,loadingState:{isLoading:a},sqlQuery:i};return o?o(c):null}}],[{key:"isQueryPresent",value:function(e){return Object(Rn.i)(e)}}]),n}(C.a.Component);tr.contextType=Jn,tr.defaultProps={cubejsApi:null,query:null,render:null,queries:null,loadSql:null,updateOnlyOnStateChange:!1,resetResultSetOnChange:!0};function nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(n),!0).forEach((function(t){pn()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ar(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kn()(e);if(t){var a=kn()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return gn()(this,n)}}var ir=[{name:void 0,title:"w/o grouping"},{name:"second",title:"Second"},{name:"minute",title:"Minute"},{name:"hour",title:"Hour"},{name:"day",title:"Day"},{name:"week",title:"Week"},{name:"month",title:"Month"},{name:"quarter",title:"Quarter"},{name:"year",title:"Year"}],or=function(e){On()(n,e);var t=ar(n);function n(e){var r;return fn()(this,n),r=t.call(this,e),pn()(Kn()(r),"fetchMeta",Nn()(Yn.a.mark((function e(){var t,n,a,i,o;return Yn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.cubejsApi()){e.next=2;break}return e.abrupt("return");case 2:return n=null,a=null,e.prev=4,r.setState({isFetchingMeta:!0}),e.next=8,r.cubejsApi().meta();case 8:t=e.sent,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),n=e.t0,a=(null===(i=e.t0.response)||void 0===i||null===(o=i.stack)||void 0===o?void 0:o.replace(e.t0.message||"",""))||"";case 15:r.setState({meta:t,metaError:n?new Error(Hn(n.message||n.toString())):null,metaErrorStack:a,isFetchingMeta:!1},(function(){r.updateQuery({})}));case 16:case"end":return e.stop()}}),e,null,[[4,11]])})))),r.state=rr(rr({query:e.defaultQuery||e.query,chartType:e.defaultChartType,validatedQuery:e.query,missingMembers:[],isFetchingMeta:!0,dryRunResponse:null},e.vizState),e.initialVizState),r.mutexObj={},r.orderMembersOrderKeys=[],r}return mn()(n,[{key:"componentDidMount",value:function(){var e=Nn()(Yn.a.mark((function e(){return Yn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.prevContext=this.context,e.next=3,this.fetchMeta();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Nn()(Yn.a.mark((function e(t){var n,r,a,i,o,c,s,u=this;return Yn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props,i=a.schemaVersion,o=a.onSchemaChange,c=this.state.meta,(null===(n=this.prevContext)||void 0===n?void 0:n.cubejsApi)===(null===(r=this.context)||void 0===r?void 0:r.cubejsApi)){e.next=6;break}return this.prevContext=this.context,e.next=6,this.fetchMeta();case 6:if(t.schemaVersion===i){e.next=17;break}return e.prev=7,e.next=10,this.cubejsApi().meta();case 10:s=e.sent,Object(wn.a)(s,c)||"function"!==typeof o||o({schemaVersion:i,refresh:function(){var e=Nn()(Yn.a.mark((function e(){return Yn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.fetchMeta();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),this.setState({metaError:e.t0});case 17:case"end":return e.stop()}}),e,this,[[7,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cubejsApi",value:function(){var e=this.props.cubejsApi;return e||this.context&&this.context.cubejsApi}},{key:"getMissingMembers",value:function(e,t){return t?Object(Rn.h)(e).map((function(e){return!!t.resolveMember(e,["measures","dimensions","segments"]).error&&e})).filter(Boolean):[]}},{key:"isQueryPresent",value:function(){var e=this.state.query;return tr.isQueryPresent(e)}},{key:"prepareRenderProps",value:function(e){var t=this,r=function(e){return e.name},a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;return{add:function(r){var a=t.state.query;t.updateQuery(pn()({},e,(a[e]||[]).concat(n(r))))},remove:function(n){var r=t.state.query;return t.updateQuery(pn()({},e,(r[e]||[]).filter((function(e,t){return t!==n.index}))))},update:function(r,a){var i=(t.state.query[e]||[]).concat([]);return i.splice(r.index,1,n(a)),t.updateQuery(pn()({},e,i))}}},i=this.state,o=i.meta,c=i.metaError,s=i.query,u=i.queryError,l=i.chartType,d=i.pivotConfig,b=i.validatedQuery,p=i.missingMembers,h=i.isFetchingMeta,f=i.dryRunResponse,j=i.metaErrorStack,m=Object(An.a)((function(e){return"".concat(Object(En.a)("member",e)).concat(Object(En.a)("operator",e))}),Object(Rn.g)(o&&s.filters||[]).map((function(e){return rr(rr({},e),{},{member:e.member||e.dimension})}))).map((function(e,t){return rr(rr({},e),{},{dimension:o.resolveMember(e.member||e.dimension,["dimensions","measures"]),operators:o.filterOperatorsForMember(e.member||e.dimension,["dimensions","measures"]),index:t})})),v=n.resolveMember("measures",this.state),O=n.resolveMember("dimensions",this.state),y=n.resolveMember("timeDimensions",this.state),g=(o&&s.segments||[]).map((function(e,t){return rr({index:t},o.resolveMember(e,"segments"))})),x=[],k=[],w=[],C=[],S=(null===o||void 0===o?void 0:o.membersGroupedByCube())||{measures:[],dimensions:[],segments:[],timeDimensions:[]};if(o){x=o.membersForQuery(s,"measures"),k=o.membersForQuery(s,"dimensions"),w=o.membersForQuery(s,"segments");var A=Object(Dn.a)(Object(En.a)("cubeName"),S.measures),E=Object(Dn.a)(Object(En.a)("cubeName"),S.dimensions);C=Object(Tn.a)([].concat(Fn()(Object.keys(A)),Fn()(Object.keys(E)))).sort().map((function(e){var t,n;return rr(rr({},A[e]||E[e]),{},{members:[].concat(Fn()(null===(t=A[e])||void 0===t?void 0:t.members),Fn()(null===(n=E[e])||void 0===n?void 0:n.members)).sort((function(e,t){return e.shortTitle>t.shortTitle?1:-1}))})}))}var D=Array.isArray(s.order)?Object.fromEntries(s.order):s.order,T=[].concat(Fn()(v),Fn()(O),Fn()(y.map((function(e){return e.dimension})))),P=Object(An.a)(Object(En.a)("id"),Fn()(T.map((function(e){var t=e.name;return{id:t,title:e.title,order:(null===D||void 0===D?void 0:D[t])||"none"}}))));return this.orderMembersOrderKeys.length!==P.length&&(this.orderMembersOrderKeys=P.map((function(e){return e.id}))),this.orderMembersOrderKeys.length&&(P=(this.orderMembersOrderKeys||[]).map((function(e){return P.find((function(t){return t.id===e}))}))),rr({meta:o,metaError:c,metaErrorStack:j,query:s,error:u,validatedQuery:b,isQueryPresent:this.isQueryPresent(),chartType:l,measures:v,dimensions:O,timeDimensions:y,segments:g,filters:m,orderMembers:P,availableMeasures:x,availableDimensions:k,availableTimeDimensions:k.filter((function(e){return"time"===e.type})),availableSegments:w,availableMembers:S,availableFilterMembers:C,updateQuery:function(e){return t.updateQuery(e)},updateMeasures:a("measures"),updateDimensions:a("dimensions"),updateSegments:a("segments"),updateTimeDimensions:a("timeDimensions",(function(e){var t=e.compareDateRange?{compareDateRange:e.compareDateRange}:{dateRange:e.dateRange};return Zn(rr({dimension:e.dimension.name,granularity:e.granularity},t))})),updateFilters:a("filters",(function(e){var t,n;return{member:(null===(t=e.member)||void 0===t?void 0:t.name)||(null===(n=e.dimension)||void 0===n?void 0:n.name),operator:e.operator,values:e.values}})),updateChartType:function(e){return t.updateVizState({chartType:e})},updateOrder:{set:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";t.updateQuery({order:P.map((function(t){return rr(rr({},t),{},{order:t.id===e?n:t.order})})).reduce((function(e,t){var n=t.id,r=t.order;return"none"!==r?[].concat(Fn()(e),[[n,r]]):e}),[])})},update:function(e){t.updateQuery({order:e})},reorder:function(e,n){if(null!=e&&null!=n){var r=Object(Rn.j)(P,e,n);t.orderMembersOrderKeys=r.map((function(e){return e.id})),t.updateQuery({order:r.reduce((function(e,t){var n=t.id,r=t.order;return"none"!==r?[].concat(Fn()(e),[[n,r]]):e}),[])})}}},pivotConfig:d,updatePivotConfig:{moveItem:function(e){var n=e.sourceIndex,r=e.destinationIndex,a=e.sourceAxis,i=e.destinationAxis;t.updateVizState({pivotConfig:Object(Rn.k)(d,n,r,a,i)})},update:function(e){var n=e.limit;t.updateVizState(rr({pivotConfig:rr(rr({},d),e)},n?{query:rr(rr({},s),{},{limit:n})}:null))}},missingMembers:p,refresh:this.fetchMeta,isFetchingMeta:h,dryRunResponse:f},e)}},{key:"updateQuery",value:function(e){var t=this.state.query;this.updateVizState({query:Object(Rn.l)(rr(rr({},t),e))})}},{key:"updateVizState",value:function(){var e=Nn()(Yn.a.mark((function e(t){var n,r,a,i,o,c,s,u,l,d,b,p,h,f=this;return Yn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,r=n.setQuery,a=n.setVizState,i=this.state,o=i.query,c=i.pivotConfig,s=i.chartType,u=i.meta,(l=this.applyStateChangeHeuristics(t)).query||(l.query=rr({},o)),d=null,b=function(e){var t=f.props.onVizStateChanged;if(t){var n=Object(Pn.a)(["chartType","pivotConfig","query"],e);d&&Object(wn.a)(d,n)||(t(n),d=Object(qn.a)(n))}},p=function(e){a&&a(Object(Pn.a)(["chartType","pivotConfig","query"],e)),e.query&&r&&r(e.query)},l.shouldApplyHeuristicOrder&&(l.query.order=Object(Rn.f)(l.query)),l.pivotConfig=Rn.b.getNormalizedPivotConfig(l.query,void 0!==l.pivotConfig?l.pivotConfig:c),l.missingMembers=this.getMissingMembers(l.query,u),l.chartType=l.chartType||t.chartType||s,p(rr(rr({},t),{},{query:l.query})),this.setState(rr(rr({},l),{},{queryError:null})),b(l),!!Object(wn.a)(Object(Pn.a)(["measures","dimensions","timeDimensions"],o),Object(Pn.a)(["measures","dimensions","timeDimensions"],l.query))||!Object(Rn.i)(l.query)||0!==l.missingMembers.length){e.next=30;break}return e.prev=16,e.next=19,this.cubejsApi().dryRun(l.query,{mutexObj:this.mutexObj});case 19:h=e.sent,l.shouldApplyHeuristicOrder&&(l.query.order=(h.queryOrder||[]).reduce((function(e,t){return rr(rr({},e),t)}),{})),l.pivotConfig=Rn.b.getNormalizedPivotConfig(h.pivotQuery,l.pivotConfig),l.validatedQuery=this.validatedQuery(l),l.dryRunResponse=h,Object(Rn.i)(o)&&p(rr(rr({},this.state),l)),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(16),this.setState({queryError:new Error(Hn(e.t0.message||e.t0.toString()))});case 30:this.setState(l,(function(){return b(f.state)}));case 31:case"end":return e.stop()}}),e,this,[[16,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"validatedQuery",value:function(e){var t=(e||this.state).query;return Object(Rn.m)(t)}},{key:"defaultHeuristics",value:function(e){var t=this.state,n=t.query,r=t.sessionGranularity,a=t.meta;return Object(Rn.e)(e,n,{meta:a,sessionGranularity:r||"day"})}},{key:"applyStateChangeHeuristics",value:function(e){var t=this.props,n=t.stateChangeHeuristics;return t.disableHeuristics?e:n&&n(this.state,e)||this.defaultHeuristics(e)}},{key:"render",value:function(){var e=this,t=this.state.query,n=this.props,r=n.cubejsApi,a=n.render;return n.wrapWithQueryRenderer?C.a.createElement(tr,{query:t,cubejsApi:r,resetResultSetOnChange:!1,render:function(t){return a?a(e.prepareRenderProps(t)):null}}):a?a(this.prepareRenderProps()):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.query||e.vizState){var n=rr(rr({},t),e.vizState||{});if(Array.isArray(e.query))throw new Error("Array of queries is not supported.");return rr(rr({},n),{},{query:rr(rr({},n.query),e.query||{})})}return null}},{key:"resolveMember",value:function(e,t){var r=t.meta,a=t.query;return r?Array.isArray(a)?a.reduce((function(t,a){return t.concat(n.resolveMember(e,{meta:r,query:a}))}),[]):"timeDimensions"===e?(a.timeDimensions||[]).map((function(e,t){return rr(rr({},e),{},{dimension:rr(rr({},r.resolveMember(e.dimension,"dimensions")),{},{granularities:ir}),index:t})})):(a[e]||[]).map((function(t,n){return rr({index:n},r.resolveMember(t,e))})):[]}}]),n}(C.a.Component);function cr(e){var t=e.cubejsApi,n=e.children;return C.a.createElement(Jn.Provider,{value:{cubejsApi:t}},n)}function sr(e){var t=Object(w.useRef)([]);return Object(wn.a)(e,t.current)||(t.current=e),t.current}function ur(){var e=Object(w.useRef)(!1);return Object(w.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),function(){return e.current}}function lr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lr(Object(n),!0).forEach((function(t){pn()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function br(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=ur(),a=Object(w.useContext)(Jn),i=Object(w.useRef)({}),o=Object(w.useState)({isLoading:!1,response:null}),c=dn()(o,2),s=c[0],u=c[1],l=Object(w.useState)(null),d=dn()(l,2),b=d[0],p=d[1],h=n.skip,f=void 0!==h&&h;function j(){return m.apply(this,arguments)}function m(){return m=Nn()(Yn.a.mark((function t(){var o,c,s,l,d,b,h,j,m=arguments;return Yn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=m.length>0&&void 0!==m[0]?m[0]:{},c=m.length>1&&void 0!==m[1]&&m[1],s=n.cubejsApi||(null===a||void 0===a?void 0:a.cubejsApi),l=o.query||n.query,d="meta"===e||l&&Object(Rn.i)(l),!s||!c&&f||!d){t.next=20;break}return p(null),u({isLoading:!0,response:null}),b={mutexObj:i.current,mutexKey:e},h="meta"===e?[b]:[l,b],t.prev=10,t.next=13,s[e].apply(s,h);case 13:j=t.sent,r()&&u({response:j,isLoading:!1}),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(10),r()&&(p(t.t0),u({isLoading:!1,response:null}));case 20:case"end":return t.stop()}}),t,null,[[10,17]])}))),m.apply(this,arguments)}return Object(w.useEffect)((function(){j()}),sr([Object.keys((null===(t=n.query)||void 0===t?void 0:t.order)||{}),n,a])),dr(dr({},s),{},{error:b,refetch:function(e){return j(e,!0)}})}function pr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pr(Object(n),!0).forEach((function(t){pn()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}pn()(or,"contextType",Jn),or.defaultProps={cubejsApi:null,stateChangeHeuristics:null,disableHeuristics:!1,render:null,wrapWithQueryRenderer:!0,defaultChartType:"line",defaultQuery:{},initialVizState:null,onVizStateChanged:null,query:null,setQuery:null,vizState:null,setVizState:null};var fr,jr=n(250),mr=n(224),vr=n(90),Or=n(870),yr=function(e){var t=e.query;return Object(_.jsx)(tr,{loadSql:!0,query:Object(b.a)(Object(b.a)({},t),{},{renewQuery:!0}),render:function(e){var t,n=e.sqlQuery,r=e.resultSet,a=e.error;if(a)return Object(_.jsx)(Le,{error:a});var i=(null===r||void 0===r?void 0:r.serialize())||{},o=null===n||void 0===n?void 0:n.rawQuery(),c=null===(t=i.loadResponse)||void 0===t?void 0:t.results[0];return Object(_.jsxs)(Nt.a,{defaultActiveKey:"refreshKeys",tabBarExtraContent:Object(_.jsxs)("span",{children:["Last Refresh Time:\xa0",Object(_.jsx)("b",{children:null===c||void 0===c?void 0:c.lastRefreshTime})]}),children:[Object(_.jsx)(Nt.a.TabPane,{tab:"Refresh Keys",children:Object(_.jsx)(Or.a,{loading:!n,pagination:!1,scroll:{x:!0},columns:[{title:"Refresh Key SQL",key:"refreshKey",render:function(e,t){return Object(_.jsx)(Je,{code:Object(jr.format)(t[0])})}},{title:"Value",key:"value",render:function(e,t){return Object(_.jsx)(Je,{code:(null===c||void 0===c?void 0:c.refreshKeyValues)&&o&&JSON.stringify(c.refreshKeyValues[o.cacheKeyQueries.indexOf(t)],null,2)})}}],dataSource:null===o||void 0===o?void 0:o.cacheKeyQueries})},"refreshKeys"),Object(_.jsx)(Nt.a.TabPane,{tab:"Pre-aggregations",children:Object(_.jsx)(Or.a,{loading:!n,pagination:!1,scroll:{x:!0},columns:[{title:"Table Name",key:"tableName",dataIndex:"tableName",render:function(e){return Object(_.jsx)("b",{children:e})}},{title:"Refresh Key SQL",key:"refreshKey",dataIndex:"invalidateKeyQueries",render:function(e){return e.map((function(e){return Object(_.jsx)(Je,{code:Object(jr.format)(e[0])},e[0])}))}},{title:"Refresh Key Value",key:"value",render:function(e,t){var n,r,a,i=null===c||void 0===c||null===(n=c.usedPreAggregations)||void 0===n||null===(r=n[t.tableName])||void 0===r?void 0:r.refreshKeyValues;return Array.isArray(i)&&(i=i.reduce((function(e,t){return e.concat(t)}),[])),null===(a=i)||void 0===a?void 0:a.map((function(e){return Object(_.jsx)(Je,{code:JSON.stringify(e,null,2)},JSON.stringify(e))}))}}],dataSource:null===o||void 0===o?void 0:o.preAggregations})},"preAggregations"),Object(_.jsx)(Nt.a.TabPane,{tab:"Rollup Match Results",children:Object(_.jsx)(Or.a,{loading:!n,pagination:!1,scroll:{x:!0},columns:[{title:"Rollup Name",key:"name",dataIndex:"name",render:function(e){return Object(_.jsx)("b",{children:e})}},{title:"Rollup Definition",key:"rollup",dataIndex:"references",render:function(e){return Object(_.jsx)(Je,{code:JSON.stringify(e,null,2)})}},{title:"Can Be Used",key:"canUsePreAggregation",dataIndex:"canUsePreAggregation",render:function(e){return e?Object(_.jsx)(mr.a,{style:{color:"#52c41a",fontSize:"2em"}}):Object(_.jsx)(vr.a,{style:{color:"#c2371b",fontSize:"2em"}})}}],dataSource:null===o||void 0===o?void 0:o.rollupMatchResults})},"rollupMatchResults")]})}})},gr=function(){return Object(_.jsx)(T.a,{component:function(){return Object(_.jsx)("svg",{version:"1.1",height:"1em",width:"1em",x:"0px",y:"0px",viewBox:"0 0 400 400","enable-background":"new 0 0 400 400",fill:"currentColor",children:Object(_.jsxs)("g",{children:[Object(_.jsx)("rect",{x:"122",y:"-0.4",transform:"matrix(-0.866 -0.5 0.5 -0.866 163.3196 363.3136)",width:"16.6",height:"320.3"}),Object(_.jsx)("rect",{x:"39.8",y:"272.2",width:"320.3",height:"16.6"}),Object(_.jsx)("rect",{x:"37.9",y:"312.2",transform:"matrix(-0.866 -0.5 0.5 -0.866 83.0693 663.3409)",width:"185",height:"16.6"}),Object(_.jsx)("rect",{x:"177.1",y:"71.1",transform:"matrix(-0.866 -0.5 0.5 -0.866 463.3409 283.0693)",width:"185",height:"16.6"}),Object(_.jsx)("rect",{x:"122.1",y:"-13",transform:"matrix(-0.5 -0.866 0.866 -0.5 126.7903 232.1221)",width:"16.6",height:"185"}),Object(_.jsx)("rect",{x:"109.6",y:"151.6",transform:"matrix(-0.5 -0.866 0.866 -0.5 266.0828 473.3766)",width:"320.3",height:"16.6"}),Object(_.jsx)("rect",{x:"52.5",y:"107.5",width:"16.6",height:"185"}),Object(_.jsx)("rect",{x:"330.9",y:"107.5",width:"16.6",height:"185"}),Object(_.jsx)("rect",{x:"262.4",y:"240.1",transform:"matrix(-0.5 -0.866 0.866 -0.5 126.7953 714.2875)",width:"14.5",height:"160.9"}),Object(_.jsx)("path",{d:"M369.5,297.9c-9.6,16.7-31,22.4-47.7,12.8c-16.7-9.6-22.4-31-12.8-47.7c9.6-16.7,31-22.4,47.7-12.8   C373.5,259.9,379.2,281.2,369.5,297.9"}),Object(_.jsx)("path",{d:"M90.9,137c-9.6,16.7-31,22.4-47.7,12.8c-16.7-9.6-22.4-31-12.8-47.7c9.6-16.7,31-22.4,47.7-12.8   C94.8,99,100.5,120.3,90.9,137"}),Object(_.jsx)("path",{d:"M30.5,297.9c-9.6-16.7-3.9-38,12.8-47.7c16.7-9.6,38-3.9,47.7,12.8c9.6,16.7,3.9,38-12.8,47.7   C61.4,320.3,40.1,314.6,30.5,297.9"}),Object(_.jsx)("path",{d:"M309.1,137c-9.6-16.7-3.9-38,12.8-47.7c16.7-9.6,38-3.9,47.7,12.8c9.6,16.7,3.9,38-12.8,47.7   C340.1,159.4,318.7,153.7,309.1,137"}),Object(_.jsx)("path",{d:"M200,395.8c-19.3,0-34.9-15.6-34.9-34.9c0-19.3,15.6-34.9,34.9-34.9c19.3,0,34.9,15.6,34.9,34.9   C234.9,380.1,219.3,395.8,200,395.8"}),Object(_.jsx)("path",{d:"M200,74c-19.3,0-34.9-15.6-34.9-34.9c0-19.3,15.6-34.9,34.9-34.9c19.3,0,34.9,15.6,34.9,34.9   C234.9,58.4,219.3,74,200,74"})]})})}})},xr=Object(w.lazy)((function(){return Promise.all([n.e(12),n.e(19)]).then(n.bind(null,1147))})),kr={react:"create-react-app",angular:"angular-cli",vue:"vue-cli"},wr=Object(E.d)(Ne)(fr||(fr=Object(k.a)(["\n  min-height: 420px;\n  \n  .ant-card-head {\n    position: sticky;\n    top: 0;\n    z-index: 100;\n    background: white;\n  }\n\n  .ant-card-body {\n    max-width: 100%;\n    overflow: auto;\n    position: relative;\n  }\n"]))),Cr=[{id:"react",title:"React",scaffoldingSupported:!0},{id:"angular",title:"Angular",scaffoldingSupported:!0},{id:"vue",title:"Vue",scaffoldingSupported:!0},{id:"vanilla",title:"Vanilla JavaScript",placeholder:function(e){var t=e.framework;return Object(_.jsxs)("h2",{style:{padding:24,textAlign:"center"},children:["We do not support\xa0 Vanilla JavaScript \xa0code generation here yet.",Object(_.jsx)("br",{}),"Please refer to\xa0",Object(_.jsx)("a",{href:"https://cube.dev/docs/@cubejs-client-core",target:"_blank",rel:"noopener noreferrer",onClick:function(){return ut("Unsupported Framework Docs",{framework:t})},children:"Vanilla JavaScript \xa0docs"}),"\xa0to see on how to use it with Cube.js."]})}},{id:"bi",title:"BI",placeholder:function(){return Object(_.jsxs)("h2",{style:{padding:24,textAlign:"center"},children:["You can connect Cube to any Business Intelligence tool through the Cube SQL API.",Object(_.jsx)("br",{}),"Please refer to\xa0",Object(_.jsx)("a",{href:"https://cube.dev/docs/backend/sql",target:"_blank",rel:"noopener noreferrer",onClick:function(){return ut("BI Docs")},children:"Cube SQL \xa0docs"}),"\xa0to learn more."]})}}],Sr=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).state={showCode:!1,chartRendererError:null,sql:{loading:!1}},r}return Object(y.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.codeExample,r=t.codesandboxFiles,a=t.dependencies,i=t.redirectToDashboard,o=t.showCode,c=t.addingToDashboard,s=t.chartRendererError,u=t.sql,l=this.props,b=l.isChartRendererReady,h=l.resultSet,f=l.error,j=l.render,v=l.dashboardSource,O=l.hideActions,y=l.query,g=l.chartingLibrary,x=l.setChartLibrary,k=l.chartLibraries,C=l.history,S=l.framework,A=l.setFramework,E=l.meta,D=l.isFetchingMeta,T=l.onChartRendererReadyChange;if(i)return Object(_.jsx)(m.a,{to:"/dashboard"});if(s)return Object(_.jsx)("div",{children:s});var P,q=b?Object(un.getParameters)(Object(Z.a)(kr[S],r,a)):null,I=(k[S]||[]).length>0?Object(_.jsx)(M.a,{"data-testid":"charting-library-dropdown",onClick:function(e){ut("Set Chart Library",{chartingLibrary:e.key}),x(e.key)},children:(k[S]||[]).map((function(e){return Object(_.jsx)(M.a.Item,{children:e.title},e.value)}))}):null,L=Object(_.jsx)(M.a,{"data-testid":"framework-dropdown",onClick:function(e){var t,n;e.key!==S&&(ut("Set Framework",{framework:e.key}),A(e.key),T(!1),x((null===(t=k[e.key])||void 0===t||null===(n=t[0])||void 0===n?void 0:n.value)||null))},children:Cr.map((function(e){return Object(_.jsx)(M.a.Item,{children:e.title},e.id)}))}),z=(k[S]||[]).find((function(e){return e.value===g})),B=Cr.find((function(e){return e.id===S})),F=Object(_.jsxs)("form",{action:"https://codesandbox.io/api/v1/sandboxes/define",method:"POST",target:"_blank",children:[null!=q?Object(_.jsx)("input",{type:"hidden",name:"parameters",value:q}):null,Object(_.jsxs)(Mt,{children:[Object(_.jsxs)(ze.Group,{children:[Object(_.jsx)(R.a,{overlay:L,disabled:D,children:Object(_.jsxs)(ze,{"data-testid":"framework-btn",size:"small",children:[null===B||void 0===B?void 0:B.title,Object(_.jsx)(rn.a,{})]})}),I?Object(_.jsx)(R.a,{overlay:I,disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,children:Object(_.jsxs)(ze,{"data-testid":"charting-library-btn",size:"small",children:[null===z||void 0===z?void 0:z.title,Object(_.jsx)(rn.a,{})]})}):null]}),Object(_.jsxs)(ze.Group,{children:[Object(_.jsx)(ze,{"data-testid":"chart-btn",size:"small",type:o?"default":"primary",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){ut("Show Chart"),e.setState({showCode:null})},children:"Chart"}),Object(_.jsx)(ze,{"data-testid":"json-query-btn",size:"small",type:"query"===o?"primary":"default",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){ut("Show Query"),e.setState({showCode:"query"})},children:"JSON Query"}),Object(_.jsx)(ze,{"data-testid":"graphiql-btn",icon:Object(_.jsx)(gr,{}),size:"small",type:"graphiql"===o?"primary":"default",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){ut("Show GraphiQL"),e.setState({showCode:"graphiql"})},children:"GraphiQL"}),Object(_.jsx)(ze,{"data-testid":"code-btn",icon:Object(_.jsx)(an.a,{}),size:"small",type:"code"===o?"primary":"default",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){ut("Show Code"),e.setState({showCode:"code"})},children:"Code"}),Object(_.jsx)(ze,{"data-testid":"sql-btn",icon:Object(_.jsx)(on.a,{}),size:"small",type:"sql"===o?"primary":"default",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){ut("Show SQL"),e.setState({showCode:"sql"})},children:"SQL"}),Object(_.jsx)(ze,{"data-testid":"cache-btn",icon:Object(_.jsx)(cn.a,{}),size:"small",type:"cache"===o?"primary":"default",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){ut("Show Cache"),e.setState({showCode:"cache"})},children:"Cache"})]}),Object(_.jsx)(ze,{"data-testid":"edit-btn",icon:Object(_.jsx)(sn.a,{}),size:"small",htmlType:"submit",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){return ut("Open Code Sandbox")},children:"Edit"}),v&&Object(_.jsx)(ze,{"data-testid":"add-to-dashboard-btn",onClick:Object(p.a)(d.a.mark((function t(){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({addingToDashboard:!0}),t.next=3,v.canAddChart();case 3:if("boolean"!==typeof(r=t.sent)||!r){t.next=11;break}return ut("Add to Dashboard"),t.next=8,v.addChart(n);case 8:e.setState({redirectToDashboard:!0,addingToDashboard:!1}),t.next=12;break;case 11:r?(e.setState({addingToDashboard:!1}),Pt.a.error({title:"There is an error loading your dashboard app",content:r,okText:"Fix",okCancel:!0,onOk:function(){C.push("/dashboard")}})):(e.setState({addingToDashboard:!1}),Pt.a.error({title:"Your dashboard app does not support adding of static charts",content:"Please use static dashboard template"}));case 12:case"end":return t.stop()}}),t)}))),icon:Object(_.jsx)(nn.a,{}),size:"small",loading:c,disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,type:"primary",children:c?"Preparing dashboard app. It may take a while. Please check console for progress...":"Add to Dashboard"})]})]}),Q=JSON.stringify(y,null,2);return P="code"===o?Object(_.jsxs)(Mt,{style:{alignItems:"center"},children:[Object(_.jsx)("div",{children:"Code"}),Object(_.jsx)(ze,{"data-testid":"copy-code-btn",icon:Object(_.jsx)($.a,{}),size:"small",disabled:Boolean(f),onClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.b)(n);case 2:ut("Copy Code to Clipboard");case 3:case"end":return e.stop()}}),e)}))),type:"primary",children:"Copy to Clipboard"})]}):"query"===o?Object(_.jsxs)(Mt,{children:[Object(_.jsx)("div",{children:"Query"}),Object(_.jsx)(ze,{"data-testid":"copy-cube-query-btn",icon:Object(_.jsx)($.a,{}),size:"small",onClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.b)(JSON.stringify(y,null,2));case 2:ut("Copy Query to Clipboard");case 3:case"end":return e.stop()}}),e)}))),type:"primary",children:"Copy to Clipboard"})]}):"sql"===o?Object(_.jsxs)(Mt,{children:[Object(_.jsx)("div",{children:"SQL"}),!u.loading&&u.value?Object(_.jsx)(ze,{"data-testid":"copy-sql-btn",icon:Object(_.jsx)($.a,{}),size:"small",onClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.b)(u.value,"The SQL has been copied");case 2:ut("Copy SQL to Clipboard");case 3:case"end":return e.stop()}}),e)}))),type:"primary",children:"Copy to Clipboard"}):null]}):"cache"===o?"Cache":"graphiql"===o?"GraphQL API":"Chart",O?j({resultSet:h,error:f}):Object(_.jsx)(wr,{title:P,extra:F,children:function(){if(null===B||void 0===B?void 0:B.placeholder){var t=B.placeholder;return Object(_.jsx)(t,{framework:S})}return"code"===o?f?Object(_.jsx)(Le,{error:f}):Object(_.jsx)(Je,{code:n}):"query"===o?Object(_.jsx)(Je,{code:Q}):"sql"===o?Object(_.jsx)(tr,{loadSql:"only",query:y,render:function(t){var n=t.sqlQuery,r=t.loadingState,a=t.error;if(a)return Object(_.jsx)(Le,{error:a});var i=Array.isArray(n)?n:[n],o=Object(N.a)(i,1)[0],c=o&&Object(jr.format)(o.sql());return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Je,{code:c}),Object(_.jsx)(Ar,{loading:r.isLoading,sql:c,onChange:function(t){var n=t.sql,r=t.loading;e.setState({sql:{loading:r,value:n}})}})]})}}):"cache"===o?Object(_.jsx)(yr,{query:y}):"graphiql"===o&&E?e.props.isGraphQLSupported?Object(_.jsx)(w.Suspense,{fallback:Object(_.jsx)("div",{style:{height:363},children:Object(_.jsx)(Te,{})}),children:Object(_.jsx)(xr,{apiUrl:e.props.apiUrl,query:y,meta:E})}):Object(_.jsx)("div",{children:"GraphQL API is supported since version 0.29.0"}):j({framework:S,error:f})}()})}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.isChartRendererReady&&null!=e.iframeRef.current&&e.chartingLibrary){var n=(e.iframeRef.current.contentWindow||{}).__cubejsPlayground;if(!n)return Object(b.a)(Object(b.a)({},t),{},{chartRendererError:"The chart renderer failed to load"});var r=n.getCodesandboxFiles(e.chartingLibrary,{chartType:e.chartType,query:JSON.stringify(e.query,null,2),pivotConfig:JSON.stringify(e.pivotConfig,null,2),apiUrl:e.apiUrl,cubejsToken:e.cubejsToken}),a="";return"react"===e.framework?a=r["index.js"]:"angular"===e.framework?a=r["src/app/query-renderer/query-renderer.component.ts"]:"vue"===e.framework&&(a=r["src/components/ChartRenderer.vue"]),Object(b.a)(Object(b.a)({},t),{},{chartRendererError:null,dependencies:n.getDependencies(e.chartingLibrary),codeExample:a,codesandboxFiles:r})}return t}}]),n}(w.Component);function Ar(e){var t=e.sql,n=e.loading,r=e.onChange;return Object(w.useEffect)((function(){r({sql:t,loading:n})}),[t,n]),null}Sr.defaultProps={query:{},hideActions:!1};var Er,Dr,Tr,Pr,qr,Rr,Mr,Ir,Lr=Object(m.g)(Sr),_r=n(531),zr=n(873),Br=n(886),Fr=Object(E.d)(Pt.a)(Er||(Er=Object(k.a)(["\n  && {\n    .ant-modal-header {\n      border-bottom: none;\n      padding: 40px 32px 0 32px;\n\n      .ant-modal-title {\n        font-size: 20px;\n      }\n    }\n\n    .ant-modal-footer {\n      border-top: none;\n      padding: 0 32px 34px 32px;\n      text-align: left;\n    }\n  }\n"]))),Qr=Object(E.d)(zr.a)(Dr||(Dr=Object(k.a)(["\n  && {\n    .ant-form-item-label {\n      line-height: 16px;\n      margin-bottom: 7px;\n      label {\n        font-weight: 500;\n        font-size: 12px;\n        line-height: 16px;\n      }\n    }\n\n    .ant-dropdown-trigger {\n      padding: 5px 12px;\n    }\n  }\n"]))),Nr=Object(E.d)(zr.a.Item)(Tr||(Tr=Object(k.a)(["\n  && {\n    &:not(:last-child) {\n      margin-bottom: 16px;\n    }\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n"]))),Ur=function(){return Object(_.jsx)(_r.a,{style:{color:"#727290"}})},Kr=function(e){var t=e.visible,n=e.onOk,r=e.onCancel,a=e.onChange,i=e.chartLibraries,o=e.currentLibraryItem,c=e.frameworks,s=e.framework,u=e.frameworkItem,l=e.templatePackages,d=e.templatePackage,b=e.enableWebSocketTransport,p=Object(_.jsx)(M.a,{onClick:function(e){ut("Set Chart Library",{chartLibrary:e.key}),a("chartLibrary",e.key)},children:i.map((function(e){return Object(_.jsx)(M.a.Item,{children:e.title},e.value)}))}),h=Object(_.jsx)(M.a,{onClick:function(e){ut("Set Framework",{framework:e.key}),a("framework",e.key)},children:c.map((function(e){return Object(_.jsx)(M.a.Item,{children:e.title},e.id)}))}),f=Object(_.jsx)(M.a,{onClick:function(e){ut("Set Template Package",{templatePackageName:e.key}),a("templatePackageName",e.key)},children:(l||[]).map((function(e){return Object(_.jsx)(M.a.Item,{children:e.description},e.name)}))});return Object(_.jsx)(Fr,{title:"Create your own Dashboard App",visible:t,onOk:n,onCancel:r,footer:[Object(_.jsx)(ze,{type:"primary",onClick:n,children:"Ok"},"submit"),Object(_.jsx)(ze,{onClick:r,children:"Cancel"},"back")],children:Object(_.jsxs)(Qr,{children:[Object(_.jsx)(Nr,{label:"Framework",children:Object(_.jsx)(R.a,{overlay:h,children:Object(_.jsxs)(ze,{children:[u&&u.title,Object(_.jsx)(Ur,{})]})})}),!(null===u||void 0===u?void 0:u.scaffoldingSupported)&&Object(_.jsx)(A.a,{style:{marginBottom:23},type:"info",message:Object(_.jsxs)("span",{children:["We do not support\xa0",u.title,"\xa0dashboard scaffolding generation yet. Please refer to\xa0",Object(_.jsxs)("a",{href:u.docsLink,target:"_blank",rel:"noopener noreferrer",onClick:function(){return ut("Unsupported Dashboard Framework Docs",{framework:s})},children:[u.title,"\xa0docs"]}),"\xa0to see on how to use it with Cube.js."]})}),Object(_.jsx)(Nr,{label:"Main Template",children:Object(_.jsx)(R.a,{overlay:f,disabled:!u.scaffoldingSupported,children:Object(_.jsxs)(ze,{children:[d&&d.description,Object(_.jsx)(Ur,{})]})})}),Object(_.jsx)(Nr,{label:"Charting Library",children:Object(_.jsx)(R.a,{overlay:p,disabled:!u.scaffoldingSupported,children:Object(_.jsxs)(ze,{children:[o&&o.title,Object(_.jsx)(Ur,{})]})})}),Object(_.jsx)(Nr,{label:"Web Socket Transport (Real-time)",children:Object(_.jsx)(Br.a,{disabled:"react"!==s.toLowerCase(),checked:b,onChange:function(e){return a("enableWebSocketTransport",e)}})})]})})},Vr=n(896),Yr=n(532),Jr=Object(w.createContext)({});function Gr(e){var t=e.children,n=Object(w.useState)({}),r=Object(N.a)(n,2),a=r[0],i=r[1],o=Object(w.useState)({}),c=Object(N.a)(o,2),s=c[0],u=c[1],l=Object(w.useState)({}),d=Object(N.a)(l,2),p=d[0],h=d[1],f=Object(w.useState)({}),j=Object(N.a)(f,2),m=j[0],v=j[1],O=Object(w.useState)({}),y=Object(N.a)(O,2),g=y[0],x=y[1],k=Object(w.useState)({}),C=Object(N.a)(k,2),S=C[0],A=C[1],E=Object(w.useState)({}),D=Object(N.a)(E,2),T=D[0],P=D[1],q=Object(w.useState)({}),R=Object(N.a)(q,2),M=R[0],I=R[1],L=Object(w.useState)({}),z=Object(N.a)(L,2),B=z[0],F=z[1];return Object(_.jsx)(Jr.Provider,{value:{chartRendererState:a,setChartRendererReady:function(e,t){i((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(Xt.a)({},e,t))}))},queryStatus:s,setQueryStatus:function(e,t){u((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(Xt.a)({},e,t))}))},resultSetExists:p,setResultSetExists:function(e,t){h((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(Xt.a)({},e,t))}))},isQueryLoading:m,setQueryLoading:function(e,t){v((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(Xt.a)({},e,t))}))},queryError:g,setQueryError:function(e,t){x((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(Xt.a)({},e,t))}))},isBuildInProgress:S,setBuildInProgress:function(e,t){A((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(Xt.a)({},e,t))}))},slowQuery:T,setSlowQuery:function(e,t){P((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(Xt.a)({},e,t))}))},slowQueryFromCache:M,setSlowQueryFromCache:function(e,t){I((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(Xt.a)({},e,t))}))},queryRequestId:B,setQueryRequestId:function(e,t){F((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(Xt.a)({},e,t))}))}},children:t})}function Wr(e){var t=Object(w.useContext)(Jr),n=t.chartRendererState,r=t.queryStatus,a=t.resultSetExists,i=t.isQueryLoading,o=t.queryError,c=t.isBuildInProgress,s=t.slowQuery,u=t.slowQueryFromCache,l=t.queryRequestId;return{isChartRendererReady:Boolean(n[e]),queryStatus:r[e],resultSetExists:a[e],isQueryLoading:Boolean(i[e]),queryError:o[e]||null,isBuildInProgress:Boolean(c[e]),slowQuery:Boolean(s[e]),slowQueryFromCache:Boolean(u[e]),queryRequestId:l[e]}}function Hr(){var e=Object(w.useContext)(Jr);return{setChartRendererReady:e.setChartRendererReady,setQueryStatus:e.setQueryStatus,setResultSetExists:e.setResultSetExists,setQueryLoading:e.setQueryLoading,setQueryError:e.setQueryError,setBuildInProgress:e.setBuildInProgress,setSlowQuery:e.setSlowQuery,setSlowQueryFromCache:e.setSlowQueryFromCache,setQueryRequestId:e.setQueryRequestId}}var Zr=V.a.Text,$r=E.d.div(Pr||(Pr=Object(k.a)(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n"]))),Xr=E.d.div(qr||(qr=Object(k.a)(["\n  visibility: ",";\n  min-height: 400px;\n\n  & > iframe {\n    width: 100%;\n    min-height: 400px;\n    border: none;\n  }\n"])),(function(e){return e.invisible?"hidden":"visible"})),ea=E.d.div(Rr||(Rr=Object(k.a)(["\n  position: absolute;\n  width: 100%;\n  bottom: -4em;\n  animation: fadeIn 0.3s;\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n\n    to {\n      opacity: 1;\n    }\n  }\n"]))),ta=E.d.div(Mr||(Mr=Object(k.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n"]))),na=E.d.div(Ir||(Ir=Object(k.a)(["\n  position: relative;\n  width: 100%;\n  text-align: center;\n"])));function ra(e){var t=e.queryId,n=e.areQueriesEqual,r=e.isFetchingMeta,a=e.iframeRef,i=e.framework,o=e.queryHasMissingMembers,c=e.onRunButtonClick,s=Object(w.useContext)(Jn).cubejsApi,u=Object(w.useState)("auto"),l=Object(N.a)(u,2),d=l[0],b=l[1];Object(H.l)(),Object(w.useEffect)((function(){if(null===a||void 0===a?void 0:a.current){var e=null===a||void 0===a?void 0:a.current,t=window.innerHeight-e.getBoundingClientRect().y-40;b("".concat(t,"px"))}}));var p=Wr(t),h=p.isChartRendererReady,f=p.isQueryLoading,j=p.resultSetExists,m=p.queryError,v=p.isBuildInProgress,O=p.slowQuery,y=p.slowQueryFromCache,g=Hr(),x=g.setResultSetExists,k=g.setChartRendererReady,C=g.setQueryError,S=Object(w.useRef)(null);Object(Yr.a)("cmd+enter",(function(){var e;null===(e=S.current)||void 0===e||e.click()})),Object(w.useEffect)((function(){return function(){k(t,!1)}}),[]),Object(w.useEffect)((function(){!n&&m&&C(t,null)}),[t,n,m]),Object(w.useEffect)((function(){x(t,!1)}),[i]);var E=o||f||v||!s,D=!h||v||Boolean(m)||o||E||!n||!j,T=O?"This query takes more than 5 seconds to execute. Please consider using pre-aggregations to improve its performance. ":y?"This query takes more than 5 seconds to execute. It was served from the cache because Cube.js wasn't able to renew it in less than 5 seconds. Please consider using pre-aggregations to improve its performance. ":"";return Object(_.jsxs)(_.Fragment,{children:[(O||y)&&Object(_.jsx)(A.a,{style:{marginBottom:24},message:T,type:"warning"}),m?Object(_.jsx)(Le,{error:m}):o?Object(_.jsx)("div",{children:"At least one of the query members is missing from your data schema. Please update your query or data schema."}):E?Object(_.jsx)($r,{children:Object(_.jsx)(ta,{children:Object(_.jsxs)(na,{children:[Object(_.jsx)(Te,{full:!1}),v&&Object(_.jsx)(ea,{children:Object(_.jsx)(Zr,{strong:!0,style:{fontSize:18},children:"Building pre-aggregations..."})})]})})}):n&&j?null:Object(_.jsx)($r,{children:Object(_.jsx)(ta,{children:Object(_.jsx)(ze,{"data-testid":"run-query-btn",ref:S,size:"large",type:"primary",loading:!h||r,icon:Object(_.jsx)(Vr.a,{}),onClick:c,children:"Run"})})}),Object(_.jsx)(Xr,{invisible:D,children:s?Object(_.jsx)("iframe",{id:"iframe-".concat(t),"data-testid":"chart-renderer",ref:a,style:{height:d},title:"Chart renderer",src:"/chart-renderers/".concat(i,"/index.html#queryId=").concat(t)}):null})]})}var aa=n(869),ia=n(878),oa=n(519),ca=n.n(oa),sa=n(122),ua=n(897);function la(e){var t=e.id,n=e.index;return Object(_.jsx)(sa.b,{draggableId:t,index:n,children:function(e){var n=e.draggableProps,r=e.dragHandleProps,a=e.innerRef;return Object(_.jsx)("div",Object(b.a)(Object(b.a)(Object(b.a)({ref:a},n),r),{},{style:Object(b.a)(Object(b.a)({},n.style),{},{border:"1px dashed var(--dark-05-color)",borderRadius:4,padding:"5px 12px",lineHeight:"22px"}),children:Object(_.jsxs)(V.a.Text,{ellipsis:!0,style:{maxWidth:"100%"},children:[Object(_.jsx)(ua.a,{style:{marginRight:8}}),t]})}))}})}function da(e){var t=e.pivotConfig,n=e.axis;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(V.a.Text,{strong:!0,style:{display:"flex",justifyContent:"center",padding:"8px 16px",background:"var(--light-5)",borderBottom:"1px solid var(--light-color)"},children:n}),Object(_.jsx)("div",{"data-testid":"pivot-popover-".concat(n),style:{padding:"8px"},children:Object(_.jsx)(sa.c,{droppableId:n,children:function(e){return Object(_.jsxs)("div",Object(b.a)(Object(b.a)({ref:e.innerRef},e.droppableProps),{},{style:{display:"grid",gridTemplateColumns:"minmax(0, 1fr)",gap:"8px",height:"100%",minHeight:"32px"},children:[t[n].map((function(e,t){return Object(_.jsx)(la,{id:e,index:t},e)})),e.placeholder]}))}})})]})}var ba=["source","destination"];function pa(e){var t=e.pivotConfig,n=e.onMove;return Object(_.jsx)(sa.a,{onDragEnd:function(e){var t=e.source,r=e.destination;Object(h.a)(e,ba);r&&n({sourceIndex:t.index,destinationIndex:r.index,sourceAxis:t.droppableId,destinationAxis:r.droppableId})},children:Object(_.jsxs)(tn.a,{children:[Object(_.jsx)(en.a,{span:12,style:{minWidth:160},children:Object(_.jsx)(da,{pivotConfig:t,axis:"x"})}),Object(_.jsx)(en.a,{span:12,style:{minWidth:160},children:Object(_.jsx)(da,{pivotConfig:t,axis:"y"})})]})})}var ha=n(253);function fa(e){var t=e.pivotConfig,n=e.onUpdate;return Object(_.jsx)(ha.a,{checked:t.fillMissingDates,onChange:function(){return n({fillMissingDates:!t.fillMissingDates})},children:"Fill Missing Dates"})}var ja=n(325);function ma(e){var t=e.id,n=e.index,r=e.order,a=void 0===r?"none":r,i=e.children,o=e.onOrderChange;return Object(_.jsx)(sa.b,{draggableId:t,index:n,children:function(e){var n=e.draggableProps,r=e.dragHandleProps,c=e.innerRef;return Object(_.jsxs)("div",Object(b.a)(Object(b.a)(Object(b.a)({"data-testid":"order-item",ref:c},n),r),{},{style:Object(b.a)({display:"flex",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center",marginBottom:8},n.style),children:[Object(_.jsx)(ua.a,{}),Object(_.jsx)(V.a.Text,{ellipsis:!0,style:{margin:"0 auto 0 8px",padding:"5px 0"},children:i}),Object(_.jsxs)(ja.a.Group,{onChange:function(e){return o(t,e.target.value)},defaultValue:a,size:"small",style:{marginLeft:"8px"},children:[Object(_.jsx)(ja.a.Button,{value:"asc",children:"ASC"}),Object(_.jsx)(ja.a.Button,{value:"desc",children:"DESC"}),Object(_.jsx)(ja.a.Button,{value:"none",children:"NONE"})]})]}))}})}function va(e){var t=e.orderMembers,n=e.onOrderChange,r=e.onReorder;return Object(_.jsx)(sa.a,{onDragEnd:function(e){var t=e.source,n=e.destination;r(t&&t.index,n&&n.index)},children:Object(_.jsx)(sa.c,{droppableId:"droppable",children:function(e){return Object(_.jsxs)("div",Object(b.a)(Object(b.a)({"data-testid":"order-popover",ref:e.innerRef},e.droppableProps),{},{children:[t.map((function(e,t){var r=e.id,a=e.title,i=e.order;return Object(_.jsx)(ma,{id:r,index:t,order:i,onOrderChange:n,children:a},r)})),e.placeholder]}))}})})}function Oa(e){var t=e.pivotConfig,n=e.orderMembers,r=e.limit,a=e.disabled,i=e.onMove,o=e.onUpdate,c=e.onReorder,s=e.onOrderChange,u=e.isQueryPresent,l=Object(w.useState)(r),d=Object(N.a)(l,2),b=d[0],p=d[1],h=Object(w.useState)(!1),f=Object(N.a)(h,2),j=f[0],m=f[1];return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(ca.a,{style:{lineHeight:"32px"},children:"Settings:"}),Object(_.jsx)(Ke,{content:null===t?Object(_.jsx)(xt.a,{}):Object(_.jsxs)("div",{"data-testid":"pivot-popover",children:[Object(_.jsx)(pa,{pivotConfig:t,onMove:i}),Object(_.jsx)(aa.a,{style:{margin:0}}),Object(_.jsx)("div",{style:{padding:"8px"},children:Object(_.jsx)(fa,{pivotConfig:t,onUpdate:o})})]}),placement:"bottomLeft",trigger:"click",children:Object(_.jsx)(ze,{"data-testid":"pivot-btn",disabled:!u||a,style:{border:0},children:"Pivot"})}),Object(_.jsx)(Ke,{content:Object(_.jsx)("div",{style:{padding:"8px",paddingBottom:1},children:Object(_.jsx)(va,{orderMembers:n,onReorder:c,onOrderChange:s})}),placement:"bottomLeft",trigger:"click",children:Object(_.jsx)(ze,{"data-testid":"order-btn",disabled:!u||a,style:{border:0},children:"Order"})}),Object(_.jsx)(Ke,{visible:j,content:Object(_.jsx)("div",{style:{padding:"8px"},children:Object(_.jsxs)("label",{children:["Limit"," ",Object(_.jsx)(ia.a,{prefix:"Limit",type:"number",value:b,step:500,onChange:p,onPressEnter:function(){o({limit:b}),m(!1)}})]})}),placement:"bottomLeft",trigger:"click",onVisibleChange:function(e){m(e),e||o({limit:b})},children:Object(_.jsx)(ze,{"data-testid":"limit-btn",disabled:!u||a,style:{border:0},children:"Limit"})})]})}var ya,ga,xa,ka=n(321),wa=n.n(ka),Ca=["overlay","disabled"],Sa=function(e){var t=e.overlay,n=e.disabled,r=void 0!==n&&n,a=Object(h.a)(e,Ca);return Object(_.jsx)(R.a,{disabled:r,overlay:t,placement:"bottomLeft",trigger:["click"],children:Object(_.jsx)(ze,Object(b.a)(Object(b.a)({},a),{},{disabled:r}))})},Aa=n(112),Ea=["availableCubes","showNoMembersPlaceholder","onClick"],Da=Object(E.d)(M.a)(ya||(ya=Object(k.a)(["\n  max-height: 320px;\n  overflow: hidden auto;\n  padding-top: 0;\n\n  li.ant-dropdown-menu-item-active {\n    background: #f3f3fb;\n  }\n"]))),Ta=Object(E.d)(Da.Item)(ga||(ga=Object(k.a)(["\n  position: sticky;\n  top: 0;\n  // this isn't the best solution ever, but according to the situation other solutions are worse\n  // antd uses double class pattern (.disabled.active.active) to override the value of background color. actually the\n  // easiest way to override it is to use smtn with higher specificity\n  background: white !important;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  margin-bottom: 8px;\n  cursor: default;\n\n  ::after {\n    display: block;\n    position: absolute;\n    content: '';\n    width: 100%;\n    left: 0;\n    bottom: -20px;\n    height: 20px;\n    background: linear-gradient(\n      to bottom,\n      rgba(255, 255, 255, 1),\n      rgba(255, 255, 255, 0)\n    );\n  }\n"])));function Pa(e){var t=e.isVisible;return void 0===t||t}function qa(e){var t=e.availableCubes,n=e.showNoMembersPlaceholder,r=void 0===n||n,a=e.onClick,i=Object(h.a)(e,Ea),o=Object(w.useRef)(null),c=Object(w.useRef)(new wa.a.Index({tokenize:"forward"})).current,s=Object(w.useState)(""),u=Object(N.a)(s,2),l=u[0],f=u[1],j=Object(w.useState)([]),m=Object(N.a)(j,2),v=m[0],O=m[1],y=t.some((function(e){return e.members.filter(Pa).length>0})),g=Object(Aa.a)((function(){return Object(kt.b)(t).forEach((function(e){var t=Object(N.a)(e,2),n=t[0],r=t[1].title;return c.add(n,r)})),Object.fromEntries(Object(kt.b)(t))}),[t]);Object(w.useEffect)((function(){var e=l;return Object(p.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.search(l);case 2:if(n=t.sent,e===l){t.next=5;break}return t.abrupt("return");case 5:O(n);case 6:case"end":return t.stop()}}),t)})))(),function(){e=""}}),[c,l]);var x=l?function(e,t){var n=t.map((function(e){return e.split(".")[0]}));return e.filter((function(e){var t=e.cubeName;return n.includes(t)})).map((function(e){return Object(b.a)(Object(b.a)({},e),{},{members:e.members.filter((function(e){var n=e.name;return t.includes(n)}))})}))}(t,v):t;return Object(_.jsx)(Sa,Object(b.a)(Object(b.a)({},i),{},{onClick:function(){setTimeout((function(){var e;null===(e=o.current)||void 0===e||e.focus({preventScroll:!0})}))},overlay:Object(_.jsx)(Da,{onKeyDown:function(e){var t,n;["ArrowDown","ArrowUp","ArrowLeft","ArrowRight","Enter","Escape","Tab","CapsLock"].includes(e.key)||document.activeElement!==(null===(t=o.current)||void 0===t?void 0:t.input)&&(null===(n=o.current)||void 0===n||n.focus({preventScroll:!0}))},onClick:function(e){["__not-found__","__search_field__"].includes(e.key)||(f(""),O([]),a(g[e.key]))},children:y?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Ta,{disabled:!0,children:Object(_.jsx)(ee.a,{ref:o,placeholder:"Search",autoFocus:!0,allowClear:!0,onKeyDown:function(e){["ArrowDown","ArrowUp","Enter"].includes(e.key)&&e.preventDefault(),["ArrowLeft","ArrowRight"].includes(e.key)&&e.stopPropagation()},onChange:function(e){f(e.target.value)}})},"__search_field__"),x.map((function(e){var t=e.members.filter(Pa);return t.length?Object(_.jsx)(Da.ItemGroup,{title:e.cubeTitle,children:t.map((function(e){return Object(_.jsx)(Da.Item,{"data-testid":e.name,children:e.shortTitle},e.name)}))},e.cubeName):null}))]}):r?Object(_.jsx)(Da.Item,{disabled:!0,children:"No members found"},"__not-found__"):null})}))}var Ra=["onRemoveClick","children"];function Ma(e){return null==e.color?"primary":{primary:"primary",danger:"pink"}[e.color]}var Ia=Object(E.d)((function(e){var t=e.onRemoveClick,n=e.children,r=Object(h.a)(e,Ra);return Object(_.jsxs)(ze.Group,Object(b.a)(Object(b.a)({},r),{},{children:[n,Object(_.jsx)(ze,{ghost:!0,className:"remove-btn",disabled:r.disabled,onClick:t,children:Object(_.jsx)(vr.a,{})})]}))}))(xa||(xa=Object(k.a)(["\n  && {\n    border-radius: calc(var(--border-radius-base) + 1px);\n\n    .ant-btn {\n      border: none;\n\n      & + .ant-btn {\n        margin-left: 0;\n      }\n    }\n\n    .remove-btn {\n      padding: 8px;\n\n      .anticon {\n        height: 14px;\n        display: block;\n      }\n    }\n  }\n\n  &&:not(.disabled) {\n    border: 1px solid var(--","-color);\n    color: var(--","-color);\n\n    .ant-btn {\n      background-color: var(--","-9);\n      color: var(--","-color);\n\n      span {\n        color: var(--","-color);\n      }\n\n      &:hover {\n        background-color: var(--","-8);\n        border: none;\n        box-shadow: none;\n      }\n    }\n\n    .remove-btn {\n      background-color: white !important;\n      color: var(--","-color);\n\n      &:hover {\n        background-color: var(--","-8) !important;\n      }\n    }\n  }\n\n  &&.disabled {\n    border: 1px solid var(--disabled-color);\n    color: var(--disabled-color);\n\n    .ant-btn {\n      background-color: var(--disabled-bg);\n      color: var(--disabled-color);\n      border: none;\n\n      span {\n        color: var(--disabled-color);\n      }\n    }\n\n    .remove-btn {\n      color: var(--disabled-color);\n    }\n  }\n"])),Ma,Ma,Ma,Ma,Ma,Ma,Ma,Ma),La=n(520),_a={string:function(e){var t=e.values,n=void 0===t?[]:t,r=e.disabled,a=e.onChange;return Object(_.jsx)(Lt,{disabled:r,style:{width:300},mode:"tags",value:n,maxTagCount:"responsive",onChange:a},"input")},number:function(e){var t=e.values,n=void 0===t?[]:t,r=e.disabled,a=e.onChange;return Object(_.jsx)(ee.a,{disabled:r,style:{width:300},onChange:function(e){return a([e.target.value])},value:(null===n||void 0===n?void 0:n[0])||""},"input")}};function za(e){var t=e.member,n=e.disabled,r=void 0!==n&&n,a=e.updateMethods,i=_a[t.dimension.type]||_a.string,o=Object(w.useRef)(Object(La.a)(500,(function(e,t){a.update(e,Object(b.a)(Object(b.a)({},e),{},{values:t}))}))),c=Object(w.useState)(t.values),s=Object(N.a)(c,2),u=s[0],l=s[1];return Object(_.jsx)(i,{disabled:r,values:u,onChange:function(e){l(e),o.current(t,e)}},"filter")}var Ba=n(106);function Fa(e){var t=e.children;return Object(_.jsx)(Ba.a,{overlayClassName:"missing-member-tooltip",placement:"top",title:"This member was removed from the data schema",color:"var(--dark-01-color)",children:t})}var Qa=function(e){var t=e.disabled,n=void 0!==t&&t,r=e.members,a=e.availableMembers,i=e.addMemberName,o=e.updateMethods,c=e.missingMembers;return Object(_.jsxs)(Mt,{children:[r.map((function(e){var t=c.includes(e.member),r=Object(_.jsx)(Ia,{disabled:n,className:n?"disabled":null,color:t?"danger":"primary",onRemoveClick:function(){return o.remove(e)},children:Object(_.jsx)(qa,{disabled:n,availableCubes:a,style:{minWidth:150},onClick:function(t){return o.update(e,Object(b.a)(Object(b.a)({},e),{},{dimension:t}))},children:e.dimension.title})});return Object(_.jsxs)(w.Fragment,{children:[t?Object(_.jsx)(Fa,{children:r}):r,Object(_.jsx)(Lt,{disabled:n,value:e.operator,style:{width:200},onChange:function(t){return o.update(e,Object(b.a)(Object(b.a)({},e),{},{operator:t}))},children:e.operators.map((function(e){return Object(_.jsx)(Lt.Option,{value:e.name,children:e.title},e.name)}))}),Object(_.jsx)(za,{disabled:n,member:e,updateMethods:o},"filterInput")]},e.member)})),Object(_.jsx)(qa,{availableCubes:a,type:"dashed",disabled:n,icon:Object(_.jsx)(nn.a,{}),onClick:function(e){return o.add({member:e})},children:r.length?null:i})]})};function Na(e){var t=e.disabled,n=void 0!==t&&t,r=e.members,a=e.availableMembers,i=e.missingMembers,o=e.addMemberName,c=e.updateMethods,s=Object(w.useCallback)((function(e){return c.add(e)}),[]);return Object(_.jsxs)(Mt,{children:[r.map((function(e){var t=i.includes(e.title),r=Object(_.jsx)(Ia,{disabled:n,className:n?"disabled":null,color:t?"danger":"primary",onRemoveClick:function(){return c.remove(e)},children:Object(_.jsx)(qa,{disabled:n,availableCubes:a,onClick:function(t){return c.update(e,t)},children:e.title})},e.index||e.name);return t?Object(_.jsx)(Fa,{children:r},e.index||e.name):r})),Object(_.jsx)(qa,{"data-testid":o,disabled:n,availableCubes:a,type:"dashed",icon:Object(_.jsx)(nn.a,{}),onClick:s,children:r.length?null:o})]})}var Ua,Ka=n(898),Va=n(899),Ya=n(900),Ja=n(901),Ga=n(902),Wa=n(221),Ha=[{name:"line",title:"Line",icon:Object(_.jsx)(Ka.a,{})},{name:"area",title:"Area",icon:Object(_.jsx)(Va.a,{})},{name:"bar",title:"Bar",icon:Object(_.jsx)(Ya.a,{})},{name:"pie",title:"Pie",icon:Object(_.jsx)(Ja.a,{})},{name:"table",title:"Table",icon:Object(_.jsx)(Ga.a,{})},{name:"number",title:"Number",icon:Object(_.jsx)(Wa.a,{})}],Za=function(e){var t=e.chartType,n=e.updateChartType,r=Object(_.jsx)(M.a,{"data-testid":"chart-type-dropdown",children:Ha.map((function(e){return Object(_.jsxs)(M.a.Item,{onClick:function(){return n(e.name)},children:[e.icon," ",e.title]},e.title)}))}),a=Ha.find((function(e){return e.name===t}));return Object(_.jsx)(Sa,{"data-testid":"chart-type-btn",overlay:r,icon:null===a||void 0===a?void 0:a.icon,style:{border:0},children:(null===a||void 0===a?void 0:a.title)||""})},$a=n(871),Xa=n(136),ei=n.n(Xa),ti=E.d.div(Ua||(Ua=Object(k.a)(["\n  color: var(--dark-04-color);\n  line-height: 32px;\n"]))),ni=$a.a.RangePicker,ri=[{title:"Custom",value:"custom"},{title:"All time",value:void 0},{value:"Today"},{value:"Yesterday"},{value:"This week"},{value:"This month"},{value:"This quarter"},{value:"This year"},{value:"Last 7 days"},{value:"Last 30 days"},{value:"Last week"},{value:"Last month"},{value:"Last quarter"},{value:"Last year"}],ai=function(e){var t,n=e.members,r=void 0===n?[]:n,a=e.disabled,i=void 0!==a&&a,o=e.availableMembers,c=e.missingMembers,s=e.addMemberName,u=e.updateMethods,l=e.parsedDateRange,d=Array.isArray(null===(t=r[0])||void 0===t?void 0:t.dateRange),p=Object(w.useState)(!1),h=Object(N.a)(p,2),f=h[0],j=h[1];return Object(_.jsxs)(Mt,{children:[r.map((function(e,t){var n,r,a,s=c.includes(e.dimension.title),p=Object(_.jsx)(Ia,{disabled:i,className:i?"disabled":null,color:s?"danger":"primary",onRemoveClick:function(){return u.remove(e)},children:Object(_.jsx)(qa,{"data-testid":"TimeDimension",disabled:i,availableCubes:o,onClick:function(t){return u.update(e,Object(b.a)(Object(b.a)({},e),{},{dimension:t}))},children:e.dimension.title})});return Object(_.jsxs)(w.Fragment,{children:[s?Object(_.jsx)(Fa,{children:p}):p,Object(_.jsx)(ti,{children:"for"}),Object(_.jsx)(Sa,{disabled:i,overlay:(a=function(t){"custom"===t.value?j(!0):(u.update(e,Object(b.a)(Object(b.a)({},e),{},{dateRange:t.value})),j(!1))},Object(_.jsx)(M.a,{children:ri.map((function(e){return Object(_.jsx)(M.a.Item,{onClick:function(){return a(e)},children:e.title||e.value},e.title||e.value)}))})),children:f||d?"Custom":e.dateRange||"All time"}),f||d?Object(_.jsx)(ni,{disabled:i,format:"YYYY-MM-DD",defaultValue:(l||[]).map((function(e){return ei()(e)})),onChange:function(t){return function(e,t){t&&!t.some((function(e){return!e}))&&u.update(e,Object(b.a)(Object(b.a)({},e),{},{dateRange:t.map((function(e){return e.format("YYYY-MM-DD")}))}))}(e,t)}}):null,Object(_.jsx)(ti,{children:"by"}),Object(_.jsx)(Sa,{disabled:i,overlay:(n=e.dimension,r=function(t){return u.update(e,Object(b.a)(Object(b.a)({},e),{},{granularity:t.name}))},Object(_.jsx)(M.a,{children:n.granularities.length?n.granularities.map((function(e){return Object(_.jsx)(M.a.Item,{onClick:function(){return r(e)},children:e.title},e.title)})):Object(_.jsx)(M.a.Item,{disabled:!0,children:"No members found"})})),children:e.dimension.granularities.find((function(t){return t.name===e.granularity}))&&e.dimension.granularities.find((function(t){return t.name===e.granularity})).title})]},t)})),!r.length&&Object(_.jsx)(qa,{"data-testid":"TimeDimension",disabled:i,availableCubes:o,type:"dashed",icon:Object(_.jsx)(nn.a,{}),onClick:function(e){return u.add({dimension:e,granularity:"day"})},children:s})]})},ii=n(904),oi=n(50),ci=n(528),si=n(888),ui=n(257),li=n(880),di=n(160),bi=n.n(di),pi=Object(w.createContext)({});var hi,fi,ji=n(329);var mi=M.a.SubMenu,vi=Object(E.d)(M.a)(hi||(hi=Object(k.a)(["\n  position: relative;\n  max-height: 600px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n\n  li {\n    font-size: var(--font-size-base);\n  }\n\n  .ant-menu-sub.ant-menu-inline {\n    background: white;\n  }\n\n  & li > div.ant-menu-submenu-title {\n    font-weight: 500;\n    color: var(--menu-highlight-color);\n  }\n\n  & li.ant-menu-item-group {\n    & > div {\n      text-transform: uppercase;\n      font-size: 10px;\n    }\n\n    & ul > li {\n      padding-left: 12px !important;\n    }\n  }\n\n  .ant-menu-item-group-list > li {\n    margin: 0 !important;\n\n    &::after {\n      display: none;\n    }\n  }\n\n  .ant-menu-item-selected,\n  .ant-menu-item-active:not(.ant-menu-item-selected) {\n    background: var(--primary-9) !important;\n    color: var(--primary-color);\n  }\n\n  .ant-menu-item-selected.ant-menu-item-active {\n    background: var(--primary-8) !important;\n  }\n\n  .ant-menu-submenu-arrow {\n    left: 10px;\n    right: initial;\n  }\n"]))),Oi=E.d.div(fi||(fi=Object(k.a)(["\n  position: relative;\n  border-right: 1px solid rgba(0, 0, 0, 0.06);\n  padding: 16px 12px 10px 12px;\n\n  ::after {\n    z-index: 1;\n    display: block;\n    position: absolute;\n    content: '';\n    width: 100%;\n    left: 0;\n    bottom: -20px;\n    height: 20px;\n    background: linear-gradient(\n      to bottom,\n      rgba(255, 255, 255, 1),\n      rgba(255, 255, 255, 0)\n    );\n  }\n"]))),yi=["measures","dimensions","segments","timeDimensions"];function gi(e){var t=e.memberTypeCubeMap,n=e.openKeys,r=e.selectedKeys,a=e.firstOpenCubeName,i=e.onSelect,o=e.onOpenKeysChange,c=Object(Aa.a)((function(){return Object(kt.a)(t).map((function(e){return e.cubeName}))}),[t]),s=function(e){var t=Object(w.useRef)(new wa.a.Index({tokenize:"forward"})).current,n=Object(w.useState)([]),r=Object(N.a)(n,2),a=r[0],i=r[1],o=Object(w.useState)(""),c=Object(N.a)(o,2),s=c[0],u=c[1];return Object(H.c)((function(){Object(kt.b)([].concat(Object(oi.a)(e.measures),Object(oi.a)(e.dimensions),Object(oi.a)(e.timeDimensions),Object(oi.a)(e.segments))).forEach((function(e){var n=Object(N.a)(e,2),r=n[0],a=n[1].title;return t.add(r,a)}))}),[e]),Object(w.useEffect)((function(){var e=s;return Object(p.a)(d.a.mark((function n(){var r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.search(s);case 2:if(r=n.sent,e===s){n.next=5;break}return n.abrupt("return");case 5:i(r);case 6:case"end":return n.stop()}}),n)})))(),function(){e=""}}),[t,s]),{keys:a,search:s,inputProps:{value:s,onChange:function(e){u(e.target.value)}}}}(t),u=s.keys,l=s.search,h=s.inputProps,f=l?function(e,t){return e.map((function(e){var n=yi.map((function(n){return[n,(e[n]||[]).filter((function(e){var n=e.name;return t.includes(n)}))]}));return!!n.some((function(e){return Object(N.a)(e,2)[1].length}))&&Object(b.a)(Object(b.a)({},e),Object.fromEntries(n))})).filter(Boolean)}(Object(kt.a)(t),u):Object(kt.a)(t);return Object(w.useLayoutEffect)((function(){a&&setTimeout((function(){var e,t;null===(e=document.querySelector('[data-menu="cubes"]'))||void 0===e||e.scroll({top:null===(t=document.querySelector('[data-cube="'.concat(a,'"]')))||void 0===t?void 0:t.offsetTop,behavior:"smooth"})}),100)}),[a]),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Oi,{children:Object(_.jsx)(ee.a,Object(b.a)(Object(b.a)({},h),{},{allowClear:!0,autoFocus:!0,suffix:l?null:Object(_.jsx)(ji.a,{})}))}),Object(_.jsx)(vi,{"data-menu":"cubes",selectedKeys:r,openKeys:l?c:n,mode:"inline",onClick:function(e){var t=e.domEvent.currentTarget.dataset.membertype;i(t,e.key.toString().replace("td:",""))},children:f.map((function(e){return Object(_.jsx)(mi,{"data-cube":e.cubeName,title:e.cubeTitle,onTitleClick:function(e){var t=e.key;n.includes(t)?o(n.filter((function(e){return e!==t}))):o([].concat(Object(oi.a)(n),[t]))},children:yi.map((function(t){return e[t].length?Object(_.jsx)(M.a.ItemGroup,{title:"timeDimensions"===t?"time dimensions":t,children:e[t].map((function(e){var n="timeDimensions"===t?"td:".concat(e.name):e.name;return Object(_.jsxs)(M.a.Item,{"data-membertype":t,children:[Object(_.jsx)(mr.a,{style:{visibility:r.includes(n)?"visible":"hidden"}}),e.shortTitle]},n)}))},t):null}))},e.cubeName)}))})]})}var xi,ki,wi=n(526),Ci=["name","cubeName"],Si=Object(E.d)(wi.a)(xi||(xi=Object(k.a)(["\n  background-color: var(--primary-9);\n  color: var(--primary-color);\n  padding: 6px 10px;\n  font-size: var(--font-size-base);\n  border: none;\n\n  .ant-tag-close-icon {\n    color: var(--primary-color);\n    padding-left: 6px;\n  }\n\n  b {\n    font-weight: 600;\n  }\n"])));function Ai(e){var t=e.name,n=e.cubeName,r=Object(h.a)(e,Ci);return Object(_.jsxs)(Si,Object(b.a)(Object(b.a)({"data-testid":"member-tag-".concat(n,".").concat(t),closable:!0,visible:!0},r),{},{children:[n," ",Object(_.jsx)("b",{children:t})]}))}var Ei=Object(E.d)(V.a.Paragraph)(ki||(ki=Object(k.a)(["\n  font-size: 10px;\n  text-transform: uppercase;\n  color: rgba(20, 20, 70, 0.5);\n"])));function Di(e){var t=e.title,n=e.members,r=e.onRemove;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Ei,{children:t}),Object(_.jsx)(ae.b,{wrap:!0,children:n.map((function(e){return e?Object(_.jsx)(Ai,{name:e.shortTitle,cubeName:e.title.replace(e.shortTitle,"").trim(),onClose:function(){return r(e.name)}}):(console.warn("Rollup Designer received 'undefined' member as ".concat(t)),null)}))})]})}var Ti=n(903),Pi=n(397),qi=["Africa/Abidjan","Africa/Accra","Africa/Algiers","Africa/Bissau","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/El_Aaiun","Africa/Johannesburg","Africa/Juba","Africa/Khartoum","Africa/Lagos","Africa/Maputo","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Araguaina","America/Argentina/Buenos_Aires","America/Argentina/Catamarca","America/Argentina/Cordoba","America/Argentina/Jujuy","America/Argentina/La_Rioja","America/Argentina/Mendoza","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Asuncion","America/Atikokan","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Cayenne","America/Chicago","America/Chihuahua","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Inuvik","America/Iqaluit","America/Jamaica","America/Juneau","America/Kentucky/Louisville","America/Kentucky/Monticello","America/La_Paz","America/Lima","America/Los_Angeles","America/Maceio","America/Managua","America/Manaus","America/Martinique","America/Matamoros","America/Mazatlan","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Punta_Arenas","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Sitka","America/St_Johns","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/Palmer","Antarctica/Rothera","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Baku","Asia/Bangkok","Asia/Barnaul","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Chita","Asia/Choibalsan","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Hebron","Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Kathmandu","Asia/Khandyga","Asia/Kolkata","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qostanay","Asia/Qyzylorda","Asia/Riyadh","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Ust-Nera","Asia/Vladivostok","Asia/Yakutsk","Asia/Yangon","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Astrakhan","Europe/Athens","Europe/Belgrade","Europe/Berlin","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Helsinki","Europe/Istanbul","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Lisbon","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/Saratov","Europe/Simferopol","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Ulyanovsk","Europe/Uzhgorod","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zaporozhye","Europe/Zurich","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Reunion","Pacific/Apia","Pacific/Auckland","Pacific/Bougainville","Pacific/Chatham","Pacific/Chuuk","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Pohnpei","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Wake","Pacific/Wallis","UTC"],Ri=n(523),Mi=["timeDimensions"];function Ii(e,t){var n,r,a={measures:[],dimensions:[],segments:[],timeDimensions:[]};if(!e)return a;if(e.leafMeasures.length&&(a.measures=Object(oi.a)(e.leafMeasures)),e.sortedDimensions.length&&(a.dimensions=Object(oi.a)(e.sortedDimensions.filter((function(e){return!t.has(e)}))),a.segments=Object(oi.a)(e.sortedDimensions.filter((function(e){return t.has(e)})))),null===(n=e.sortedTimeDimensions)||void 0===n||null===(r=n[0])||void 0===r?void 0:r[0]){var i=Object(N.a)(e.sortedTimeDimensions[0],2),o=i[0],c=i[1];a.timeDimensions=[{dimension:o,granularity:c||"day"}]}return a}function Li(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=Object(N.a)(n[t],2)[1];if(Array.isArray(r)&&r.length>0)return!1}return!0}function _i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main",n=arguments.length>2?arguments[2]:void 0,r=e.timeDimensions,a=Object(h.a)(e,Mi),i=Object(b.a)(Object(b.a)({},Object.entries(a).reduce((function(e,t){var n=Object(N.a)(t,2),r=n[0],a=n[1];return Object(b.a)(Object(b.a)({},e),Array.isArray(a)&&a.length?Object(Xt.a)({},r,a):null)}),{})),n);if(r.length){var o=e.timeDimensions[0],c=o.dimension,s=o.granularity;i.timeDimension=c,s&&(i.granularity="`".concat(s,"`"))}var u=JSON.stringify(i,null,2).replaceAll('"',"");return{code:"".concat(Object(Ri.a)(t),": ").concat(u),value:u}}function zi(e){var t;return"function"===typeof(null===e||void 0===e||null===(t=e.constructor)||void 0===t?void 0:t.isBuffer)&&e.constructor.isBuffer(e)}function Bi(e){return e}function Fi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.delimiter||".",r=t.maxDepth||100,a=t.transformKey||Bi,i={};function o(e){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object.keys(e).forEach((function(u){var l=e[u],d=t.safe&&Array.isArray(l),b=Object.prototype.toString.call(l),p=zi(l),h="[object Object]"===b||"[object Array]"===b,f=c?c+n+a(u):a(u);if(!d&&!p&&h&&Object.keys(l).length&&(!t.maxDepth||s<r))return o(l,f,s+1);i[f]=l}))}return o(e),i}var Qi,Ni=["excludedGranularities"],Ui=E.d.div(Qi||(Qi=Object(k.a)(["\n  display: flex;\n  gap: 32px;\n  flex-direction: column;\n  padding: 24px;\n"]))),Ki=Rn.a.filter((function(e){var t=e.name;return!["second","minute"].includes(t||"")})).map((function(e){return e.name?e:Object(b.a)(Object(b.a)({},e),{},{title:"No partition"})}));function Vi(e){var t=e.members,n=e.hasTimeDimension,r=e.onCronExpressionValidityChange,a=e.onChange,i=X.a.useForm(),o=Object(N.a)(i,1)[0],c={refreshKey:{checked:{every:!0,sql:!1},isCron:!1,sql:"",value:1,granularity:"hour",cron:"",timeZone:void 0},partitionGranularity:"",updateWindow:{value:7,granularity:"day"},incrementalRefresh:!0,buildRange:{since:{option:"relative",fixedDate:void 0,number:1,granularity:"year",time:"ago"},until:{option:"relative",fixedDate:void 0,number:1,granularity:"year",time:"from now"}},automatedRefresh:!0},s=Object(w.useMemo)((function(){var e=Fi(c);return a(e),e}),[]),u=Object(w.useState)(s),l=Object(N.a)(u,2),d=l[0],p=l[1],h=Object(w.useState)(!1),f=Object(N.a)(h,2),j=f[0],m=f[1];return Object(w.useEffect)((function(){a(Object(b.a)(Object(b.a)({},d),{},{"refreshKey.isCron":j})),j||Object(Pi.isValidCron)(d["refreshKey.cron"])||o.setFields([{name:"refreshKey.cron",value:"",errors:[]}])}),[j]),Object(_.jsx)(X.a,{form:o,validateTrigger:"onBlur",initialValues:Fi(c),onValuesChange:function(e){p((function(t){return a(Object(b.a)(Object(b.a)(Object(b.a)({},t),e),{},{"refreshKey.isCron":j})),Object.keys(e).forEach((function(e){o.getFieldError(e).length&&o.setFields([{name:e,errors:[]}])})),Object(b.a)(Object(b.a)({},t),e)}))},children:Object(_.jsxs)(Ui,{children:[Object(_.jsxs)(K.a,{children:[Object(_.jsx)(Ji,{title:"Refresh Key",children:"Specify how often to refresh your pre-aggregated data"}),Object(_.jsx)(V.a.Paragraph,{children:"If you do not specify any Refresh Key, refreshes will still default to every 1 hour."}),Object(_.jsxs)(tn.a,{gutter:8,wrap:!1,align:"top",children:[Object(_.jsx)(en.a,{flex:"85px",children:Object(_.jsx)(X.a.Item,{name:"refreshKey.checked.every",valuePropName:"checked",children:Object(_.jsx)(ha.a,{children:"Every"})})}),Object(_.jsx)(en.a,{flex:"auto",children:Object(_.jsxs)(J,{direction:"column",gap:2,children:[Object(_.jsxs)(ae.b,{children:[Object(_.jsx)(ja.a,{checked:!j,disabled:!d["refreshKey.checked.every"],onClick:function(){return m(!1)}}),Object(_.jsx)(X.a.Item,{name:"refreshKey.value",noStyle:!0,children:Object(_.jsx)(ee.a,{"data-testid":"rd-input-every",disabled:!d["refreshKey.checked.every"]||j,type:"number",min:0,style:{maxWidth:80}})}),Object(_.jsx)(X.a.Item,{name:"refreshKey.granularity",noStyle:!0,children:Object(_.jsx)(Yi,{"data-testid":"rd-select-every-granularity",disabled:!d["refreshKey.checked.every"]||j,excludedGranularities:["year","quarter","month"]})})]}),Object(_.jsxs)(ae.b,{align:"start",style:{marginBottom:32},children:[Object(_.jsx)(ja.a,{disabled:!d["refreshKey.checked.every"],checked:j,style:{paddingTop:5},onClick:function(){return m(!0)}}),Object(_.jsxs)(J,{direction:"column",gap:1,children:[Object(_.jsx)(X.a.Item,{name:"refreshKey.cron",rules:[{validator:function(e,t,n){t&&!Object(Pi.isValidCron)(t,{seconds:!0})?(r(!1),n("Cron expression is invalid")):r(!0)}}],children:Object(_.jsx)(ee.a,{allowClear:!0,placeholder:"Cron expression e.g. 30 5 * * 5",disabled:!d["refreshKey.checked.every"]||!j})}),j&&d["refreshKey.checked.every"]?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(V.a.Paragraph,{children:Object(_.jsx)(V.a.Link,{target:"_blank",href:"https://cube.dev/docs/schema/reference/cube#supported-cron-formats",children:"See how to format your cron expression"})}),Object(_.jsx)(V.a.Paragraph,{strong:!0,children:"Time Zone"}),Object(_.jsx)(X.a.Item,{name:"refreshKey.timeZone",noStyle:!0,children:Object(_.jsx)(It.a,{showSearch:!0,style:{maxWidth:200},placeholder:"Select Time Zone",children:qi.map((function(e){return Object(_.jsx)(It.a.Option,{value:e||"",children:e},e)}))})})]}):null]})]})]})})]}),Object(_.jsxs)(tn.a,{gutter:8,children:[Object(_.jsx)(en.a,{flex:"85px",children:Object(_.jsx)(X.a.Item,{name:"refreshKey.checked.sql",valuePropName:"checked",noStyle:!0,children:Object(_.jsx)(ha.a,{children:"SQL"})})}),Object(_.jsx)(en.a,{flex:"auto",children:Object(_.jsx)(X.a.Item,{name:"refreshKey.sql",noStyle:!0,children:Object(_.jsx)(ee.a.TextArea,{disabled:!d["refreshKey.checked.sql"],placeholder:"SELECT MAX(createdAt) FROM orders"})})})]})]}),Object(_.jsxs)(K.a,{children:[n?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Ji,{title:"Partition Granularity",children:"Partitions are shards of the pre-aggregation dataset. To enable partitions, you must specify here the desired granularity."}),Object(_.jsx)(X.a.Item,{name:"partitionGranularity",children:Object(_.jsx)(It.a,{showSearch:!0,style:{maxWidth:150},children:Ki.map((function(e){var t=e.name,n=e.title;return Object(_.jsx)(It.a.Option,{value:t||"",children:n},t)}))})}),d.partitionGranularity?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(X.a.Item,{name:"incrementalRefresh",valuePropName:"checked",children:Object(_.jsx)(ha.a,{children:"Incremental Refresh"})}),d.incrementalRefresh&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Ji,{title:"Update Window",children:"Any partition which includes this span of time into the past from now will be refreshed according to the Refresh Key set above. Otherwise, if left unset, only the most recent partition will be refreshed regularly."}),Object(_.jsxs)(ae.b,{align:"start",children:[Object(_.jsx)(X.a.Item,{name:"updateWindow.value",children:Object(_.jsx)(ee.a,{type:"number",min:0,style:{maxWidth:80}})}),Object(_.jsx)(X.a.Item,{name:"updateWindow.granularity",children:Object(_.jsx)(Yi,{excludedGranularities:["second"]})})]})]})]}):null]}):null,Object(_.jsx)(V.a.Paragraph,{strong:!0,children:"Indexes"}),Object(_.jsx)(X.a.Item,{name:"indexes",noStyle:!0,children:Object(_.jsx)(It.a,{mode:"tags",style:{width:"100%"},placeholder:"(list column names)",children:t.map((function(e){return Object(_.jsx)(It.a.Option,{value:e,children:e},e)}))})})]})]})})}function Yi(e){var t=e.excludedGranularities,n=void 0===t?[]:t,r=Object(h.a)(e,Ni);return Object(_.jsx)(It.a,Object(b.a)(Object(b.a)({style:{minWidth:100},showSearch:!0},r),{},{children:Rn.a.filter((function(e){var t=e.name;return null!=t&&!n.includes(t)})).map((function(e){var t=e.name,n=e.title;return Object(_.jsx)(It.a.Option,{value:t,children:n},t)}))}))}function Ji(e){var t=e.title,n=e.children;return Object(_.jsxs)(ae.b,{align:"baseline",style:{display:"flex"},children:[Object(_.jsx)(V.a.Paragraph,{strong:!0,children:t}),Object(_.jsx)(Ba.a,{title:n,children:Object(_.jsx)(Ti.a,{style:{color:"#1414464D"}})})]})}function Gi(e){var t=e.member,n=e.granularity,r=void 0===n?"day":n,a=e.onGranularityChange,i=e.onRemove;return t?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Ei,{children:"Time dimension"}),Object(_.jsxs)(ae.b,{children:[Object(_.jsx)(Ai,{name:t.shortTitle,cubeName:t.title.replace(t.shortTitle,""),onClose:function(){return i(t.name)}}),Object(_.jsx)(Yi,{value:r,onChange:a})]})]}):(console.warn("Rollup Designer received `undefined` member as TimeDimension"),null)}var Wi=n(887),Hi=["onAfterClose"],Zi=V.a.Link;function $i(e){var t=e.onAfterClose,n=Object(h.a)(e,Hi),r=no(),a=r.isModalOpen,i=r.toggleModal,o=r.memberTypeCubeMap;return Object(_.jsx)(Pt.a,{title:"Rollup Designer",visible:a,bodyStyle:{padding:0},destroyOnClose:!0,wrapClassName:"rollup-designer",footer:Object(_.jsx)(Zi,{href:"https://cube.dev/docs/caching/pre-aggregations/getting-started",target:"_blank",children:Object(_.jsxs)(J,{justifyContent:"center",gap:1,children:[Object(_.jsx)(W,{children:Object(_.jsx)(Wa.a,{})}),Object(_.jsx)(W,{children:"Further reading about pre-aggregations for reference."}),Object(_.jsx)(W,{children:Object(_.jsx)(Wi.a,{})})]})}),width:1190,afterClose:t,onCancel:function(){return i()},children:Object(_.jsx)("div",{"data-testid":"rd-modal",children:Object(_.jsx)(mo,{apiUrl:n.apiUrl,token:n.token,memberTypeCubeMap:o})})})}var Xi=["cubejsApi","children"],eo=Object(w.createContext)({});function to(e){var t=e.cubejsApi,n=e.children,r=Object(h.a)(e,Xi),a=Object(H.j)(),i=Object(N.a)(a,2),o=i[0],c=i[1],s=Object(w.useState)(null),u=Object(N.a)(s,2),l=u[0],d=u[1],b=Object(w.useState)(null),p=Object(N.a)(b,2),f=p[0],j=p[1],m=Object(w.useState)(null),v=Object(N.a)(m,2),O=v[0],y=v[1],g=Object(w.useState)({measures:[],dimensions:[],segments:[],timeDimensions:[]}),x=Object(N.a)(g,2),k=x[0],C=x[1],S=function(){return br("meta",arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}({skip:!o,cubejsApi:t}),A=function(e){return br("dryRun",hr(hr({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{query:e}))}(f,{skip:!o||!f,cubejsApi:t});return Object(w.useEffect)((function(){var e=S.isLoading,t=S.error,n=S.response;e||(n?C(n.membersGroupedByCube()):t&&d(t))}),[S.isLoading]),Object(w.useEffect)((function(){var e=A.isLoading,t=A.error,n=A.response;e||(n?y(n.transformedQueries[0]):t&&d(t))}),[A.isLoading]),Object(_.jsxs)(eo.Provider,{value:{isLoading:S.isLoading||A.isLoading,isModalOpen:o,toggleModal:c,query:f,setQuery:j,transformedQuery:O,setTransformedQuery:y,memberTypeCubeMap:k,error:l},children:[n,Object(_.jsx)($i,{apiUrl:r.apiUrl,token:r.token,onAfterClose:function(){y(null),d(null)}})]})}function no(){return Object(w.useContext)(eo)}var ro,ao,io,oo,co=["isCloud"],so=["order","limit","filters"],uo=V.a.Paragraph,lo=V.a.Text,bo=Nt.a.TabPane,po=E.d.div(ro||(ro=Object(k.a)(["\n  display: grid;\n  grid-template-columns: 1fr 400px;\n  gap: 16px;\n"]))),ho=Object(E.d)(W)(ao||(ao=Object(k.a)(["\n  & .ant-tabs-nav {\n    padding-left: 24px;\n    margin: 0;\n  }\n"]))),fo=E.d.div(io||(io=Object(k.a)(["\n  padding: 0 24px 32px;\n  background: #f6f6f8;\n\n  & .ant-tabs-nav {\n    margin-bottom: 24px;\n  }\n\n  & .ant-tabs-tab {\n    div,\n    .ant-typography {\n      font-weight: 500;\n    }\n  }\n\n  & .ant-typography > .anticon {\n    padding-left: 12px;\n  }\n"])));function jo(e){var t=new Set;return["measures","dimensions","timeDimensions","segments"].map((function(n){if("timeDimensions"===n){var r,a=((null===(r=e[n])||void 0===r?void 0:r[0])||{}).dimension;a&&t.add("td:".concat(a))}else{var i;null===(i=e[n])||void 0===i||i.map((function(e){return t.add(e)}))}})),Array.from(t.values())}function mo(e){var t,n,r=e.apiUrl,a=e.memberTypeCubeMap,i=e.token,o=Object(w.useRef)(),c=Object(H.d)(),s=Object(H.k)()||i,u=Object(w.useContext)(pi),l=u.isCloud,f=Object(h.a)(u,co),j=no(),m=j.query,v=j.transformedQuery,O=j.isLoading,y=j.error,g=Object(w.useState)(!0),x=Object(N.a)(g,2),k=x[0],C=x[1],S=Object(w.useState)({}),E=Object(N.a)(S,2),D=E[0],T=E[1],P=Object(w.useState)([]),q=Object(N.a)(P,2),R=q[0],M=q[1],I=Object(w.useState)(null),L=Object(N.a)(I,2),z=L[0],B=L[1],F=Object(w.useState)(),Q=Object(N.a)(F,2),U=Q[0],K=Q[1],G=Object(w.useState)(!1),$=Object(N.a)(G,2),X=$[0],te=$[1],ne=Object(w.useState)("main"),re=Object(N.a)(ne,2),ie=re[0],oe=re[1],ce=Object(w.useState)(null),se=Object(N.a)(ce,2),ue=se[0],le=se[1],de=m||{},be=(de.order,de.limit,de.filters,Object(h.a)(de,so)),pe=be.timeDimensions||[],he=(Object(N.a)(pe,1)[0],new Set);a.segments.forEach((function(e){e.members.forEach((function(e){var t=e.name;return he.add(t)}))}));var fe=Object(w.useState)(Ii(v,he)),je=Object(N.a)(fe,2),me=je[0],ve=je[1],Oe=Object(Aa.a)((function(){return void 0===U||!o.current||bi()(me,Ii(v,he))}),[U,v,me,he,o]);Object(H.c)((function(){var e=Ii(v,he);ve(e);var t=jo(e).map((function(e){return e.split(".")[0]}));if(M(t),B(t[0]||null),null!=(null===v||void 0===v?void 0:v.measureToLeafMeasures))for(var n=0,r=Object.entries(v.measureToLeafMeasures);n<r.length;n++){var a=Object(N.a)(r[n],2),i=a[0];if(a[1].length>1){le(i);break}}}),[v,he]);var ye=Object(Aa.a)((function(){return jo(me)}),[me]);Object(H.c)((function(){var e=!0,t=me.measures,n=me.segments,a=me.dimensions,i=me.timeDimensions;function u(){return(u=Object(p.a)(d.a.mark((function u(){var l,b;return d.a.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Object(kt.e)("".concat(r,"/pre-aggregations/can-use"),"POST",{token:s,body:{transformedQuery:v,references:{measures:t,dimensions:a.concat(n),timeDimensions:i}}});case 2:l=u.sent,b=l.json,c()&&e&&K((function(e){return void 0===e&&(o.current=b.canUsePreAggregationForTransformedQuery),b.canUsePreAggregationForTransformedQuery}));case 5:case"end":return u.stop()}}),u)})))).apply(this,arguments)}return null!=s&&v&&function(){u.apply(this,arguments)}(),function(){return e=!1}}),[c,me,s,v]);var ge=Object(w.useMemo)((function(){var e=null;if(v)e=((null===v||void 0===v?void 0:v.leafMeasures[0])||(null===v||void 0===v?void 0:v.sortedDimensions[0])||"CubeName").split(".")[0];else if(!Li(me)){var t=jo(me);e=Object(N.a)(t,1)[0].split(".")[0]||null}return e}),[v,me]),xe=Object(Aa.a)((function(){var e=(v||{}).measureToLeafMeasures,t=void 0===e?{}:e,n=!1,r=!1,a=!1;if(ue&&t[ue]&&(n=t[ue].every((function(e){return e.additive}))),v&&!v.leafMeasureAdditive){var i,o=Object.values(t).reduce((function(e,t){return[].concat(Object(oi.a)(e),Object(oi.a)(t))}),[]);r=me.measures.some((function(e){var t=o.find((function(t){return t.measure===e}));return!!t&&!t.additive})),a=me.measures.some((function(e){var t=o.find((function(t){return t.measure===e}));return!!t&&"countDistinct"===t.type}))&&!(null===(i=me.timeDimensions[0])||void 0===i?void 0:i.granularity)}return[n,r,a]}),[me,v,ue]),ke=Object(N.a)(xe,3),we=ke[0],Ce=ke[1],Se=ke[2],Ae=Object.fromEntries(Object(kt.b)([].concat(Object(oi.a)(a.measures),Object(oi.a)(a.dimensions),Object(oi.a)(a.timeDimensions),Object(oi.a)(a.segments))));function Ee(){return De.apply(this,arguments)}function De(){return(De=Object(p.a)(d.a.mark((function e(){var t,n,r,a,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(){ui.a.success({message:"Rollup has been added to the ".concat(ge," cube")})},ge){e.next=3;break}return e.abrupt("return");case 3:if(t={preAggregationName:ie,cubeName:ge,code:_i(me,ie,D).value},te(!0),l){e.next=12;break}return e.next=8,Object(kt.e)("/playground/schema/pre-aggregation","POST",{body:t});case 8:(r=e.sent).ok?n():(a=r.json.error,ui.a.error({message:a})),e.next=19;break;case 12:if(null!=f.addPreAggregationToSchema){e.next=14;break}throw new Error("cloud.addPreAggregationToSchema is not defined");case 14:return e.next=16,f.addPreAggregationToSchema(t);case 16:i=e.sent,(o=i.error)?ui.a.error({message:o}):n();case 19:te(!1);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(e){return function(t){ve(function(e,t,n){var r,a,i,o,c=JSON.parse(JSON.stringify(e));return"timeDimensions"===t?(null===(r=c.timeDimensions)||void 0===r||null===(a=r[0])||void 0===a?void 0:a.dimension)===n?c.timeDimensions=[]:c.timeDimensions=[Object(b.a)(Object(b.a)({granularity:"day"},null===(i=c.timeDimensions)||void 0===i?void 0:i[0]),{},{dimension:n})]:(null===(o=c[t])||void 0===o?void 0:o.includes(n))?c[t]=c[t].filter((function(e){return n!==e})):c[t]=[].concat(Object(oi.a)(c[t]||[]),[n]),c}(me,e,t))}}return O?Object(_.jsxs)(J,{gap:4,style:{margin:24},children:[Object(_.jsx)(W,{style:{minWidth:256},children:Object(_.jsx)(li.a,{})}),Object(_.jsxs)(W,{grow:1,children:[Object(_.jsx)(li.a,{}),Object(_.jsx)(li.a,{})]}),Object(_.jsx)(W,{style:{width:420,minWidth:420},children:Object(_.jsx)(li.a,{})})]}):y?Object(_.jsx)("div",{style:{margin:"32px 24px"},children:Object(_.jsx)(Le,{error:y})}):Object(_.jsxs)(po,{children:[Object(_.jsx)(ho,{grow:1,style:{overflowX:"scroll"},children:Object(_.jsxs)(Nt.a,{style:{minHeight:"100%"},children:[Object(_.jsx)(bo,{tab:Object(_.jsx)("span",{"data-testid":"rd-members-tab",children:"Members"}),children:Object(_.jsxs)(J,{gap:2,children:[Object(_.jsx)(W,{style:{minWidth:280,maxWidth:280},children:Object(_.jsx)(gi,{openKeys:R,selectedKeys:ye,memberTypeCubeMap:a,firstOpenCubeName:z,onSelect:function(e,t){Te(e)(t)},onOpenKeysChange:M})}),Object(_.jsxs)(W,{grow:1,style:{marginTop:24,overflowX:"scroll"},children:[(null===(t=me.measures)||void 0===t?void 0:t.length)?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Di,{title:"Measures",members:me.measures.map((function(e){return Ae[e]})),onRemove:Te("measures")}),Object(_.jsx)(aa.a,{})]}):null,(null===(n=me.dimensions)||void 0===n?void 0:n.length)?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Di,{title:"Dimensions",members:me.dimensions.map((function(e){return Ae[e]})),onRemove:Te("dimensions")}),Object(_.jsx)(aa.a,{})]}):null,me.segments.length?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Di,{title:"Segments",members:me.segments.map((function(e){return Ae[e]})),onRemove:Te("segments")}),Object(_.jsx)(aa.a,{})]}):null,me.timeDimensions.length?Object(_.jsx)(Gi,{member:Ae[me.timeDimensions[0].dimension],granularity:me.timeDimensions[0].granularity,onGranularityChange:function(e){ve(Object(b.a)(Object(b.a)({},me),{},{timeDimensions:[Object(b.a)(Object(b.a)({},me.timeDimensions[0]||{}),e?{granularity:e}:null)]}))},onRemove:Te("timeDimensions")}):null]})]})},"members"),Object(_.jsx)(bo,{tab:Object(_.jsx)("span",{"data-testid":"rd-settings-tab",children:"Settings"}),children:Object(_.jsx)(Vi,{hasTimeDimension:me.timeDimensions.length>0,members:me.measures.concat(me.dimensions).concat(me.timeDimensions.map((function(e){return e.dimension}))),onCronExpressionValidityChange:C,onChange:function(e){return T(function(e){var t={};if(e["refreshKey.checked.every"]&&(e["refreshKey.isCron"]&&(e["refreshKey.cron"]||e["refreshKey.timeZone"])?(t.refreshKey={},e["refreshKey.cron"]&&(t.refreshKey.every="`".concat(e["refreshKey.cron"],"`")),e["refreshKey.timeZone"]&&(t.refreshKey.timezone="`".concat(e["refreshKey.timeZone"],"`"))):t.refreshKey={every:"`".concat(e["refreshKey.value"]," ").concat(e["refreshKey.granularity"],"`")}),e["refreshKey.checked.sql"]&&e["refreshKey.sql"]&&(t.refreshKey=Object(b.a)(Object(b.a)({},t.refreshKey),{},{sql:"`".concat(e["refreshKey.sql"],"`")})),e.partitionGranularity){if(t.partitionGranularity="`".concat(e.partitionGranularity,"`"),e["updateWindow.value"]){var n=[e["updateWindow.value"],e["updateWindow.granularity"]].join(" ");t.refreshKey=Object(b.a)(Object(b.a)({},t.refreshKey),{},{updateWindow:"`".concat(n,"`")})}t.refreshKey=Object(b.a)(Object(b.a)({},t.refreshKey),{},{incremental:Boolean(e.incrementalRefresh)})}return Array.isArray(e.indexes)&&e.indexes.length>0&&(t.indexes={indexName:{columns:e.indexes}}),t}(e))}})},"settings")]})}),Object(_.jsx)(fo,{children:Object(_.jsxs)(Nt.a,{children:[Object(_.jsx)(bo,{tab:Object(_.jsx)("span",{"data-testid":"rd-definition-tab",children:"Rollup Definition"}),children:Object(_.jsxs)(J,{direction:"column",justifyContent:"flex-start",children:[Ce&&Object(_.jsx)(W,{style:{marginBottom:24},children:Object(_.jsx)(A.a,{type:"info",message:Object(_.jsx)(lo,{children:"This rollup contains a non-additive measure"})})}),we&&Object(_.jsx)(W,{style:{marginBottom:24},children:Object(_.jsx)(A.a,{type:"info",message:Object(_.jsxs)(lo,{children:["Because ",Object(_.jsx)("b",{children:ue})," is a non-additive measure that is calculated with additive measures, this rollup is configured with the additive measures that calculate this non-additive measure. See more info in"," ",Object(_.jsx)(V.a.Link,{href:"https://cube.dev/docs/recipes/non-additivity#data-schema-decomposing-into-a-formula-with-additive-measures",target:"_blank",children:"our docs"}),"."]})})}),!Li(me)&&!me.timeDimensions.length&&Object(_.jsx)(W,{style:{marginBottom:24},children:Object(_.jsx)(A.a,{type:"warning",message:"This rollup has no time dimension so it cannot be partitioned"})}),Object(_.jsxs)(W,{style:{marginBottom:16},children:[Li(me)?Object(_.jsx)(A.a,{type:"warning",message:"Add some references"}):Object(_.jsxs)(uo,{children:["Add the following rollup pre-aggregation",Object(_.jsx)("br",{})," to the ",Object(_.jsx)("b",{children:ge})," cube:"]}),Object(_.jsx)(uo,{style:{margin:"24px 0 4px"},children:"Rollup Name"}),Object(_.jsx)(ee.a,{value:ie,suffix:Object(_.jsx)(ci.a,{}),onChange:function(e){return oe(e.target.value)}})]}),Object(_.jsx)(W,{children:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(He,{style:{marginBottom:16},code:_i(me,ie,D).code,copyMessage:"Rollup definition is copied",theme:"light"}),ge?Object(_.jsx)(Y.a,{"data-testid":"rd-add-btn",type:"primary",loading:X,disabled:!k,style:{width:"100%"},onClick:Ee,children:"Add to the Data Schema"}):null]})})]})},"rollup"),Object(Rn.i)(m)?Object(_.jsx)(bo,{tab:U?Object(_.jsx)("span",{"data-testid":"rd-query-tab",children:"Query Compatibility"}):Object(_.jsxs)(V.a.Text,{"data-testid":"rd-query-tab",children:["Query Compatibility",null!=U?Object(_.jsx)(si.a,{style:{color:"#FBBC05"}}):null]}),children:Object(_.jsxs)(J,{direction:"column",justifyContent:"flex-start",children:[Object(_.jsx)(W,{style:{marginBottom:32},children:Object(_.jsxs)(ae.b,{direction:"vertical",size:24,children:[Se&&Object(_.jsx)(A.a,{type:"warning",message:Object(_.jsx)(lo,{children:"This query does not have any time dimension granularity, which prevents pre-aggregating any count distinct measures."})}),U?Object(_.jsx)(lo,{children:"This rollup will match the following query:"}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(A.a,{"data-testid":"rd-incompatible-query",type:"warning",message:Object(_.jsxs)(lo,{children:["This rollup does ",Object(_.jsx)("b",{children:"NOT"})," match the following query:"]})}),!Oe&&Object(_.jsx)(Y.a,{"data-testid":"rd-match-rollup-btn",type:"primary",ghost:!0,onClick:function(){ve(Ii(v,he)),K(!0)},children:"Match Rollup"})]})]})}),Object(_.jsx)(He,{style:{minWidth:200},code:Object(Z.g)(be),copyMessage:"Query is copied",theme:"light"})]})},"query"):null]})})]})}var vo,Oo,yo=E.d.div(oo||(oo=Object(k.a)(["\n  display: flex;\n  align-items: center;\n  padding: 2px 4px;\n  border-radius: 4px;\n  background: var(--warning-bg-color);\n"])));function go(e){var t=e.isAggregated,n=e.external,r=e.extDbType,a=e.preAggregationType,i=Object(H.i)("0.28.4"),o=no().toggleModal;return Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)(ae.b,{style:{marginLeft:"auto"},children:[t&&Object(_.jsx)(yo,{children:Object(_.jsx)(ae.b,{size:4,children:Object(_.jsx)(T.a,{style:{color:"var(--warning-color)"},component:function(){return Object(_.jsx)(ii.a,{})}})})}),t?Object(_.jsx)(V.a.Text,{children:"Query was accelerated with pre-aggregation"}):i?Object(_.jsxs)(Y.a,{"data-testid":"not-pre-agg-query-btn",type:"link",onClick:function(){return o()},children:["Query was not accelerated with pre-aggregation ","->"]}):null,t&&n&&"cubestore"!==r?Object(_.jsx)(A.a,{message:"Consider migrating your pre-aggregations to Cube Store for better performance with larger datasets",type:"warning"}):null,t&&!n&&"originalSql"!==a?Object(_.jsx)(A.a,{message:Object(_.jsxs)(_.Fragment,{children:["For optimized performance, consider using ",Object(_.jsx)("b",{children:"external"})," ",a," pre-aggregation, rather than the source database (internal)"]}),type:"warning"}):null]})})}var xo,ko,wo,Co=E.d.div(vo||(vo=Object(k.a)(["\n  display: flex;\n  flex-flow: column;\n  margin-right: 24px;\n  margin-bottom: 16px;\n\n  > *:first-child {\n    margin-bottom: 8px;\n  }\n"]))),So=E.d.div(Oo||(Oo=Object(k.a)(["\n  background-color: var(--layout-body-background);\n  padding-bottom: 16px;\n"]))),Ao={react:[{value:"chartjs",title:"Chart.js"},{value:"bizcharts",title:"Bizcharts"},{value:"recharts",title:"Recharts"},{value:"d3",title:"D3"}],angular:[{value:"angular-ng2-charts",title:"ng2"}],vue:[{value:"chartkick",title:"Chartkick"}]},Eo=function(e,t){return Object.keys(e).map((function(n){return Object(Xt.a)({},n,(function(r,a){var i="".concat(n.split("").map((function(e,t){return 0===t?e.toUpperCase():e})).join("")," Member");(null===a||void 0===a?void 0:a.values)&&(i="Update Filter Values"),(null===a||void 0===a?void 0:a.dateRange)&&(i="Update Date Range"),(null===a||void 0===a?void 0:a.granularity)&&(i="Update Granularity"),ut(i,{memberName:t});for(var o=arguments.length,c=new Array(o>2?o-2:0),s=2;s<o;s++)c[s-2]=arguments[s];return e[n].apply(null,[r,a].concat(c))}))})).reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),t)}),{})};function Do(e){var t=e.iframeRef,n=e.pivotConfig,r=e.chartType;return Object(H.c)((function(){(null===t||void 0===t?void 0:t.current)&&["table","bar"].includes(r)&&Object(Z.c)(t.current.contentDocument,"chart",{pivotConfig:n})}),[t,n]),null}function To(e){var t=e.query1,n=e.query2,r=e.onChange;return Object(H.c)((function(){Object(Rn.c)(Object(Rn.m)(t),Object(Rn.m)(n))||r()}),[t,n]),null}function Po(e){var t=e.apiUrl,n=e.cubejsToken,r=e.defaultQuery,a=e.queryId,i=e.dashboardSource,o=e.schemaVersion,c=void 0===o?0:o,s=e.initialVizState,u=e.extra,l=e.onSchemaChange,h=e.onVizStateChanged,f=Object(H.d)(),j=Object(H.i)("0.29.0"),m=Wr(a),v=m.isChartRendererReady,O=m.queryStatus,y=m.queryError,g=m.queryRequestId,x=Hr(),k=x.setQueryStatus,C=x.setQueryLoading,S=x.setChartRendererReady,A=x.setQueryError,E=Object(H.h)().refreshToken,D=Object(w.useRef)(null),T=Object(w.useRef)(null),P=Object(w.useState)(!1),q=Object(N.a)(P,2),R=q[0],M=q[1],I=Object(w.useState)("react"),L=Object(N.a)(I,2),z=L[0],B=L[1],F=Object(w.useState)("chartjs"),Q=Object(N.a)(F,2),U=Q[0],K=Q[1];function V(e){var t=e.query,n=e.pivotConfig,r=e.chartType;D.current&&(Object(Rn.c)(t,T.current)?(Object(Z.c)(D.current.contentDocument,"chart",{pivotConfig:n,query:t,chartType:r,chartingLibrary:U}),Object(Z.c)(D.current.contentDocument,"refetch")):Object(Z.c)(D.current.contentDocument,"chart",{pivotConfig:n,query:t,chartType:r,chartingLibrary:U})),A(a,null),T.current=t}return Object(w.useEffect)((function(){Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:f()&&M(!0);case 3:case"end":return e.stop()}}),e)})))()}),[f]),Object(w.useEffect)((function(){v&&D.current&&Object(Z.c)(D.current.contentDocument,"credentials",{token:n,apiUrl:t})}),[D,n,t,v]),R?Object(_.jsx)(or,{defaultQuery:r,initialVizState:s,wrapWithQueryRenderer:!1,schemaVersion:c,onSchemaChange:l,onVizStateChanged:h,render:function(e){var r,o,c,s,l=e.query,h=e.error,f=e.metaError,m=e.metaErrorStack,x=e.meta,w=e.isQueryPresent,A=e.chartType,P=e.updateChartType,q=e.measures,R=e.updateMeasures,M=e.dimensions,I=e.updateDimensions,L=e.segments,F=e.updateSegments,Q=e.filters,N=e.updateFilters,Y=e.timeDimensions,J=e.updateTimeDimensions,G=e.orderMembers,W=e.updateOrder,H=e.pivotConfig,$=e.updatePivotConfig,X=e.missingMembers,ee=e.isFetchingMeta,te=e.dryRunResponse,ne=e.availableMembers,re=e.availableFilterMembers;if(te){var ie,oe=(te.pivotQuery||{}).timeDimensions;s=null===(ie=(void 0===oe?[]:oe)[0])||void 0===ie?void 0:ie.dateRange}else Array.isArray(null===(r=l.timeDimensions)||void 0===r||null===(o=r[0])||void 0===o?void 0:o.dateRange)&&(s=l.timeDimensions[0].dateRange);return Object(_.jsxs)(So,{"data-testid":"query-builder-".concat(a),children:[Object(_.jsx)(tn.a,{justify:"space-around",align:"top",gutter:24,style:{marginBottom:12},children:Object(_.jsxs)(en.a,{span:24,children:[Object(_.jsx)(Ne,{bordered:!1,style:{borderRadius:0},children:Object(_.jsxs)(tn.a,{align:"top",gutter:0,style:{marginBottom:-12},children:[Object(_.jsxs)(Co,{children:[Object(_.jsx)(Rt,{children:"Measures"}),Object(_.jsx)(Na,{disabled:ee,members:q,availableMembers:(null===ne||void 0===ne?void 0:ne.measures)||[],missingMembers:X,addMemberName:"Measure",updateMethods:Eo(R,"Measure")})]}),Object(_.jsxs)(Co,{children:[Object(_.jsx)(Rt,{children:"Dimensions"}),Object(_.jsx)(Na,{disabled:ee,members:M,availableMembers:(null===ne||void 0===ne?void 0:ne.dimensions)||[],missingMembers:X,addMemberName:"Dimension",updateMethods:Eo(I,"Dimension")})]}),Object(_.jsxs)(Co,{children:[Object(_.jsx)(Rt,{children:"Segment"}),Object(_.jsx)(Na,{disabled:ee,members:L,availableMembers:(null===ne||void 0===ne?void 0:ne.segments)||[],missingMembers:X,addMemberName:"Segment",updateMethods:Eo(F,"Segment")})]}),Object(_.jsxs)(Co,{children:[Object(_.jsx)(Rt,{children:"Time"}),Object(_.jsx)(ai,{disabled:ee,members:Y,availableMembers:(null===ne||void 0===ne?void 0:ne.timeDimensions)||[],missingMembers:X,addMemberName:"Time",updateMethods:Eo(J,"Time"),parsedDateRange:s})]}),Object(_.jsxs)(Co,{children:[Object(_.jsx)(Rt,{children:"Filters"}),Object(_.jsx)(Qa,{disabled:ee,members:Q,availableMembers:re,missingMembers:X,addMemberName:"Filter",updateMethods:Eo(N,"Filter")})]})]})}),Object(_.jsxs)(Mt,{style:{margin:16,marginBottom:0},children:[Object(_.jsx)(Za,{chartType:A||"line",updateChartType:function(e){ut("Change Chart Type"),P(e),D.current&&Object(Z.c)(D.current.contentDocument,"chart",{chartType:e,chartingLibrary:U})}}),Object(_.jsx)(Oa,{isQueryPresent:w,limit:l.limit||5e3,pivotConfig:H,disabled:ee,orderMembers:G,onReorder:W.reorder,onOrderChange:W.set,onMove:$.moveItem,onUpdate:$.update}),Object(_.jsxs)(ae.b,{style:{marginLeft:"auto"},children:[u?Object(_.jsx)(u,{queryRequestId:g||(null===y||void 0===y||null===(c=y.response)||void 0===c?void 0:c.requestId),queryStatus:O,error:y}):null,O?Object(_.jsx)(go,Object(b.a)({apiUrl:t,availableMembers:ne,query:l},O)):null]})]})]})}),Object(_.jsx)(tn.a,{justify:"space-around",align:"top",gutter:32,style:{margin:0},children:Object(_.jsxs)(en.a,{span:24,children:[!w&&f?Object(_.jsx)(Ne,{children:Object(_.jsx)(Le,{error:f,stack:m})}):null,!w&&!f&&Object(_.jsx)("h2",{style:{textAlign:"center"},children:"Choose a measure or dimension to get started"}),w&&Object(_.jsx)(Lr,{apiUrl:t,cubejsToken:n,meta:x,isGraphQLSupported:j,iframeRef:D,isChartRendererReady:v,query:l,error:h,chartType:A||"line",pivotConfig:H,framework:z,chartingLibrary:U,dashboardSource:i,setFramework:function(e){e!==z&&(C(a,!1),B(e))},setChartLibrary:function(e){D.current&&Object(Z.c)(D.current.contentDocument,"chart",{chartingLibrary:e}),K(e)},chartLibraries:Ao,isFetchingMeta:ee,render:function(e){var t=e.framework;return f?Object(_.jsx)(Le,{error:f,stack:m}):Object(_.jsx)(ra,{queryId:a,areQueriesEqual:Object(Rn.c)(Object(Rn.m)(l),Object(Rn.m)(T.current)),isFetchingMeta:ee,queryError:y,framework:t,chartType:A||"line",query:l,pivotConfig:H,iframeRef:D,queryHasMissingMembers:X.length>0,onRunButtonClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v||!D.current||0!==X.length){e.next=4;break}return e.next=3,E();case 3:V({query:Object(Rn.m)(l),pivotConfig:H,chartType:A||"line"});case 4:case"end":return e.stop()}}),e)})))})},onChartRendererReadyChange:function(e){return S(a,e)}})]})}),Object(_.jsx)(Do,{iframeRef:D,chartType:A||"line",pivotConfig:H}),Object(_.jsx)(To,{query1:l,query2:T.current,onChange:function(){C(a,!1),k(a,null)}})]})}}):null}var qo=function(e){var t=e.children;return Object(_.jsx)("div",{style:{margin:25},children:t})},Ro=E.d.div(xo||(xo=Object(k.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  margin: auto;\n  max-width: 1024px;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: ",";\n"])),(function(e){return'url("'.concat(e.src,'")')})),Mo=Object(E.d)(Ne)(ko||(ko=Object(k.a)(["\n  && {\n    border: none;\n    border-radius: 8px;\n    margin-bottom: 24px;\n    padding: 16px;\n    ","\n\n    &:hover {\n      padding: 16px;\n      ","\n    }\n\n    button {\n      display: none;\n      position: absolute;\n      margin-left: -64px;\n      top: 80px;\n      left: 50%;\n    }\n\n    svg path {\n      transition: stroke 0.25s ease;\n    }\n\n    && .ant-card-cover {\n      height: 168px;\n      border-radius: 8px 8px 0 0;\n      background: ",";\n      display: flex;\n      align-items: center;\n      position: relative;\n      margin: -16px -16px 0 -16px;\n      padding: 24px 24px 0 24px;\n\n      &::after {\n        content: '';\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n        background: rgba(81, 87, 125, 0.3);\n        opacity: 0;\n        transition: all 0.25s;\n        border-radius: 8px 8px 0 0;\n      }\n\n      div {\n        //box-shadow: 0 -1px 6px rgba(20, 20, 70, .06);\n        background-position: top;\n        border-radius: 4px 4px 0 0;\n      }\n    }\n\n    &&.ant-card-hoverable:hover {\n      box-shadow: 0 15px 20px rgba(67, 67, 107, 0.1);\n      button {\n        display: block;\n      }\n      &:hover .ant-card-cover:after {\n        opacity: ",";\n      }\n    }\n\n    svg path {\n      stroke: var(--primary-color);\n    }\n\n    && .ant-card-body {\n      min-height: 175px;\n      display: flex;\n      place-items: stretch;\n      place-content: start stretch;\n      text-align: left;\n      z-index: 1;\n      padding: 24px 0 16px;\n    }\n\n    && .ant-card-meta {\n      text-align: left;\n    }\n\n    && .ant-card-meta-title {\n      white-space: unset;\n      color: ",";\n      text-align: ",";\n      margin-bottom: 16px;\n    }\n\n    && .ant-card-meta-description {\n      color: ",";\n      opacity: ",";\n      font-size: 13px;\n      text-align: ",";\n      ","\n    }\n  }\n"])),(function(e){return e.createYourOwn?"\n      background: transparent;\n      border: 1px solid var(--purple-03-color);\n    ":""}),(function(e){return e.createYourOwn?"\n        border: 1px solid var(--purple-03-color);\n      ":"border: none;"}),(function(e){return e.createYourOwn?"transparent":"#DEDEF1"}),(function(e){return e.createYourOwn?"0":"1"}),(function(e){return e.createYourOwn?"var(--primary-color)":"var(--text-color)"}),(function(e){return e.createYourOwn?"center":"left"}),(function(e){return e.createYourOwn?"var(--primary-color)":"var(--dark-04-color)"}),(function(e){return e.createYourOwn?"0.8":1}),(function(e){return e.createYourOwn?"center":"left"}),(function(e){return e.createYourOwn?"padding: 0 32px;":""})),Io=Object(E.d)(V.a.Text)(wo||(wo=Object(k.a)(["\n  display: block;\n  font-size: 16px;\n  margin-bottom: 24px;\n"]))),Lo=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).dashboardSource=new St,r.state={chartLibrary:Ao.react[0].value,framework:"react",templatePackageName:"react-antd-dynamic",templates:null},r}return Object(y.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dashboardSource.load(!0);case 2:return e.t0=this,e.t1=this.dashboardSource.loadError,e.next=6,this.dashboardSource.templates();case 6:e.t2=e.sent,e.t3={loadError:e.t1,templates:e.t2},e.t0.setState.call(e.t0,e.t3);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,n=this,r=this.state,a=r.loadError,i=r.templates;if(a&&-1===a.indexOf("Dashboard app not found"))return Object(_.jsx)(m.a,{to:"/dashboard"});if(null==i)return Object(_.jsx)(Te,{});var o=this.state,c=o.chartLibrary,s=o.framework,u=o.templatePackageName,l=o.createOwnModalVisible,b=o.enableWebSocketTransport,h=this.props.history,f=Ao[s].find((function(e){return e.value===c})),j=Cr.find((function(e){return e.id===s})),v=null===(e=this.dashboardSource)||void 0===e?void 0:e.templatePackages(s).find((function(e){return e.name===u})),O=i.map((function(e){var t=e.name,r=e.description,a=e.coverUrl;return Object(_.jsx)(en.a,{xs:{span:24},md:{span:12},lg:{span:8},xl:{span:6},style:{display:"flex"},children:Object(_.jsxs)(Mo,{hoverable:!0,bordered:!1,cover:Object(_.jsx)(Ro,{src:a}),children:[Object(_.jsx)(Ne.Meta,{title:t,description:r}),Object(_.jsx)(ze,{type:"primary",onClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.dashboardSource.applyTemplatePackages(t);case 2:h.push("/dashboard");case 3:case"end":return e.stop()}}),e)}))),children:"Create App"})]})},t)})).concat([Object(_.jsxs)(en.a,{xs:{span:24},md:{span:12},lg:{span:8},xl:{span:6},style:{display:"flex"},children:[Object(_.jsx)(Mo,{onClick:function(){return n.setState({createOwnModalVisible:!0})},hoverable:!0,createYourOwn:!0,bordered:!1,cover:Object(_.jsx)(nn.a,{style:{fontSize:60}}),children:Object(_.jsx)(Ne.Meta,{title:"Create your Own",description:"Mix different templates together to create your own dashboard application"})}),Object(_.jsx)(Kr,{visible:l,onOk:Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n.setState({createOwnModalVisible:!1}),t="react"===s.toLowerCase()?["create-react-app",u,"".concat(c,"-charts"),"".concat(u.match(/^react-(\w+)/)[1],"-tables"),"react-credentials"].concat(b?["react-web-socket-transport"]:[]):"angular"===s.toLowerCase()?["create-ng-app",u,"ng2-charts","ng-credentials"]:["create-vue-app",u,"vue-chartkick-charts"],e.next=5,n.dashboardSource.applyTemplatePackages(t);case 5:h.push("/dashboard");case 6:case"end":return e.stop()}}),e)}))),onCancel:function(){return n.setState({createOwnModalVisible:!1})},onChange:function(e,t){if("framework"===e&&s!==t){var r,a,i,o=(null===(r=n.dashboardSource)||void 0===r?void 0:r.templatePackages(t))||[];n.setState({templatePackageName:null===(a=o[0])||void 0===a?void 0:a.name,chartLibrary:null===(i=Ao[t.toLowerCase()])||void 0===i?void 0:i[0].value})}n.setState(Object(Xt.a)({},e,t))},chartLibraries:Ao[s],currentLibraryItem:f,frameworks:Cr.filter((function(e){return"vanilla"!==e.id})),framework:s,frameworkItem:j,templatePackages:(null===(t=this.dashboardSource)||void 0===t?void 0:t.templatePackages(s))||[],templatePackage:v,enableWebSocketTransport:b&&"angular"!==s.toLowerCase()})]},"own")]);return Object(_.jsxs)(qo,{children:[Object(_.jsxs)(Io,{children:["Build your app from one of the popular templates below or"," ",Object(_.jsx)("a",{onClick:function(){return n.setState({createOwnModalVisible:!0})},children:"create your own"})]}),Object(_.jsx)(tn.a,{gutter:24,children:O})]})}}]),n}(w.Component),_o=Object(m.g)(Lo),zo=n.p+"static/media/postgres.e67db92e.svg",Bo=n.p+"static/media/mysql.376b985e.svg",Fo=n.p+"static/media/athena.3d08e54a.svg",Qo=n.p+"static/media/clickhouse.15d7a0f1.svg",No=n.p+"static/media/firebolt.832e1506.svg",Uo=n.p+"static/media/hive.b33891fc.svg",Ko=n.p+"static/media/redshift.b80154fa.svg",Vo=n.p+"static/media/presto.bf9e7a80.svg",Yo=n.p+"static/media/snowflake.7e110f33.svg",Jo=n.p+"static/media/oracle.e2b7363b.svg",Go=n.p+"static/media/mssql.7dc54d0e.svg",Wo=n.p+"static/media/bigquery.47cbd6db.svg",Ho=n.p+"static/media/mongodb.23376a66.svg",Zo=n.p+"static/media/druid.7ac8cbb7.svg",$o=[{env:"CUBEJS_DB_HOST",title:"Hostname"},{env:"CUBEJS_DB_PORT",title:"Port"}],Xo=[{env:"CUBEJS_DB_USER",title:"Username"},{env:"CUBEJS_DB_PASS",title:"Password"}],ec={env:"CUBEJS_DB_NAME",title:"Database"},tc=[{databases:[{title:"PostgreSQL",driver:"postgres",logo:zo},{title:"MySQL",driver:"mysql",logo:Bo},{title:"AWS Redshift",driver:"redshift",logo:Ko},{title:"ClickHouse",driver:"clickhouse",logo:Qo},{title:"Hive/SparkSQL",driver:"hive",logo:Uo},{title:"Oracle",driver:"oracle",logo:Jo},{title:"QuestDB",driver:"questdb",logo:n.p+"static/media/questdb.c7cab014.svg"},{title:"Materialize",driver:"materialize",logo:n.p+"static/media/materialize.102ab165.svg"}],settings:[].concat($o,[ec],Xo)},{databases:[{title:"MS SQL",driver:"mssql",logo:Go}],settings:[].concat($o,Xo,[ec,{env:"CUBEJS_DB_DOMAIN",title:"Domain Name"}])},{databases:[{title:"AWS Athena",driver:"athena",logo:Fo,instructions:'\nSpecify the AWS access and secret keys with the <a href="https://docs.aws.amazon.com/athena/latest/ug/security-iam-athena.html" target="_blank">access necessary to run Athena queries</a>,\nand the target AWS region and <a href="https://docs.aws.amazon.com/athena/latest/ug/querying.html" target="_blank">S3 output location</a> where query results are stored.\n    '}],settings:[{env:"CUBEJS_AWS_KEY",title:"AWS Access Key ID"},{env:"CUBEJS_AWS_SECRET",title:"AWS Secret Access Key"},{env:"CUBEJS_AWS_REGION",title:"AWS Region"},{env:"CUBEJS_AWS_S3_OUTPUT_LOCATION",title:"S3 Output Location"}]},{databases:[{title:"Google Bigquery",driver:"bigquery",logo:Wo,instructions:"\nUpload a service account JSON keyfile to connect to BigQuery.<br/>Alternatively, you can encode the key file with base64 and specify it manually.\n    "}],settings:[{env:"CUBEJS_DB_BQ_KEY_FILE",title:"Upload a Service Account JSON file",type:"base64upload",uploadTarget:"CUBEJS_DB_BQ_CREDENTIALS",extractField:{jsonField:"project_id",formField:"CUBEJS_DB_BQ_PROJECT_ID"}},{env:"CUBEJS_DB_BQ_PROJECT_ID",title:"Project ID"},{env:"CUBEJS_DB_BQ_CREDENTIALS",title:"Encoded Key File"}]},{databases:[{title:"Firebolt",driver:"firebolt",logo:No}],settings:[].concat(Xo,[ec,{env:"CUBEJS_FIREBOLT_ENGINE_ENDPOINT",title:"Engine Endpoint"}])},{databases:[{title:"MongoDB",driver:"mongobi",logo:Ho}],settings:[].concat($o,Xo,[ec])},{databases:[{title:"Snowflake",driver:"snowflake",logo:Yo}],settings:[].concat(Xo,[ec,{env:"CUBEJS_DB_SNOWFLAKE_ACCOUNT",title:"Account"},{env:"CUBEJS_DB_SNOWFLAKE_REGION",title:"Region"},{env:"CUBEJS_DB_SNOWFLAKE_WAREHOUSE",title:"Warehouse"},{env:"CUBEJS_DB_SNOWFLAKE_ROLE",title:"Role"}])},{databases:[{title:"Presto",driver:"prestodb",logo:Vo}],settings:[].concat($o,Xo,[{env:"CUBEJS_DB_CATALOG",title:"Catalog"},{env:"CUBEJS_DB_SCHEMA",title:"Schema"}])},{databases:[{title:"Druid",driver:"druid",logo:Zo}],settings:[{env:"CUBEJS_DB_URL",title:"URL"}].concat(Xo)}],nc=n(164);function rc(e){var t=e.loading,n=e.result;return t?Object(_.jsxs)(ae.b,{align:"center",size:"middle",children:[Object(_.jsx)(xt.a,{"data-testid":"wizard-test-connection-spinner"}),Object(_.jsx)(V.a.Text,{children:"Testing database connection"})]}):(null===n||void 0===n?void 0:n.success)?Object(_.jsxs)(V.a.Text,{type:"success",children:[Object(_.jsx)(nc.a,{}),"\xa0\xa0Connection successful"]}):(null===n||void 0===n?void 0:n.error)?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(V.a.Text,{type:"danger",children:"We couldn\u2019t connect. Please double check the provided data and try again"}),Object(_.jsx)(A.a,{"data-testid":"wizard-connection-error",style:{marginTop:20},message:"Runtime Error",type:"error",description:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("p",{style:{paddingLeft:20},children:"Cube.js was unable to connect to the specified database."}),Object(_.jsx)("p",{style:{paddingLeft:20},children:"The database returned the following error:"}),Object(_.jsx)("br",{}),Object(_.jsx)("p",{style:{paddingLeft:40},children:">Database Error"}),Object(_.jsx)("p",{style:{paddingLeft:40},children:n.error.toString()}),Object(_.jsx)("br",{}),Object(_.jsx)("p",{children:"Check your database credentials and try again. For more information, visit:"}),Object(_.jsx)("a",{href:"https://cube.dev/docs/config/databases",target:"_blank",children:"https://cube.dev/docs/config/databases"})]})})]}):null}var ac,ic=n(875);function oc(e){var t=e.db;return Object(_.jsx)(K.a,{"data-testid":"wizard-db-card",children:Object(_.jsxs)(tn.a,{align:"middle",justify:"space-between",children:[Object(_.jsx)(en.a,{flex:"40px",children:Object(_.jsx)(ic.a,{src:t.logo,preview:!1})}),Object(_.jsx)(en.a,{children:Object(_.jsx)(V.a.Text,{strong:!0,children:t.title})})]})})}var cc=E.d.div(ac||(ac=Object(k.a)(["\n  background-color: #f8f8f9;\n  padding: 15px 20px;\n  border-radius: 4px;\n"])));function sc(e){var t=e.db;return Object(_.jsx)(cc,{children:Object(_.jsxs)(tn.a,{align:"middle",justify:"space-between",children:[Object(_.jsx)(en.a,{flex:"40px",children:Object(_.jsx)(ic.a,{src:t.logo,preview:!1})}),Object(_.jsx)(en.a,{children:Object(_.jsx)(V.a.Text,{strong:!0,children:t.title})})]})})}var uc,lc,dc=n(872),bc=n(905),pc=["onInput"],hc=V.a.Text;function fc(e){var t=e.onInput,n=(Object(h.a)(e,pc),Object(w.useState)("")),r=Object(N.a)(n,2),a=r[0],i=r[1],o=Object(w.useState)(""),c=Object(N.a)(o,2),s=c[0],u=c[1],l={name:"file",headers:{authorization:"authorization-text"},accept:"application/json, .json",beforeUpload:function(e){var n=new FileReader;return n.onload=function(e){var n="",r=e.target.result.toString();try{JSON.parse(r),n=btoa(r)}catch(a){u("Invalid JSON file"),console.error(a)}t&&t({encoded:n,raw:JSON.parse(r)})},n.readAsText(e),!1},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?i(e.file.name):"error"===e.file.status&&(console.log("".concat(e.file.name," file upload failed.")),u("Invalid file"))},onRemove:function(){u("")}};return Object(_.jsxs)(ae.b,{direction:"vertical",children:[Object(_.jsx)(dc.a,Object(b.a)(Object(b.a)({},l),{},{children:Object(_.jsx)(Y.a,{icon:Object(_.jsx)(bc.a,{}),children:"Choose file"})})),a||s?null:Object(_.jsx)(hc,{type:"secondary",children:"No file selected"}),s&&Object(_.jsx)(hc,{type:"danger",children:s})]})}function jc(e){var t=e.db,n=e.deployment,r=e.loading,a=void 0!==r&&r,i=e.disabled,o=void 0!==i&&i,c=e.hostname,s=void 0===c?"":c,u=e.onSubmit,l=X.a.useForm(),d=Object(N.a)(l,1)[0];Object(w.useEffect)((function(){d.setFieldsValue({CUBEJS_DB_HOST:s})}),[s]);var b=(n.envVariables||[]).reduce((function(e,t){return e[t.name]=t.value,e}),{});return Object(_.jsxs)(X.a,{"data-testid":"wizard-db-form",form:d,layout:"vertical",onFinish:function(e){e.CUBEJS_DB_TYPE=t.driver,u(e)},initialValues:b,children:[t.settings.map((function(e){return"base64upload"===e.type?Object(_.jsx)(fc,{onInput:function(t){var n=t.raw,r=t.encoded;e.uploadTarget&&d.setFieldsValue(Object(Xt.a)({},e.uploadTarget,r)),e.extractField&&d.setFieldsValue(Object(Xt.a)({},e.extractField.formField,n[e.extractField.jsonField]))}}):Object(_.jsx)(X.a.Item,{label:e.title||e.env,name:e.env,children:e.title?"CUBEJS_DB_PASS"===e.env?Object(_.jsx)(ee.a.Password,{"data-testid":e.env}):Object(_.jsx)(ee.a,{"data-testid":e.env}):Object(_.jsx)(ee.a.TextArea,{"data-testid":e.env,rows:1,style:{overflow:"hidden",resize:"none"}})},e.env)})),Object(_.jsx)(Y.a,{"data-testid":"wizard-form-submit-btn",type:"primary",htmlType:"submit",loading:a,disabled:o,children:"Apply"})]})}var mc,vc,Oc=Object(E.d)(A.a)(uc||(uc=Object(k.a)(["\n  border: none;\n  padding: 16px;\n"]))),yc=Object(E.d)(X.a)(lc||(lc=Object(k.a)(["\n  .ant-form-item {\n    margin-bottom: 20px;\n  }\n\n  .ant-form-item:last-child {\n    margin-bottom: 0;\n  }\n\n  .ant-form-item-label {\n    padding-bottom: 4px;\n  }\n"])));function gc(e){var t=e.onHostnameCopy;return Object(_.jsx)(Oc,{"data-testid":"wizard-localhost-tipbox",type:"warning",message:Object(_.jsxs)(ae.b,{direction:"vertical",size:"middle",children:[Object(_.jsxs)(V.a.Text,{children:["To connect to the database running on the localhost use the following ",Object(_.jsx)("b",{children:"hostname"})," value"]}),Object(_.jsxs)(yc,{children:[Object(_.jsx)(re,{label:"Mac",value:"host.docker.internal",onCopyClick:t}),Object(_.jsx)(re,{label:"Windows",value:"host.docker.internal",onCopyClick:t}),Object(_.jsx)(re,{label:"Linux",value:"localhost",onCopyClick:t}),Object(_.jsxs)(ae.b,{direction:"vertical",size:"middle",children:[Object(_.jsxs)(V.a.Text,{children:["Please note, for Linux, you need to run Cube.js Docker container in the"," ",Object(_.jsx)(V.a.Link,{href:"https://docs.docker.com/network/host/",target:"_blank",children:'network mode "host"'})," ","to be able to connect to the database running on localhost."]}),Object(_.jsx)(re,{value:"docker run --network host",onCopyClick:function(e){return Object(Z.b)(e)}})]})]})]})})}var xc=V.a.Title,kc=V.a.Paragraph,wc="installing",Cc="installed",Sc=E.d.div(mc||(mc=Object(k.a)(["\n  cursor: pointer;\n"]))),Ac=E.d.div(vc||(vc=Object(k.a)(["\n  width: auto;\n  min-height: 100vh;\n  max-width: 960px;\n  padding: 48px 24px;\n  margin: 0 auto;\n  background-color: #fff;\n"]))),Ec=tc.reduce((function(e,t){var n=t.databases,r=t.settings;return[].concat(Object(oi.a)(e),Object(oi.a)(n.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{settings:r})}))))}),[]);function Dc(e){return Tc.apply(this,arguments)}function Tc(){return(Tc=Object(p.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.e)("/playground/test-connection",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({variables:t})},5e3);case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,!(a=r.error)){e.next=9;break}throw new Error(a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pc(e){return qc.apply(this,arguments)}function qc(){return(qc=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/env",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({variables:t})});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rc(e){var t=e.history,n=Object(H.g)(),r=Object(w.useState)(""),a=Object(N.a)(r,2),i=a[0],o=a[1],c=Object(w.useState)(!1),s=Object(N.a)(c,2),u=s[0],l=s[1],b=Object(w.useState)(!1),h=Object(N.a)(b,2),f=h[0],j=h[1],m=Object(w.useState)(null),v=Object(N.a)(m,2),O=v[0],y=v[1],g=Object(w.useState)(null),x=Object(N.a)(g,2),k=x[0],C=x[1],S=Object(w.useState)(!1),E=Object(N.a)(S,2),D=E[0],T=E[1],P=Object(w.useState)(null),q=Object(N.a)(P,2),R=q[0],M=q[1],I=Object(w.useState)(null),L=Object(N.a)(I,2),z=L[0],B=L[1];function F(e){return Object(p.a)(d.a.mark((function t(){var r,a,i,o,c,s,u,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null===n||void 0===n?void 0:n.isDocker)){t.next=2;break}return t.abrupt("return",C(e));case 2:return t.next=4,fetch("/playground/driver?driver=".concat(e.driver||""));case 4:return r=t.sent,t.next=7,r.json();case 7:if(a=t.sent,i=a.status,o=a.error,!r.ok){t.next=18;break}if(i!==Cc){t.next=15;break}return t.abrupt("return",C(e));case 15:i===wc&&(T(!0),C(e));case 16:t.next=19;break;case 18:B(o);case 19:return t.next=21,fetch("/playground/driver",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({driver:e.driver})});case 21:return c=t.sent,t.next=24,c.json();case 24:s=t.sent,u=s.dependency,l=s.error,c.ok?(M(u),T(!0),C(e)):B(l);case 28:case"end":return t.stop()}}),t)})))}return Object(w.useEffect)((function(){ut("connection_wizard_open")}),[]),Object(w.useLayoutEffect)((function(){(null===n||void 0===n?void 0:n.dbType)&&!(null===n||void 0===n?void 0:n.isDocker)&&C(Ec.find((function(e){return e.driver.toLowerCase()===n.dbType}))||null)}),[n]),Object(w.useEffect)((function(){var e;return D&&k&&(e=Object(Z.d)("/playground/driver?driver=".concat(k.driver),1e3,function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.response,r=t.cancel,e.next=3,n.json();case 3:a=e.sent,i=a.status,o=a.error,n.ok&&i===Cc&&(r(),T(!1)),n.ok||(r(),T(!1),B(o));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),function(){var t;k&&(null===(t=e)||void 0===t||t.cancel())}}),[k,D]),Object(w.useEffect)((function(){j(!1),y(null),B(null),o("")}),[null===k||void 0===k?void 0:k.driver]),z?Object(_.jsx)(Ac,{children:Object(_.jsx)(Le,{error:z})}):D&&R?Object(_.jsxs)(Ac,{children:[Object(_.jsx)(xc,{children:"Set Up a Database connection"}),Object(_.jsxs)(ae.b,{align:"center",size:"middle",children:[Object(_.jsx)(xt.a,{}),Object(_.jsxs)(V.a.Text,{children:["Installing ",Object(_.jsx)("b",{children:R})]})]})]}):Object(_.jsxs)(Ac,{children:[Object(_.jsx)(xc,{children:"Set Up a Database connection"}),k?Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)(ae.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[Object(_.jsxs)(ae.b,{size:"middle",children:[Object(_.jsx)(sc,{db:k}),Object(_.jsx)(ze,{"data-testid":"wizard-change-db-btn",type:"link",onClick:function(){return C(null)},children:"Change"})]}),Object(_.jsxs)(V.a,{children:[k.instructions?Object(_.jsx)("div",{dangerouslySetInnerHTML:{__html:k.instructions}}):Object(_.jsxs)(V.a.Paragraph,{children:["Enter database credentials to connect to your database. ",Object(_.jsx)("br",{}),"Cube.js will store your credentials into the ",Object(_.jsx)("code",{children:".env"})," ","file for future use."]}),Object(_.jsx)(A.a,{type:"info",message:Object(_.jsxs)(_.Fragment,{children:["For advanced configuration, use the ",Object(_.jsx)("b",{children:"cube.js"})," or"," ",Object(_.jsx)("b",{children:".env"})," configuration files in your cube.js project. Note these files are on the mount volume if you are running Docker.",Object(_.jsx)("br",{}),Object(_.jsx)(V.a.Link,{href:"https://cube.dev/docs/config/databases",target:"_blank",children:"Learn more about connecting to databases in the documentation."})]})}),"MongoDB"===k.title?Object(_.jsx)(A.a,{message:"The MongoDB Connector for BI is required to connect to MongoDB.",type:"info"}):null]}),Object(_.jsxs)(tn.a,{gutter:[40,12],children:[Object(_.jsx)(en.a,{span:12,children:Object(_.jsxs)(ae.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[Object(_.jsx)(jc,{db:k,deployment:{},loading:u,disabled:f,hostname:i,onSubmit:function(){var e=Object(p.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y(null),j(!0),e.next=5,Dc(n);case 5:return y({success:!0}),l(!0),e.next=9,Pc(n);case 9:l(!1),st("test_database_connection_success:frontend",{database:k.title}),t.push("/schema"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),y({success:!1,error:e.t0}),st("test_database_connection_error:frontend",{error:e.t0.message||e.t0.toString(),database:k.title});case 18:j(!1);case 19:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}()}),Object(_.jsx)(rc,{loading:f,result:O})]})}),["MySQL","PostgreSQL","Druid","ClickHouse"].includes((null===k||void 0===k?void 0:k.title)||"")&&(null===n||void 0===n?void 0:n.isDocker)?Object(_.jsx)(en.a,{span:12,children:Object(_.jsx)(gc,{onHostnameCopy:o})}):null]})]})}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(kc,{children:"Select a database type"}),Object(_.jsx)(tn.a,{gutter:[12,12],children:Ec.map((function(e){return Object(_.jsx)(en.a,{xl:8,lg:8,md:12,sm:24,xs:24,children:Object(_.jsx)(Sc,{onClick:F(e),children:Object(_.jsx)(oc,{db:e})})},e.title)}))})]})]})}var Mc=n(906),Ic=n(907),Lc=function(e,t){var n=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.reduce((function(t,n){return n.children?[].concat(Object(oi.a)(t),Object(oi.a)(e(n.children))):[].concat(Object(oi.a)(t),[n])}),[])}(e).reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(Xt.a)({},t.dataIndex,t))}),{});function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.type,r=t.format;return void 0==e?e:"boolean"===n?"boolean"===typeof e?e.toString():"number"===typeof e?Boolean(e).toString():e:"number"===n&&"percent"===r?[parseFloat(e).toFixed(2),"%"].join(""):e.toString()}return t.map((function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=Object(N.a)(e,2),a=t[0];return[a,r(t[1],n[a])]})))}))};function _c(e){var t=e.resultSet,n=e.pivotConfig,r=Object(Aa.a)((function(){var e=t.tableColumns(n);return[e,Lc(e,t.tablePivot(n))]}),[t,n]),a=Object(N.a)(r,2),i=a[0],o=a[1];return Object(_.jsx)(Or.a,{pagination:{pageSize:50},columns:i,dataSource:o})}var zc,Bc={top:50,minWidth:450};function Fc(e){var t=e.query,n=e.onClose,r=e.pivotConfig,a=C.a.useState(!0),i=Object(N.a)(a,2),o=i[0],c=i[1],s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(w.useRef)({}),r=Object(w.useRef)(!0),a=Object(w.useState)(null),i=dn()(a,2),o=i[0],c=i[1],s=Object(w.useState)(!1),u=dn()(s,2),l=u[0],d=u[1],b=Object(w.useState)(null),p=dn()(b,2),h=p[0],f=p[1],j=Object(w.useState)(null),m=dn()(j,2),v=m[0],O=m[1],y=Object(w.useState)(null),g=dn()(y,2),x=g[0],k=g[1],C=Object(w.useContext)(Jn),S=null,A=function(e){var t=e.progressResponse;return O(t)};function E(){return D.apply(this,arguments)}function D(){return(D=Nn()(Yn.a.mark((function a(){var i,o,c;return Yn.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=t.resetResultSetOnChange,o=t.cubejsApi||(null===C||void 0===C?void 0:C.cubejsApi)){a.next=4;break}throw new Error("Cube.js API client is not provided");case 4:return i&&f(null),k(null),d(!0),a.prev=7,a.next=10,o.load(e,{mutexObj:n.current,mutexKey:"query",progressCallback:A});case 10:c=a.sent,r.current&&(f(c),O(null)),a.next=17;break;case 14:a.prev=14,a.t0=a.catch(7),r.current&&(k(a.t0),f(null),O(null));case 17:r.current&&d(!1);case 18:case"end":return a.stop()}}),a,null,[[7,14]])})))).apply(this,arguments)}return Object(w.useEffect)((function(){return function(){r.current=!1}}),[]),Object(w.useEffect)((function(){var a=t.skip,i=void 0!==a&&a,s=t.resetResultSetOnChange,u=t.cubejsApi||(null===C||void 0===C?void 0:C.cubejsApi);if(!u)throw new Error("Cube.js API client is not provided");function l(){return(l=Nn()(Yn.a.mark((function a(){return Yn.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i||!Object(Rn.i)(e)){a.next=20;break}if(Object(Rn.c)(o,e)||((null==s||s)&&f(null),c(e)),k(null),d(!0),a.prev=4,!S){a.next=9;break}return a.next=8,S.unsubscribe();case 8:S=null;case 9:if(!t.subscribe){a.next=13;break}S=u.subscribe(e,{mutexObj:n.current,mutexKey:"query",progressCallback:A},(function(e,t){r.current&&(e?k(e):f(t),d(!1),O(null))})),a.next=15;break;case 13:return a.next=15,E();case 15:a.next=20;break;case 17:a.prev=17,a.t0=a.catch(4),r.current&&(k(a.t0),f(null),d(!1),O(null));case 20:case"end":return a.stop()}}),a,null,[[4,17]])})))).apply(this,arguments)}return function(){l.apply(this,arguments)}(),function(){S&&(S.unsubscribe(),S=null)}}),sr([e,Object.keys(e&&e.order||{}),t,C])),{isLoading:l,resultSet:h,error:x,progress:v,previousQuery:o,refetch:E}}(t,{skip:!t}),u=s.resultSet,l=s.isLoading,d=s.error,b=function(){c(!1)};return Object(_.jsxs)(Pt.a,{style:Bc,visible:o,onCancel:b,width:"auto",footer:Object(_.jsx)(Y.a,{onClick:b,children:"Close"},"close"),afterClose:n,centered:!0,children:[d?Object(_.jsx)(Le,{error:d}):null,l&&!d?Object(_.jsx)(Te,{}):null,u&&!l?Object(_.jsx)(_c,{resultSet:u,pivotConfig:r}):null]})}var Qc=Nt.a.TabPane,Nc=Object(E.d)(Nt.a)(zc||(zc=Object(k.a)(["\n  & .ant-tabs-nav {\n    background: #fff;\n    padding: 12px 16px 0;\n    margin: 0;\n  }\n\n  & .ant-tabs-extra-content {\n    margin-left: 32px;\n  }\n"])));function Uc(e){var t=e.query,n=e.children,r=e.sidebar,a=void 0===r?null:r,i=e.onTabChange,o=Hr(),c=o.setChartRendererReady,s=o.setQueryStatus,u=o.setQueryError,l=o.setResultSetExists,d=o.setQueryLoading,p=o.setBuildInProgress,h=o.setSlowQuery,f=o.setSlowQueryFromCache,j=o.setQueryRequestId,m=Object(w.useState)(!1),v=Object(N.a)(m,2),O=v[0],y=v[1],g=Object(H.f)("queryTabs",{activeId:"1",tabs:[{id:"1",query:t||{}}]}),x=Object(N.a)(g,2),k=x[0],C=x[1],S=Object(w.useState)({}),A=Object(N.a)(S,2),E=A[0],D=A[1];Object(w.useEffect)((function(){window.__cubejsPlayground=Object(b.a)(Object(b.a)({},window.__cubejsPlayground),{},{forQuery:function(e){return{onChartRendererReady:function(){c(e,!0)},onQueryStart:function(){d(e,!0)},onQueryLoad:function(t){var n,r=t.resultSet,a=t.error;if(r){var i,o=r.serialize().loadResponse,c=o.results[0]||{},p=c.requestId,m=c.external,v=c.dbType,O=c.extDbType,y=c.usedPreAggregations,g=void 0===y?{}:y;p&&j(e,p),f(e,Boolean(o.slowQuery)),Boolean(o.slowQuery)&&h(e,!1),l(e,!0),n=Object.keys(g).length>0,st(n?"load_request_success_aggregated:frontend":"load_request_success:frontend",Object(b.a)(Object(b.a)({dbType:v},n?{external:m}:null),m?{extDbType:O}:null));var x=r.serialize(),k=Object(N.a)(x.loadResponse.results,1)[0],w=null===(i=Object.values(k.usedPreAggregations||{})[0])||void 0===i?void 0:i.type,C=k.transformedQuery;s(e,{resultSet:r,error:a,isAggregated:n,preAggregationType:w,transformedQuery:C,extDbType:O,external:m})}a&&(s(e,null),u(e,a)),(r||a)&&d(e,!1)},onQueryProgress:function(t){var n,r;p(e,Boolean(null===t||void 0===t||null===(n=t.stage)||void 0===n?void 0:n.stage.includes("pre-aggregation")));var a=(null===t||void 0===t||null===(r=t.stage)||void 0===r?void 0:r.stage.includes("Executing query"))&&(t.stage.timeElapsed||0)>=5e3;h(e,a),a&&f(e,!1)},onQueryDrilldown:function(e,t){D({query:e,pivotConfig:t})}}}})}),[]),Object(w.useEffect)((function(){if(!O){var e=k.tabs.find((function(e){return e.id===k.activeId}));if(t&&!bi()(Object(Rn.m)(null===e||void 0===e?void 0:e.query),Object(Rn.m)(t))){var n=q();C({activeId:n,tabs:[].concat(Object(oi.a)(k.tabs),[{id:n,query:t}])})}y(!0)}}),[O]),Object(w.useEffect)((function(){if(O&&k.activeId){var e=k.tabs.find((function(e){return e.id===k.activeId}));e&&(null===i||void 0===i||i(e))}}),[O,k.activeId]);var T=k.activeId,P=k.tabs;function q(){for(var e=P.map((function(e){return e.id})),t=1;t<=P.length+1;t++)if(!e.includes(t.toString()))return t.toString();return(P.length+1).toString()}function R(e){C(Object(b.a)(Object(b.a)({},k),{},{tabs:P.map((function(t){return T===t.id?Object(b.a)(Object(b.a)({},t),e):t}))}))}function M(){D({})}return O&&k.activeId?Object(_.jsx)(Nc,{"data-testid":"query-tabs",activeKey:T,type:"editable-card",tabBarExtraContent:{right:a},hideAdd:!1,onChange:function(e){C({activeId:e,tabs:P})},onEdit:function(e){if("string"===typeof e){var t=Number.MAX_VALUE,n=P.filter((function(n,r){var a=n.id;return a===e&&(t=r),a!==e}));C({activeId:n[Math.min(t,n.length-1)].id,tabs:n})}else{var r=q();C({activeId:r,tabs:[].concat(Object(oi.a)(P),[{id:r,query:{}}])})}},children:P.map((function(e){return Object(_.jsxs)(Qc,{"data-testid":"query-tab-".concat(e.id),tab:"Query ".concat(e.id),closable:P.length>1,children:[n(e,R),E.query?Object(_.jsx)(Fc,{query:E.query,pivotConfig:E.pivotConfig,onClose:M}):null]},e.id)}))}):null}var Kc,Vc=["apiUrl","token","securityContextToken","dashboardSource","schemaVersion","onSecurityContextModalOpen"],Yc=Object(E.d)(K.a)(Kc||(Kc=Object(k.a)(["\n  border-radius: 0;\n  border-bottom: 1px;\n  min-height: 100%;\n  background: var(--layout-body-background);\n\n  & .ant-card-body {\n    padding: 0;\n  }\n"])));function Jc(e){var t=Object(H.a)().apiUrl,n=Object(H.h)(),r=n.currentToken,a=n.token,i=n.setIsModalOpen;Object(w.useLayoutEffect)((function(){t&&r&&(window.__cubejsPlayground=Object(b.a)(Object(b.a)({},window.__cubejsPlayground),{},{apiUrl:t,token:r}))}),[t,r]);var o=Object(H.b)(t,r);return o?Object(_.jsx)(cr,{cubejsApi:o,children:Object(_.jsx)(to,{apiUrl:t,children:Object(_.jsx)(Gr,{children:Object(_.jsx)(Yc,{bordered:!1,children:Object(_.jsx)(Gc,{apiUrl:t,token:r,dashboardSource:e.dashboardSource,securityContextToken:a,onTabChange:e.onTabChange,extra:e.extra,onVizStateChanged:e.onVizStateChanged,onSecurityContextModalOpen:function(){return i(!0)}})})})})}):Object(_.jsx)(Te,{})}function Gc(e){var t=e.apiUrl,n=e.token,r=e.securityContextToken,a=e.dashboardSource,i=e.schemaVersion,o=e.onSecurityContextModalOpen,c=Object(h.a)(e,Vc),s=Object(m.f)().location,u=no(),l=u.setQuery,d=u.toggleModal,b=new URLSearchParams(s.search),p=JSON.parse(b.get("query")||"null");return Object(_.jsx)(Uc,{query:p,sidebar:Object(_.jsxs)(ae.b,{direction:"horizontal",children:[Object(_.jsxs)(ze,{"data-testid":"security-context-btn",icon:Object(_.jsx)(Mc.a,{}),size:"small",type:r?"primary":"default",onClick:o,children:[r?"Edit":"Add"," Security Context"]}),Object(_.jsx)(ze,{"data-testid":"rd-btn",icon:Object(_.jsx)(Ic.a,{}),size:"small",onClick:function(){return d()},children:"Add Rollup to Schema"})]}),onTabChange:function(e){var t;null===(t=c.onTabChange)||void 0===t||t.call(c,e),l(e.query)},children:function(e,r){var o=e.id,s=e.query,u=e.chartType;return Object(_.jsx)(Po,{queryId:o,apiUrl:t,cubejsToken:n,initialVizState:{query:s,chartType:u},dashboardSource:a,schemaVersion:i,extra:c.extra,onVizStateChanged:function(e){var t;r({query:e.query||{},chartType:e.chartType}),null===(t=c.onVizStateChanged)||void 0===t||t.call(c,e),e.query&&l(e.query)}})}})}function Wc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/cubejs-api";return"".concat(e).concat(t,"/v1")}function Hc(){var e=Object(m.f)().push,t=Object(w.useMemo)((function(){return new St}),[]),n=Object(H.e)(),r=Object(H.a)(),a=r.schemaVersion,i=r.setContext,o=r.playgroundContext,c=Object(H.h)().token,s=o.basePath,u=o.cubejsToken;function l(t){var n=t.query;n&&e({search:"?query=".concat(JSON.stringify(Object(Rn.m)(n)))})}return Object(H.c)((function(){if(!s||null!==n&&n.statusLivePreview.active){if((null===n||void 0===n?void 0:n.statusLivePreview.active)&&n.credentials){var e=n.credentials,t=e.token,r=e.apiUrl;i({apiUrl:Wc(r,s),token:t})}}else i({token:c||u,apiUrl:Wc(window.location.href.split("#")[0].replace(/\/$/,""),s)})}),[s,n,u,c]),Object(_.jsx)(Jc,{schemaVersion:a,dashboardSource:t,onVizStateChanged:l,onTabChange:l})}var Zc=n(326),$c=["search"],Xc=Object(v.b)();function es(e,t){return ts.apply(this,arguments)}function ts(){return(ts=Object(p.a)(d.a.mark((function e(t,n){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=2;break}return e.abrupt("return",n);case 2:return e.next=4,fetch("/playground/token",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:t})});case 4:return r=e.sent,e.next=7,r.json();case 7:return a=e.sent,e.abrupt("return",a.token);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Xc.listen((function(e){e.search;!function(e){var t;null===(t=it)||void 0===t||t(Object(b.a)({event:"page"},e),Ze)}(Object(h.a)(e,$c))})),"3080"===window.location.port&&window.location.pathname.includes("/playground/live-preview/start")&&fetch(window.location.pathname).then((function(){return window.close()})),j.a.render(Object(_.jsx)(m.c,{history:Xc,children:Object(_.jsx)(lt.c,{playgroundContext:{isCloud:!1},children:Object(_.jsxs)(gt,{children:[Object(_.jsx)(m.b,{exact:!0,path:"/",component:function(){var e=Object(m.f)().push,t=Object(H.d)(),n=Object(H.g)(),r=Object(w.useState)(null),a=Object(N.a)(r,2),i=a[0],o=a[1];return Object(w.useEffect)((function(){function e(){return(e=Object(p.a)(d.a.mark((function e(){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/files");case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,t()&&o(r.files);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(w.useLayoutEffect)((function(){n&&null!=i&&(n.shouldStartConnectionWizardFlow?e("/connection"):!i.length||1===i.length&&"Orders.js"===i[0].fileName?e("/schema"):e("/build"))}),[n,i]),null}},"index"),Object(_.jsx)(m.b,{path:"/build",component:function(e){return Object(_.jsx)(Zc.b,{onTokenPayloadChange:es,children:Object(_.jsx)(Hc,Object(b.a)({},e))})}},"build"),Object(_.jsx)(m.b,{path:"/schema",component:$t},"schema"),Object(_.jsx)(m.b,{path:"/connection",component:function(){return Object(_.jsx)(Rc,{history:Xc})}},"connection"),Object(_.jsx)(m.b,{path:"/dashboard",component:Tt},"dashboard"),Object(_.jsx)(m.b,{path:"/template-gallery",component:_o},"template-gallery")]})})}),document.getElementById("playground-root"))}},[[852,10,11]]]);